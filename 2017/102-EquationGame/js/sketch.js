// Generated by CoffeeScript 1.11.1
var Button, R, arrTargets, buttons, draw, dump, f, hist, level, makeProblem, matrix, mousePressed, n, newButton, newGame, randint, setup, start, targets, undo, undoButton;

buttons = [];

hist = [];

targets = [];

undoButton = null;

newButton = null;

n = 2;

level = 2;

start = [];

matrix = [];

arrTargets = [];

R = 25;

Button = (function() {
  function Button(i1, value1, x, y, r, f1) {
    this.i = i1;
    this.value = value1;
    this.x = x;
    this.y = y;
    this.r = r;
    this.f = f1;
  }

  Button.prototype.draw = function() {
    fc(1);
    circle(this.x, this.y, this.r);
    fc(0);
    return text(this.value, this.x, this.y);
  };

  Button.prototype.mousePressed = function() {
    if (dist(mouseX, mouseY, this.x, this.y) < this.r) {
      return this.f();
    }
  };

  return Button;

})();

f = function() {
  var button, cell, i, k, len, row, sum;
  hist.push((function() {
    var k, len, results;
    results = [];
    for (k = 0, len = buttons.length; k < len; k++) {
      button = buttons[k];
      results.push(button.value);
    }
    return results;
  })());
  undoButton.value = level - hist.length;
  row = matrix[this.i];
  sum = 0;
  for (i = k = 0, len = row.length; k < len; i = ++k) {
    cell = row[i];
    sum += cell * buttons[i].value;
  }
  return buttons[this.i].value = sum;
};

dump = function() {
  return print(level, hist.length, level - hist.length);
};

undo = function() {
  var i, item, k, len, value;
  if (hist.length > 0) {
    item = hist.pop();
    for (i = k = 0, len = item.length; k < len; i = ++k) {
      value = item[i];
      buttons[i].value = value;
    }
    return undoButton.value = level - hist.length;
  }
};

newGame = function() {
  return makeProblem();
};

randint = function(a, b) {
  return a + int(random(b - a));
};

makeProblem = function() {
  var a, b, i, j, k, l, len, len1, len2, len3, m, o, ref, ref1, ref2, ref3;
  start = [];
  matrix = [];
  arrTargets = [];
  hist = [];
  a = -n;
  b = n + 1;
  ref = range(n);
  for (k = 0, len = ref.length; k < len; k++) {
    i = ref[k];
    start.push(randint(a, b));
    matrix.push((function() {
      var l, len1, ref1, results;
      ref1 = range(n);
      results = [];
      for (l = 0, len1 = ref1.length; l < len1; l++) {
        j = ref1[l];
        results.push(randint(a, b));
      }
      return results;
    })());
    buttons[i].value = start[i];
  }
  ref1 = range(level);
  for (l = 0, len1 = ref1.length; l < len1; l++) {
    i = ref1[l];
    buttons[randint(0, n)].f();
  }
  ref2 = range(n);
  for (m = 0, len2 = ref2.length; m < len2; m++) {
    i = ref2[m];
    arrTargets.push(buttons[i].value);
  }
  ref3 = range(n);
  for (o = 0, len3 = ref3.length; o < len3; o++) {
    i = ref3[o];
    buttons[i].value = start[i];
  }
  hist = [];
  return undoButton.value = level - hist.length;
};

setup = function() {
  var i, k, len, ref;
  createCanvas(600, 400);
  rectMode(CENTER);
  textAlign(CENTER, CENTER);
  ref = range(n);
  for (k = 0, len = ref.length; k < len; k++) {
    i = ref[k];
    buttons.push(new Button(i, 0, 2 * R * n + R, R + 2 * R * i, R, f));
  }
  undoButton = new Button(-1, 0, width - R, R, R, undo);
  newButton = new Button(-1, 'new', width - R, 3 * R, R, newGame);
  return makeProblem();
};

draw = function() {
  var button, i, j, k, l, len, len1, len2, len3, m, o, ref, ref1, ref2, ref3, results;
  bg(0.5);
  textSize(20);
  ref = buttons.concat([undoButton]);
  for (k = 0, len = ref.length; k < len; k++) {
    button = ref[k];
    button.draw();
  }
  if (undoButton.value === 0 && _.isEqual(arrTargets, (function() {
    var l, len1, results;
    results = [];
    for (l = 0, len1 = buttons.length; l < len1; l++) {
      button = buttons[l];
      results.push(button.value);
    }
    return results;
  })())) {
    newButton.draw();
  }
  ref1 = range(n);
  for (l = 0, len1 = ref1.length; l < len1; l++) {
    i = ref1[l];
    ref2 = range(n);
    for (m = 0, len2 = ref2.length; m < len2; m++) {
      j = ref2[m];
      text(matrix[i][j], R + 2 * R * j, R + 2 * R * i);
    }
  }
  fc(0, 1, 0);
  ref3 = range(n);
  results = [];
  for (o = 0, len3 = ref3.length; o < len3; o++) {
    i = ref3[o];
    results.push(text(arrTargets[i], 2 * R * (n + 1) + R, R + 2 * R * i));
  }
  return results;
};

mousePressed = function() {
  var button, k, len, ref, results;
  ref = buttons.concat([newButton, undoButton]);
  results = [];
  for (k = 0, len = ref.length; k < len; k++) {
    button = ref[k];
    results.push(button.mousePressed());
  }
  return results;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsT0FBQSxHQUFVOztBQUNWLElBQUEsR0FBTzs7QUFDUCxPQUFBLEdBQVU7O0FBQ1YsVUFBQSxHQUFhOztBQUNiLFNBQUEsR0FBWTs7QUFFWixDQUFBLEdBQUk7O0FBR0osS0FBQSxHQUFROztBQUVSLEtBQUEsR0FBUTs7QUFDUixNQUFBLEdBQVM7O0FBQ1QsVUFBQSxHQUFhOztBQUNiLENBQUEsR0FBSTs7QUFFRTtFQUNTLGdCQUFDLEVBQUQsRUFBSSxNQUFKLEVBQVcsQ0FBWCxFQUFjLENBQWQsRUFBaUIsQ0FBakIsRUFBb0IsRUFBcEI7SUFBQyxJQUFDLENBQUEsSUFBRDtJQUFHLElBQUMsQ0FBQSxRQUFEO0lBQU8sSUFBQyxDQUFBLElBQUQ7SUFBRyxJQUFDLENBQUEsSUFBRDtJQUFHLElBQUMsQ0FBQSxJQUFEO0lBQUcsSUFBQyxDQUFBLElBQUQ7RUFBcEI7O21CQUNkLElBQUEsR0FBTyxTQUFBO0lBQ04sRUFBQSxDQUFHLENBQUg7SUFDQSxNQUFBLENBQU8sSUFBQyxDQUFBLENBQVIsRUFBVSxJQUFDLENBQUEsQ0FBWCxFQUFhLElBQUMsQ0FBQSxDQUFkO0lBQ0EsRUFBQSxDQUFHLENBQUg7V0FDQSxJQUFBLENBQUssSUFBQyxDQUFBLEtBQU4sRUFBWSxJQUFDLENBQUEsQ0FBYixFQUFlLElBQUMsQ0FBQSxDQUFoQjtFQUpNOzttQkFLUCxZQUFBLEdBQWUsU0FBQTtJQUNkLElBQUcsSUFBQSxDQUFLLE1BQUwsRUFBWSxNQUFaLEVBQW1CLElBQUMsQ0FBQSxDQUFwQixFQUFzQixJQUFDLENBQUEsQ0FBdkIsQ0FBQSxHQUE0QixJQUFDLENBQUEsQ0FBaEM7YUFBdUMsSUFBQyxDQUFBLENBQUQsQ0FBQSxFQUF2Qzs7RUFEYzs7Ozs7O0FBR2hCLENBQUEsR0FBSSxTQUFBO0FB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QUEsR0FBZSxTQUFBO0FBQUcsTUFBQTtBQUFBO0FBQUE7T0FBQSxxQ0FBQTs7aUJBQUEsTUFBTSxDQUFDLFlBQVAsQ0FBQTtBQUFBOztBQUFIIiwic291cmNlc0NvbnRlbnQiOlsiYnV0dG9ucyA9IFtdXHJcbmhpc3QgPSBbXVxyXG50YXJnZXRzID0gW11cclxudW5kb0J1dHRvbiA9IG51bGxcclxubmV3QnV0dG9uID0gbnVsbFxyXG5cclxubiA9IDJcclxuIyB0b2RvOiBhdXRvdXBkYXRlIGxldmVsXHJcbiMgdG9kbzogaGlkZSB0aGUgbWF0cml4LiBBbGxvdyBmb3IgbiBpbnZlc3RpZ2F0aXZlIG9wZXJhdGlvbnNcclxubGV2ZWwgPSAyXHJcblxyXG5zdGFydCA9IFtdXHJcbm1hdHJpeCA9IFtdXHJcbmFyclRhcmdldHMgPSBbXVxyXG5SID0gMjVcclxuXHJcbmNsYXNzIEJ1dHRvblxyXG5cdGNvbnN0cnVjdG9yIDogKEBpLEB2YWx1ZSxAeCxAeSxAcixAZikgLT5cclxuXHRkcmF3IDogLT5cclxuXHRcdGZjIDFcclxuXHRcdGNpcmNsZSBAeCxAeSxAclxyXG5cdFx0ZmMgMFxyXG5cdFx0dGV4dCBAdmFsdWUsQHgsQHlcclxuXHRtb3VzZVByZXNzZWQgOiAtPlxyXG5cdFx0aWYgZGlzdChtb3VzZVgsbW91c2VZLEB4LEB5KSA8IEByIHRoZW4gQGYoKVxyXG5cclxuZiA9IC0+XHJcblx0aGlzdC5wdXNoIChidXR0b24udmFsdWUgZm9yIGJ1dHRvbiBpbiBidXR0b25zKVxyXG5cdHVuZG9CdXR0b24udmFsdWUgPSBsZXZlbCAtIGhpc3QubGVuZ3RoXHJcblx0cm93ID0gbWF0cml4W0BpXVxyXG5cdHN1bSA9IDBcclxuXHRmb3IgY2VsbCxpIGluIHJvd1xyXG5cdFx0c3VtICs9IGNlbGwgKiBidXR0b25zW2ldLnZhbHVlXHJcblx0YnV0dG9uc1tAaV0udmFsdWUgPSBzdW1cclxuXHJcbmR1bXAgPSAtPlxyXG5cdHByaW50IGxldmVsLCBoaXN0Lmxlbmd0aCxsZXZlbCAtIGhpc3QubGVuZ3RoXHJcblxyXG51bmRvID0gLT5cclxuXHRpZiBoaXN0Lmxlbmd0aCA+IDBcclxuXHRcdGl0ZW0gPSBoaXN0LnBvcCgpXHJcblx0XHRmb3IgdmFsdWUsaSBpbiBpdGVtXHJcblx0XHRcdGJ1dHRvbnNbaV0udmFsdWUgPSB2YWx1ZVxyXG5cdFx0dW5kb0J1dHRvbi52YWx1ZSA9IGxldmVsIC0gaGlzdC5sZW5ndGhcclxuXHJcbm5ld0dhbWUgPSAtPiBtYWtlUHJvYmxlbSgpXHJcblxyXG5yYW5kaW50ID0gKGEsYikgLT4gYSArIGludCByYW5kb20gYi1hXHJcblxyXG5tYWtlUHJvYmxlbSA9IC0+XHJcblx0c3RhcnQgPSBbXVxyXG5cdG1hdHJpeCA9IFtdXHJcblx0YXJyVGFyZ2V0cyA9IFtdXHJcblx0aGlzdCA9IFtdXHJcblx0YSA9IC1uXHJcblx0YiA9IG4rMVxyXG5cdGZvciBpIGluIHJhbmdlIG5cclxuXHRcdHN0YXJ0LnB1c2ggcmFuZGludCBhLGJcclxuXHRcdG1hdHJpeC5wdXNoIChyYW5kaW50IGEsYiBmb3IgaiBpbiByYW5nZSBuKVxyXG5cdFx0YnV0dG9uc1tpXS52YWx1ZSA9IHN0YXJ0W2ldXHJcblx0Zm9yIGkgaW4gcmFuZ2UgbGV2ZWxcclxuXHRcdGJ1dHRvbnNbcmFuZGludCAwLCBuXS5mKClcclxuXHRmb3IgaSBpbiByYW5nZSBuXHJcblx0XHRhcnJUYXJnZXRzLnB1c2ggYnV0dG9uc1tpXS52YWx1ZVxyXG5cdGZvciBpIGluIHJhbmdlIG5cclxuXHRcdGJ1dHRvbnNbaV0udmFsdWUgPSBzdGFydFtpXVxyXG5cdGhpc3QgPSBbXVxyXG5cdHVuZG9CdXR0b24udmFsdWUgPSBsZXZlbCAtIGhpc3QubGVuZ3RoXHJcblxyXG5zZXR1cCA9IC0+XHJcblx0Y3JlYXRlQ2FudmFzIDYwMCw0MDBcclxuXHRyZWN0TW9kZSBDRU5URVJcclxuXHR0ZXh0QWxpZ24gQ0VOVEVSLENFTlRFUlxyXG5cdGZvciBpIGluIHJhbmdlIG5cclxuXHRcdGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIGksMCwyKlIqbitSLFIrMipSKmksUixmXHJcblx0dW5kb0J1dHRvbiA9IG5ldyBCdXR0b24gLTEsMCx3aWR0aC1SLFIsUix1bmRvXHJcblx0bmV3QnV0dG9uID0gbmV3IEJ1dHRvbiAtMSwnbmV3Jyx3aWR0aC1SLDMqUixSLG5ld0dhbWVcclxuXHRtYWtlUHJvYmxlbSgpXHJcblxyXG5kcmF3ID0gLT5cclxuXHRiZyAwLjVcclxuXHR0ZXh0U2l6ZSAyMFxyXG5cdGJ1dHRvbi5kcmF3KCkgZm9yIGJ1dHRvbiBpbiBidXR0b25zLmNvbmNhdCBbdW5kb0J1dHRvbl1cclxuXHRpZiB1bmRvQnV0dG9uLnZhbHVlID09IDAgYW5kIF8uaXNFcXVhbCBhcnJUYXJnZXRzLCAoYnV0dG9uLnZhbHVlIGZvciBidXR0b24gaW4gYnV0dG9ucylcclxuXHRcdG5ld0J1dHRvbi5kcmF3KClcclxuXHRmb3IgaSBpbiByYW5nZSBuXHJcblx0XHRmb3IgaiBpbiByYW5nZSBuXHJcblx0XHRcdHRleHQgbWF0cml4W2ldW2pdLFIrMipSKmosUisyKlIqaVxyXG5cdGZjIDAsMSwwXHJcblx0Zm9yIGkgaW4gcmFuZ2UgblxyXG5cdFx0dGV4dCBhcnJUYXJnZXRzW2ldLDIqUioobisxKStSLFIrMipSKmlcclxuXHJcbm1vdXNlUHJlc3NlZCA9IC0+IGJ1dHRvbi5tb3VzZVByZXNzZWQoKSBmb3IgYnV0dG9uIGluIGJ1dHRvbnMuY29uY2F0IFtuZXdCdXR0b24sdW5kb0J1dHRvbl1cclxuIl19
//# sourceURL=C:\Lab\2017\102-EquationGame\coffee\sketch.coffee