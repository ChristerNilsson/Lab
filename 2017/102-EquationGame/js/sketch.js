// Generated by CoffeeScript 1.11.1
var Button, R, SHOW, arrTargets, buttons, draw, dump, f, hist, level, makeProblem, matrix, mousePressed, n, newButton, newGame, randint, setup, start, targets, undo, undoButton;

buttons = [];

hist = [];

targets = [];

undoButton = null;

newButton = null;

n = 3;

level = 3;

SHOW = true;

start = [];

matrix = [];

arrTargets = [];

R = 25;

Button = (function() {
  function Button(i1, value1, x, y, r, f1) {
    this.i = i1;
    this.value = value1;
    this.x = x;
    this.y = y;
    this.r = r;
    this.f = f1;
  }

  Button.prototype.draw = function() {
    fc(1);
    circle(this.x, this.y, this.r);
    fc(0);
    return text(this.value, this.x, this.y);
  };

  Button.prototype.mousePressed = function() {
    if (dist(mouseX, mouseY, this.x, this.y) < this.r) {
      return this.f();
    }
  };

  return Button;

})();

f = function() {
  var button, cell, i, k, len, row, sum;
  hist.push((function() {
    var k, len, results;
    results = [];
    for (k = 0, len = buttons.length; k < len; k++) {
      button = buttons[k];
      results.push(button.value);
    }
    return results;
  })());
  undoButton.value = level - hist.length;
  row = matrix[this.i];
  sum = 0;
  for (i = k = 0, len = row.length; k < len; i = ++k) {
    cell = row[i];
    sum += cell * buttons[i].value;
  }
  return buttons[this.i].value = sum;
};

dump = function() {
  return print(level, hist.length, level - hist.length);
};

undo = function() {
  var i, item, k, len, value;
  if (hist.length > 0) {
    item = hist.pop();
    for (i = k = 0, len = item.length; k < len; i = ++k) {
      value = item[i];
      buttons[i].value = value;
    }
    return undoButton.value = level - hist.length;
  }
};

newGame = function() {
  return makeProblem();
};

randint = function(a, b) {
  return a + int(random(b - a));
};

makeProblem = function() {
  var a, b, i, j, k, l, len, len1, len2, len3, m, o, ref, ref1, ref2, ref3;
  start = [];
  matrix = [];
  arrTargets = [];
  hist = [];
  a = -n;
  b = n + 1;
  ref = range(n);
  for (k = 0, len = ref.length; k < len; k++) {
    i = ref[k];
    start.push(randint(a, b));
    matrix.push((function() {
      var l, len1, ref1, results;
      ref1 = range(n);
      results = [];
      for (l = 0, len1 = ref1.length; l < len1; l++) {
        j = ref1[l];
        results.push(randint(a, b));
      }
      return results;
    })());
    buttons[i].value = start[i];
  }
  ref1 = range(level);
  for (l = 0, len1 = ref1.length; l < len1; l++) {
    i = ref1[l];
    buttons[randint(0, n)].f();
  }
  ref2 = range(n);
  for (m = 0, len2 = ref2.length; m < len2; m++) {
    i = ref2[m];
    arrTargets.push(buttons[i].value);
  }
  ref3 = range(n);
  for (o = 0, len3 = ref3.length; o < len3; o++) {
    i = ref3[o];
    buttons[i].value = start[i];
  }
  print(hist.concat([arrTargets]));
  hist = [];
  return undoButton.value = level - hist.length;
};

setup = function() {
  var i, k, len, ref;
  createCanvas(600, 400);
  rectMode(CENTER);
  textAlign(CENTER, CENTER);
  ref = range(n);
  for (k = 0, len = ref.length; k < len; k++) {
    i = ref[k];
    buttons.push(new Button(i, 0, 2 * R * n + R, R + 2 * R * i, R, f));
  }
  undoButton = new Button(-1, 0, width - R, R, R, undo);
  newButton = new Button(-1, 'new', width - R, 3 * R, R, newGame);
  return makeProblem();
};

draw = function() {
  var button, i, j, k, l, len, len1, len2, len3, m, o, ref, ref1, ref2, ref3, results;
  bg(0.5);
  textSize(20);
  ref = buttons.concat([undoButton]);
  for (k = 0, len = ref.length; k < len; k++) {
    button = ref[k];
    button.draw();
  }
  if (undoButton.value === 0 && _.isEqual(arrTargets, (function() {
    var l, len1, results;
    results = [];
    for (l = 0, len1 = buttons.length; l < len1; l++) {
      button = buttons[l];
      results.push(button.value);
    }
    return results;
  })())) {
    newButton.draw();
  }
  if (SHOW) {
    ref1 = range(n);
    for (l = 0, len1 = ref1.length; l < len1; l++) {
      i = ref1[l];
      ref2 = range(n);
      for (m = 0, len2 = ref2.length; m < len2; m++) {
        j = ref2[m];
        text(matrix[i][j], R + 2 * R * j, R + 2 * R * i);
      }
    }
  }
  fc(0, 1, 0);
  ref3 = range(n);
  results = [];
  for (o = 0, len3 = ref3.length; o < len3; o++) {
    i = ref3[o];
    results.push(text(arrTargets[i], 2 * R * (n + 1) + R, R + 2 * R * i));
  }
  return results;
};

mousePressed = function() {
  var button, k, len, ref, results;
  ref = buttons.concat([newButton, undoButton]);
  results = [];
  for (k = 0, len = ref.length; k < len; k++) {
    button = ref[k];
    results.push(button.mousePressed());
  }
  return results;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsT0FBQSxHQUFVOztBQUNWLElBQUEsR0FBTzs7QUFDUCxPQUFBLEdBQVU7O0FBQ1YsVUFBQSxHQUFhOztBQUNiLFNBQUEsR0FBWTs7QUFFWixDQUFBLEdBQUk7O0FBQ0osS0FBQSxHQUFROztBQUNSLElBQUEsR0FBTzs7QUFFUCxLQUFBLEdBQVE7O0FBQ1IsTUFBQSxHQUFTOztBQUNULFVBQUEsR0FBYTs7QUFDYixDQUFBLEdBQUk7O0FBRUU7RUFDUyxnQkFBQyxFQUFELEVBQUksTUFBSixFQUFXLENBQVgsRUFBYyxDQUFkLEVBQWlCLENBQWpCLEVBQW9CLEVBQXBCO0lBQUMsSUFBQyxDQUFBLElBQUQ7SUFBRyxJQUFDLENBQUEsUUFBRDtJQUFPLElBQUMsQ0FBQSxJQUFEO0lBQUcsSUFBQyxDQUFBLElBQUQ7SUFBRyxJQUFDLENBQUEsSUFBRDtJQUFHLElBQUMsQ0FBQSxJQUFEO0VBQXBCOzttQkFDZCxJQUFBLEdBQU8sU0FBQTtJQUNOLEVBQUEsQ0FBRyxDQUFIO0lBQ0EsTUFBQSxDQUFPLElBQUMsQ0FBQSxDQUFSLEVBQVUsSUFBQyxDQUFBLENBQVgsRUFBYSxJQUFDLENBQUEsQ0FBZDtJQUNBLEVBQUEsQ0FBRyxDQUFIO1dBQ0EsSUFBQSxDQUFLLElBQUMsQ0FBQSxLQUFOLEVBQVksSUFBQyxDQUFBLENBQWIsRUFBZSxJQUFDLENBQUEsQ0FBaEI7RUFKTTs7bUJBS1AsWUFBQSxHQUFlLFNBQUE7SUFDZCxJQUFHLElBQUEsQ0FBSyxNQUFMLEVBQVksTUFBWixFQUFtQixJQUFDLENBQUEsQ0FBcEIsRUFBc0IsSUFBQyxDQUFBLENBQXZCLENBQUEsR0FBNEIsSUFBQyxDQUFBLENBQWhDO2FBQXVDLElBQUMsQ0FBQSxDQUFELENBQUEsRUFBdkM7O0VBRGM7Ozs7OztBQUdoQixD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Q0FBQSxHQUFFLENBQUgsQ0FBSixHQUFVLENBQTdCLEVBQStCLENBQUEsR0FBRSxDQUFBLEdBQUUsQ0FBRixHQUFJLENBQXJDO0FBREQ7O0FBWE07O0FBY1AsWUFBQSxHQUFlLFNBQUE7QUFBRyxNQUFBO0FBQUE7QUFBQTtPQUFBLHFDQUFBOztpQkFBQSxNQUFNLENBQUMsWUFBUCxDQUFBO0FBQUE7O0FBQUgiLCJzb3VyY2VzQ29udGVudCI6WyJidXR0b25zID0gW11cclxuaGlzdCA9IFtdXHJcbnRhcmdldHMgPSBbXVxyXG51bmRvQnV0dG9uID0gbnVsbFxyXG5uZXdCdXR0b24gPSBudWxsXHJcblxyXG5uID0gM1xyXG5sZXZlbCA9IDNcclxuU0hPVyA9IHRydWVcclxuXHJcbnN0YXJ0ID0gW11cclxubWF0cml4ID0gW11cclxuYXJyVGFyZ2V0cyA9IFtdXHJcblIgPSAyNVxyXG5cclxuY2xhc3MgQnV0dG9uXHJcblx0Y29uc3RydWN0b3IgOiAoQGksQHZhbHVlLEB4LEB5LEByLEBmKSAtPlxyXG5cdGRyYXcgOiAtPlxyXG5cdFx0ZmMgMVxyXG5cdFx0Y2lyY2xlIEB4LEB5LEByXHJcblx0XHRmYyAwXHJcblx0XHR0ZXh0IEB2YWx1ZSxAeCxAeVxyXG5cdG1vdXNlUHJlc3NlZCA6IC0+XHJcblx0XHRpZiBkaXN0KG1vdXNlWCxtb3VzZVksQHgsQHkpIDwgQHIgdGhlbiBAZigpXHJcblxyXG5mID0gLT5cclxuXHRoaXN0LnB1c2ggKGJ1dHRvbi52YWx1ZSBmb3IgYnV0dG9uIGluIGJ1dHRvbnMpXHJcblx0dW5kb0J1dHRvbi52YWx1ZSA9IGxldmVsIC0gaGlzdC5sZW5ndGhcclxuXHRyb3cgPSBtYXRyaXhbQGldXHJcblx0c3VtID0gMFxyXG5cdGZvciBjZWxsLGkgaW4gcm93XHJcblx0XHRzdW0gKz0gY2VsbCAqIGJ1dHRvbnNbaV0udmFsdWVcclxuXHRidXR0b25zW0BpXS52YWx1ZSA9IHN1bVxyXG5cclxuZHVtcCA9IC0+XHJcblx0cHJpbnQgbGV2ZWwsIGhpc3QubGVuZ3RoLGxldmVsIC0gaGlzdC5sZW5ndGhcclxuXHJcbnVuZG8gPSAtPlxyXG5cdGlmIGhpc3QubGVuZ3RoID4gMFxyXG5cdFx0aXRlbSA9IGhpc3QucG9wKClcclxuXHRcdGZvciB2YWx1ZSxpIGluIGl0ZW1cclxuXHRcdFx0YnV0dG9uc1tpXS52YWx1ZSA9IHZhbHVlXHJcblx0XHR1bmRvQnV0dG9uLnZhbHVlID0gbGV2ZWwgLSBoaXN0Lmxlbmd0aFxyXG5cclxubmV3R2FtZSA9IC0+IG1ha2VQcm9ibGVtKClcclxuXHJcbnJhbmRpbnQgPSAoYSxiKSAtPiBhICsgaW50IHJhbmRvbSBiLWFcclxuXHJcbm1ha2VQcm9ibGVtID0gLT5cclxuXHRzdGFydCA9IFtdXHJcblx0bWF0cml4ID0gW11cclxuXHRhcnJUYXJnZXRzID0gW11cclxuXHRoaXN0ID0gW11cclxuXHRhID0gLW5cclxuXHRiID0gbisxXHJcblx0Zm9yIGkgaW4gcmFuZ2UgblxyXG5cdFx0c3RhcnQucHVzaCByYW5kaW50IGEsYlxyXG5cdFx0bWF0cml4LnB1c2ggKHJhbmRpbnQgYSxiIGZvciBqIGluIHJhbmdlIG4pXHJcblx0XHRidXR0b25zW2ldLnZhbHVlID0gc3RhcnRbaV1cclxuXHRmb3IgaSBpbiByYW5nZSBsZXZlbFxyXG5cdFx0YnV0dG9uc1tyYW5kaW50IDAsIG5dLmYoKVxyXG5cdGZvciBpIGluIHJhbmdlIG5cclxuXHRcdGFyclRhcmdldHMucHVzaCBidXR0b25zW2ldLnZhbHVlXHJcblx0Zm9yIGkgaW4gcmFuZ2UgblxyXG5cdFx0YnV0dG9uc1tpXS52YWx1ZSA9IHN0YXJ0W2ldXHJcblx0cHJpbnQgaGlzdC5jb25jYXQgW2FyclRhcmdldHNdICMgWyhidXR0b24udmFsdWUgZm9yIGJ1dHRvbiBpbiBidXR0b25zKV1cclxuXHRoaXN0ID0gW11cclxuXHR1bmRvQnV0dG9uLnZhbHVlID0gbGV2ZWwgLSBoaXN0Lmxlbmd0aFxyXG5cclxuc2V0dXAgPSAtPlxyXG5cdGNyZWF0ZUNhbnZhcyA2MDAsNDAwXHJcblx0cmVjdE1vZGUgQ0VOVEVSXHJcblx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHRmb3IgaSBpbiByYW5nZSBuXHJcblx0XHRidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiBpLDAsMipSKm4rUixSKzIqUippLFIsZlxyXG5cdHVuZG9CdXR0b24gPSBuZXcgQnV0dG9uIC0xLDAsd2lkdGgtUixSLFIsdW5kb1xyXG5cdG5ld0J1dHRvbiA9IG5ldyBCdXR0b24gLTEsJ25ldycsd2lkdGgtUiwzKlIsUixuZXdHYW1lXHJcblx0bWFrZVByb2JsZW0oKVxyXG5cclxuZHJhdyA9IC0+XHJcblx0YmcgMC41XHJcblx0dGV4dFNpemUgMjBcclxuXHRidXR0b24uZHJhdygpIGZvciBidXR0b24gaW4gYnV0dG9ucy5jb25jYXQgW3VuZG9CdXR0b25dXHJcblx0aWYgdW5kb0J1dHRvbi52YWx1ZSA9PSAwIGFuZCBfLmlzRXF1YWwgYXJyVGFyZ2V0cywgKGJ1dHRvbi52YWx1ZSBmb3IgYnV0dG9uIGluIGJ1dHRvbnMpXHJcblx0XHRuZXdCdXR0b24uZHJhdygpXHJcblx0aWYgU0hPV1xyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgblxyXG5cdFx0XHRmb3IgaiBpbiByYW5nZSBuXHJcblx0XHRcdFx0dGV4dCBtYXRyaXhbaV1bal0sUisyKlIqaixSKzIqUippXHJcblx0ZmMgMCwxLDBcclxuXHRmb3IgaSBpbiByYW5nZSBuXHJcblx0XHR0ZXh0IGFyclRhcmdldHNbaV0sMipSKihuKzEpK1IsUisyKlIqaVxyXG5cclxubW91c2VQcmVzc2VkID0gLT4gYnV0dG9uLm1vdXNlUHJlc3NlZCgpIGZvciBidXR0b24gaW4gYnV0dG9ucy5jb25jYXQgW25ld0J1dHRvbix1bmRvQnV0dG9uXVxyXG4iXX0=
//# sourceURL=C:\Lab\2017\102-EquationGame\coffee\sketch.coffee