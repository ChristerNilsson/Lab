// Generated by CoffeeScript 1.11.1
var XOFF, balls, bullets, collisions, counter, draw, keyPressed, level, newLevel, queue, setup, shot;

XOFF = 11;

level = 1;

balls = [];

bullets = [];

queue = 0;

counter = 0;

shot = [0, 0];

setup = function() {
  createCanvas(800, 830);
  textSize(600);
  textAlign(CENTER, CENTER);
  rectMode(CENTER);
  return newLevel(1);
};

collisions = function() {
  var b1, b2, ball, bullet, di, i, j, k, len, len1, len2, results;
  for (i = 0, len = bullets.length; i < len; i++) {
    bullet = bullets[i];
    for (j = 0, len1 = balls.length; j < len1; j++) {
      ball = balls[j];
      di = ball.distance(bullet);
      if (di < ball.radius + bullet.radius) {
        shot[ball.g] += 1;
        bullet.age = 999999;
        ball.age = 999999;
      }
    }
  }
  results = [];
  for (k = 0, len2 = bullets.length; k < len2; k++) {
    b1 = bullets[k];
    results.push((function() {
      var l, len3, results1;
      results1 = [];
      for (l = 0, len3 = bullets.length; l < len3; l++) {
        b2 = bullets[l];
        if (b1 !== b2 && b1.distance(b2) < 5) {
          b1.age = 999999;
          results1.push(b2.age = 999999);
        } else {
          results1.push(void 0);
        }
      }
      return results1;
    })());
  }
  return results;
};

newLevel = function(lvl) {
  level = lvl;
  if (level === 0) {
    level = 1;
  }
  balls = [];
  bullets = [];
  queue = 2 * level;
  counter = 0;
  return shot = [0, 0];
};

draw = function() {
  var ball, bullet, i, len, ref;
  counter += 1;
  if (counter % 50 === 1 && queue > 0) {
    queue -= 1;
    balls.push(new Ball(queue % 2, width / 8 * Math.pow(0.95, level)));
  }
  bg(0.5);
  ref = balls.concat(bullets);
  for (i = 0, len = ref.length; i < len; i++) {
    ball = ref[i];
    ball.draw();
  }
  fc(1, 1, 1, 0.05);
  text(level, width / 2, height / 2);
  collisions();
  bullets = (function() {
    var j, len1, results;
    results = [];
    for (j = 0, len1 = bullets.length; j < len1; j++) {
      bullet = bullets[j];
      if (bullet.age < 215) {
        results.push(bullet);
      }
    }
    return results;
  })();
  balls = (function() {
    var j, len1, results;
    results = [];
    for (j = 0, len1 = balls.length; j < len1; j++) {
      ball = balls[j];
      if (ball.age < 1000000) {
        results.push(ball);
      }
    }
    return results;
  })();
  rect(XOFF, height - 5, 5, 5);
  rect(width - XOFF, height - 5, 5, 5);
  if (shot[1] === level) {
    newLevel(level + 1);
  }
  if (shot[0] === level) {
    return newLevel(level - 1);
  }
};

keyPressed = function() {
  if (keyCode === LEFT_ARROW) {
    bullets.push(new Bullet(XOFF, height - 2, 1.2 * 3.02, -1.2 * 12.6, 0.1 * 1.4));
  }
  if (keyCode === RIGHT_ARROW) {
    return bullets.push(new Bullet(width - XOFF, height - 2, -1.2 * 3.02, -1.2 * 12.6, 0.1 * 1.4));
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsSUFBQSxHQUFPOztBQUVQLEtBQUEsR0FBUTs7QUFDUixLQUFBLEdBQVE7O0FBQ1IsT0FBQSxHQUFVOztBQUNWLEtBQUEsR0FBUTs7QUFDUixPQUFBLEdBQVU7O0FBQ1YsSUFBQSxHQUFPLENBQUMsQ0FBRCxFQUFHLENBQUg7O0FBRVAsS0FBQSxHQUFRLFNBQUE7RUFDUCxZQUFBLENBQWEsR0FBYixFQUFpQixHQUFqQjtFQUNBLFFBQUEsQ0FBUyxHQUFUO0VBQ0EsU0FBQSxDQUFVLE1BQVYsRUFBaUIsTUFBakI7RUFDQSxRQUFBLENBQVMsTUFBVDtTQUNBLFFBQUEsQ0FBUyxDQUFUO0FBTE87O0FBT1IsVUFBQSxHQUFhLFNBQUE7QUFDWixNQUFBO0FBQUEsT0FBQSx5Q0FBQTs7QUFDQyxTQUFBLHlDQUFBOztNQUNDLEVBQUEsR0FBSyxJQUFJLENBQUMsUUFBTCxDQUFjLE1BQWQ7TUFDTCxJQUFHLEVBQUEsR0FBSyxJQUFJLENBQUMsTUFBTCxHQUFjLE1BQU0sQ0FBQyxNQUE3QjtRQUNDLElBQUssQ0FBQSxJQUFJLENBQUMsQ0FBTCxDQUFMLElBQWdCO1FBQ2hCLE1BQU0sQ0FBQyxHQUFQLEdBQWE7UUFDYixJQUFJLENBQUMsR0FBTCxHQUFXLE9BSFo7O0FBRkQ7QUFERDtBQU9BO09BQUEsMkNBQUE7Ozs7QUFDQztXQUFBLDJDQUFBOztRQUNDLElBQUcsRUFBQSxLQUFNLEVBQU4sSUFBYSxFQUFFLENBQUMsUUFBSCxDQUFZLEVBQVosQ0FBQSxHQUFrQixDQUFsQztVQUNDLEVBQUUsQ0FBQyxHQUFILEdBQVM7d0JBQ1QsRUFBRSxDQUFDLEdBQUgsR0FBUyxRQUZWO1NBQUEsTUFBQTtnQ0FBQTs7QUFERDs7O0FBREQ7O0FBUlk7O0FBY2IsUUFBQSxHQUFXLFNBQUMsR0FBRDtFQUNWLEtBQUEsR0FBUTtFQUNSLElBQUcsS0FBQSxLQUFTLENBQVo7SUFBbUIsS0FBQSxHQUFRLEVBQTNCOztFQUNBLEtBQUEsR0FBUTtFQUNSLE9BQUEsR0FBVTtFQUNWLEtBQUEsR0FBUSxDQUFBLEdBQUk7RUFDWixPQUFBLEdBQVU7U0FDVixJQUFBLEdBQU8sQ0FBQyxDQUFELEVBQUcsQ0FBSDtBQVBHOztBQVNYLElBQUEsR0FBTyxTQUFBO0FBQ04sTUFBQTtFQUFBLE9BQUEsSUFBVztFQUNYLElBQUcsT0FBQSxHQUFVLEVBQVYsS0FBZ0IsQ0FBaEIsSUFBc0IsS0FBQSxHQUFRLENBQWpDO0lBQ0MsS0FBQSxJQUFTO0lBQ1QsS0FBSyxDQUFDLElBQU4sQ0FBZSxJQUFBLElBQUEsQ0FBSyxLQUFBLEdBQU0sQ0FBWCxFQUFjLEtBQUEsR0FBTSxDQUFOLFlBQVUsTUFBTSxNQUE5QixDQUFmLEVBRkQ7O0VBSUEsRUFBQSxDQUFHLEdBQUg7QUFDQTtBQUFBLE9BQUEscUNBQUE7O0lBQ0MsSUFBSSxDQUFDLElBQUwsQ0FBQTtBQUREO0VBRUEsRUFBQSxDQUFHLENBQUgsRUFBSyxDQUFMLEVBQU8sQ0FBUCxFQUFTLElBQVQ7RUFDQSxJQUFBLENBQUssS0FBTCxFQUFXLEtBQUEsR0FBTSxDQUFqQixFQUFtQixNQUFBLEdBQU8sQ0FBMUI7RUFDQSxVQUFBLENBQUE7RUFFQSxPQUFBOztBQUFXO1NBQUEsMkNBQUE7O1VBQWtDLE1BQU0sQ0FBQyxHQUFQLEdBQWE7cUJBQS9DOztBQUFBOzs7RUFDWCxLQUFBOztBQUFTO1NBQUEseUNBQUE7O1VBQTRCLElBQUksQ0FBQyxHQUFMLEdBQVc7cUJBQXZDOztBQUFBOzs7RUFFVCxJQUFBLENBQUssSUFBTCxFQUFnQixNQUFBLEdBQU8sQ0FBdkIsRUFBeUIsQ0FBekIsRUFBMkIsQ0FBM0I7RUFDQSxJQUFBLENBQUssS0FBQSxHQUFNLElBQVgsRUFBZ0IsTUFBQSxHQUFPLENBQXZCLEVBQXlCLENBQXpCLEVBQTJCLENBQTNCO0VBRUEsSUFBRyxJQUFLLENBQUEsQ0FBQSxDQUFMLEtBQVcsS0FBZDtJQUF5QixRQUFBLENBQVMsS0FBQSxHQUFNLENBQWYsRUFBekI7O0VBQ0EsSUFBRyxJQUFLLENBQUEsQ0FBQSxDQUFMLEtBQVcsS0FBZDtXQUF5QixRQUFBLENBQVMsS0FBQSxHQUFNLENBQWYsRUFBekI7O0FBcEJNOztBQXNCUCxVQUFBLEdBQWEsU0FBQTtFQUNaLElBQUcsT0FBQSxLQUFXLFVBQWQ7SUFBK0IsT0FBTyxDQUFDLElBQVIsQ0FBaUIsSUFBQSxNQUFBLENBQU8sSUFBUCxFQUFrQixNQUFBLEdBQU8sQ0FBekIsRUFBNkIsR0FBQSxHQUFJLElBQWpDLEVBQXVDLENBQUMsR0FBRCxHQUFLLElBQTVDLEVBQWtELEdBQUEsR0FBSSxHQUF0RCxDQUFqQixFQUEvQjs7RUFDQSxJQUFHLE9BQUEsS0FBVyxXQUFkO1dBQStCLE9BQU8sQ0FBQyxJQUFSLENBQWlCLElBQUEsTUFBQSxDQUFPLEtBQUEsR0FBTSxJQUFiLEVBQWtCLE1BQUEsR0FBTyxDQUF6QixFQUE0QixDQUFDLEdBQUQsR0FBSyxJQUFqQyxFQUF1QyxDQUFDLEdBQUQsR0FBSyxJQUE1QyxFQUFrRCxHQUFBLEdBQUksR0FBdEQsQ0FBakIsRUFBL0I7O0FBRlkiLCJzb3VyY2VzQ29udGVudCI6WyJYT0ZGID0gMTFcclxuXHJcbmxldmVsID0gMVxyXG5iYWxscyA9IFtdXHJcbmJ1bGxldHMgPSBbXVxyXG5xdWV1ZSA9IDBcclxuY291bnRlciA9IDBcclxuc2hvdCA9IFswLDBdXHJcblxyXG5zZXR1cCA9IC0+XHJcblx0Y3JlYXRlQ2FudmFzIDgwMCw4MzBcclxuXHR0ZXh0U2l6ZSA2MDBcclxuXHR0ZXh0QWxpZ24gQ0VOVEVSLENFTlRFUlxyXG5cdHJlY3RNb2RlIENFTlRFUlxyXG5cdG5ld0xldmVsIDFcclxuXHJcbmNvbGxpc2lvbnMgPSAtPlxyXG5cdGZvciBidWxsZXQgaW4gYnVsbGV0c1xyXG5cdFx0Zm9yIGJhbGwgaW4gYmFsbHNcclxuXHRcdFx0ZGkgPSBiYWxsLmRpc3RhbmNlIGJ1bGxldFxyXG5cdFx0XHRpZiBkaSA8IGJhbGwucmFkaXVzICsgYnVsbGV0LnJhZGl1c1xyXG5cdFx0XHRcdHNob3RbYmFsbC5nXSArPSAxXHJcblx0XHRcdFx0YnVsbGV0LmFnZSA9IDk5OTk5OVxyXG5cdFx0XHRcdGJhbGwuYWdlID0gOTk5OTk5XHJcblx0Zm9yIGIxIGluIGJ1bGxldHNcclxuXHRcdGZvciBiMiBpbiBidWxsZXRzXHJcblx0XHRcdGlmIGIxICE9IGIyIGFuZCBiMS5kaXN0YW5jZShiMikgPCA1XHJcblx0XHRcdFx0YjEuYWdlID0gOTk5OTk5XHJcblx0XHRcdFx0YjIuYWdlID0gOTk5OTk5XHJcblxyXG5uZXdMZXZlbCA9IChsdmwpIC0+XHJcblx0bGV2ZWwgPSBsdmxcclxuXHRpZiBsZXZlbCA9PSAwIHRoZW4gbGV2ZWwgPSAxXHJcblx0YmFsbHMgPSBbXVxyXG5cdGJ1bGxldHMgPSBbXVxyXG5cdHF1ZXVlID0gMiAqIGxldmVsXHJcblx0Y291bnRlciA9IDBcclxuXHRzaG90ID0gWzAsMF1cclxuXHJcbmRyYXcgPSAtPlxyXG5cdGNvdW50ZXIgKz0gMVxyXG5cdGlmIGNvdW50ZXIgJSA1MCA9PSAxIGFuZCBxdWV1ZSA+IDBcclxuXHRcdHF1ZXVlIC09IDFcclxuXHRcdGJhbGxzLnB1c2ggbmV3IEJhbGwgcXVldWUlMiwgd2lkdGgvOCAqIDAuOTUqKmxldmVsXHJcblxyXG5cdGJnIDAuNVxyXG5cdGZvciBiYWxsIGluIGJhbGxzLmNvbmNhdCBidWxsZXRzXHJcblx0XHRiYWxsLmRyYXcoKVxyXG5cdGZjIDEsMSwxLDAuMDVcclxuXHR0ZXh0IGxldmVsLHdpZHRoLzIsaGVpZ2h0LzJcclxuXHRjb2xsaXNpb25zKClcclxuXHJcblx0YnVsbGV0cyA9IChidWxsZXQgZm9yIGJ1bGxldCBpbiBidWxsZXRzIHdoZW4gYnVsbGV0LmFnZSA8IDIxNSlcclxuXHRiYWxscyA9IChiYWxsIGZvciBiYWxsIGluIGJhbGxzIHdoZW4gYmFsbC5hZ2UgPCAxMDAwMDAwKVxyXG5cclxuXHRyZWN0IFhPRkYsICAgICAgaGVpZ2h0LTUsNSw1XHJcblx0cmVjdCB3aWR0aC1YT0ZGLGhlaWdodC01LDUsNVxyXG5cclxuXHRpZiBzaG90WzFdID09IGxldmVsIHRoZW4gbmV3TGV2ZWwgbGV2ZWwrMVxyXG5cdGlmIHNob3RbMF0gPT0gbGV2ZWwgdGhlbiBuZXdMZXZlbCBsZXZlbC0xXHJcblxyXG5rZXlQcmVzc2VkID0gLT5cclxuXHRpZiBrZXlDb2RlID09IExFRlRfQVJST1cgIHRoZW4gYnVsbGV0cy5wdXNoIG5ldyBCdWxsZXQgWE9GRiwgICAgICBoZWlnaHQtMiwgIDEuMiozLjAyLCAtMS4yKjEyLjYsIDAuMSoxLjRcclxuXHRpZiBrZXlDb2RlID09IFJJR0hUX0FSUk9XIHRoZW4gYnVsbGV0cy5wdXNoIG5ldyBCdWxsZXQgd2lkdGgtWE9GRixoZWlnaHQtMiwgLTEuMiozLjAyLCAtMS4yKjEyLjYsIDAuMSoxLjRcclxuIl19
//# sourceURL=C:\Lab\2017\104-BouncingBallsShootout\coffee\sketch.coffee