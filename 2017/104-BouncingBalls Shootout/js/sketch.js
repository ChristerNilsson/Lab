// Generated by CoffeeScript 1.11.1
var XOFF, balls, bullets, collisions, counter, draw, keyPressed, level, newLevel, queue, setup, shot;

XOFF = 11;

level = 1;

balls = [];

bullets = [];

queue = 0;

counter = 0;

shot = [0, 0, 0];

setup = function() {
  createCanvas(800, 800);
  textSize(600);
  textAlign(CENTER, CENTER);
  rectMode(CENTER);
  return newLevel(1);
};

collisions = function() {
  var b1, b2, ball, bullet, i, j, k, len, len1, len2, results;
  for (i = 0, len = bullets.length; i < len; i++) {
    bullet = bullets[i];
    for (j = 0, len1 = balls.length; j < len1; j++) {
      ball = balls[j];
      if (ball.distance(bullet) < ball.radius + bullet.radius) {
        shot[ball.type] += 1;
        bullet.age = 999999;
        ball.age = 999999;
      }
    }
  }
  results = [];
  for (k = 0, len2 = bullets.length; k < len2; k++) {
    b1 = bullets[k];
    results.push((function() {
      var l, len3, results1;
      results1 = [];
      for (l = 0, len3 = bullets.length; l < len3; l++) {
        b2 = bullets[l];
        if (b1 !== b2 && b1.distance(b2) < 5) {
          b1.age = 999999;
          results1.push(b2.age = 999999);
        } else {
          results1.push(void 0);
        }
      }
      return results1;
    })());
  }
  return results;
};

newLevel = function(lvl) {
  level = lvl;
  if (level === 0) {
    level = 1;
  }
  balls = [];
  bullets = [];
  queue = 2 * level;
  counter = 0;
  return shot = [0, 0, 0];
};

draw = function() {
  var ball, bullet, i, len, ref;
  counter += 1;
  if (counter % 50 === 1 && queue > 0) {
    queue -= 1;
    balls.push(new Ball(1 + queue % 2, width / Math.pow(level, 0.7) / 10));
  }
  bg(0.5);
  ref = balls.concat(bullets);
  for (i = 0, len = ref.length; i < len; i++) {
    ball = ref[i];
    ball.draw();
  }
  fc(1, 1, 1, 0.05);
  text(level, width / 2, height / 2);
  collisions();
  bullets = (function() {
    var j, len1, results;
    results = [];
    for (j = 0, len1 = bullets.length; j < len1; j++) {
      bullet = bullets[j];
      if (bullet.age < 252) {
        results.push(bullet);
      }
    }
    return results;
  })();
  balls = (function() {
    var j, len1, results;
    results = [];
    for (j = 0, len1 = balls.length; j < len1; j++) {
      ball = balls[j];
      if (ball.age < 1000000) {
        results.push(ball);
      }
    }
    return results;
  })();
  rect(XOFF, height - 5, 5, 5);
  rect(width - XOFF, height - 5, 5, 5);
  if (shot[1] === level) {
    newLevel(level + 1);
  }
  if (shot[2] === level) {
    return newLevel(level - 1);
  }
};

keyPressed = function() {
  if (keyCode === LEFT_ARROW) {
    bullets.push(new Ball(0, 2, XOFF, height - 2, 3.1, -12.6));
  }
  if (keyCode === RIGHT_ARROW) {
    return bullets.push(new Ball(0, 2, width - XOFF, height - 2, -3.1, -12.6));
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsSUFBQSxHQUFPOztBQUVQLEtBQUEsR0FBUTs7QUFDUixLQUFBLEdBQVE7O0FBQ1IsT0FBQSxHQUFVOztBQUNWLEtBQUEsR0FBUTs7QUFDUixPQUFBLEdBQVU7O0FBQ1YsSUFBQSxHQUFPLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxDQUFMOztBQUVQLEtBQUEsR0FBUSxTQUFBO0VBQ1AsWUFBQSxDQUFhLEdBQWIsRUFBaUIsR0FBakI7RUFDQSxRQUFBLENBQVMsR0FBVDtFQUNBLFNBQUEsQ0FBVSxNQUFWLEVBQWlCLE1BQWpCO0VBQ0EsUUFBQSxDQUFTLE1BQVQ7U0FDQSxRQUFBLENBQVMsQ0FBVDtBQUxPOztBQU9SLFVBQUEsR0FBYSxTQUFBO0FBQ1osTUFBQTtBQUFBLE9BQUEseUNBQUE7O0FBQ0MsU0FBQSx5Q0FBQTs7TUFDQyxJQUFHLElBQUksQ0FBQyxRQUFMLENBQWMsTUFBZCxDQUFBLEdBQXdCLElBQUksQ0FBQyxNQUFMLEdBQWMsTUFBTSxDQUFDLE1BQWhEO1FBQ0MsSUFBSyxDQUFBLElBQUksQ0FBQyxJQUFMLENBQUwsSUFBbUI7UUFDbkIsTUFBTSxDQUFDLEdBQVAsR0FBYTtRQUNiLElBQUksQ0FBQyxHQUFMLEdBQVcsT0FIWjs7QUFERDtBQUREO0FBTUE7T0FBQSwyQ0FBQTs7OztBQUNDO1dBQUEsMkNBQUE7O1FBQ0MsSUFBRyxFQUFBLEtBQU0sRUFBTixJQUFhLEVBQUUsQ0FBQyxRQUFILENBQVksRUFBWixDQUFBLEdBQWtCLENBQWxDO1VBQ0MsRUFBRSxDQUFDLEdBQUgsR0FBUzt3QkFDVCxFQUFFLENBQUMsR0FBSCxHQUFTLFFBRlY7U0FBQSxNQUFBO2dDQUFBOztBQUREOzs7QUFERDs7QUFQWTs7QUFhYixRQUFBLEdBQVcsU0FBQyxHQUFEO0VBQ1YsS0FBQSxHQUFRO0VBQ1IsSUFBRyxLQUFBLEtBQVMsQ0FBWjtJQUFtQixLQUFBLEdBQVEsRUFBM0I7O0VBQ0EsS0FBQSxHQUFRO0VBQ1IsT0FBQSxHQUFVO0VBQ1YsS0FBQSxHQUFRLENBQUEsR0FBSTtFQUNaLE9BQUEsR0FBVTtTQUNWLElBQUEsR0FBTyxDQUFDLENBQUQsRUFBRyxDQUFILEVBQUssQ0FBTDtBQVBHOztBQVVYLElBQUEsR0FBTyxTQUFBO0FBQ04sTUFBQTtFQUFBLE9BQUEsSUFBVztFQUNYLElBQUcsT0FBQSxHQUFVLEVBQVYsS0FBZ0IsQ0FBaEIsSUFBc0IsS0FBQSxHQUFRLENBQWpDO0lBQ0MsS0FBQSxJQUFTO0lBQ1QsS0FBSyxDQUFDLElBQU4sQ0FBZSxJQUFBLElBQUEsQ0FBSyxDQUFBLEdBQUUsS0FBQSxHQUFNLENBQWIsRUFBZ0IsS0FBQSxZQUFNLE9BQU8sSUFBYixHQUFpQixFQUFqQyxDQUFmLEVBRkQ7O0VBSUEsRUFBQSxDQUFHLEdBQUg7QUFDQTtBQUFBLE9BQUEscUNBQUE7O0lBQ0MsSUFBSSxDQUFDLElBQUwsQ0FBQTtBQUREO0VBRUEsRUFBQSxDQUFHLENBQUgsRUFBSyxDQUFMLEVBQU8sQ0FBUCxFQUFTLElBQVQ7RUFDQSxJQUFBLENBQUssS0FBTCxFQUFXLEtBQUEsR0FBTSxDQUFqQixFQUFtQixNQUFBLEdBQU8sQ0FBMUI7RUFDQSxVQUFBLENBQUE7RUFFQSxPQUFBOztBQUFXO1NBQUEsMkNBQUE7O1VBQWtDLE1BQU0sQ0FBQyxHQUFQLEdBQWE7cUJBQS9DOztBQUFBOzs7RUFDWCxLQUFBOztBQUFTO1NBQUEseUNBQUE7O1VBQTRCLElBQUksQ0FBQyxHQUFMLEdBQVc7cUJBQXZDOztBQUFBOzs7RUFFVCxJQUFBLENBQUssSUFBTCxFQUFnQixNQUFBLEdBQU8sQ0FBdkIsRUFBeUIsQ0FBekIsRUFBMkIsQ0FBM0I7RUFDQSxJQUFBLENBQUssS0FBQSxHQUFNLElBQVgsRUFBZ0IsTUFBQSxHQUFPLENBQXZCLEVBQXlCLENBQXpCLEVBQTJCLENBQTNCO0VBRUEsSUFBRyxJQUFLLENBQUEsQ0FBQSxDQUFMLEtBQVcsS0FBZDtJQUF5QixRQUFBLENBQVMsS0FBQSxHQUFNLENBQWYsRUFBekI7O0VBQ0EsSUFBRyxJQUFLLENBQUEsQ0FBQSxDQUFMLEtBQVcsS0FBZDtXQUF5QixRQUFBLENBQVMsS0FBQSxHQUFNLENBQWYsRUFBekI7O0FBcEJNOztBQXNCUCxVQUFBLEdBQWEsU0FBQTtFQUNaLElBQUcsT0FBQSxLQUFXLFVBQWQ7SUFBK0IsT0FBTyxDQUFDLElBQVIsQ0FBaUIsSUFBQSxJQUFBLENBQUssQ0FBTCxFQUFPLENBQVAsRUFBVSxJQUFWLEVBQXFCLE1BQUEsR0FBTyxDQUE1QixFQUFnQyxHQUFoQyxFQUFvQyxDQUFDLElBQXJDLENBQWpCLEVBQS9COztFQUNBLElBQUcsT0FBQSxLQUFXLFdBQWQ7V0FBK0IsT0FBTyxDQUFDLElBQVIsQ0FBaUIsSUFBQSxJQUFBLENBQUssQ0FBTCxFQUFPLENBQVAsRUFBVSxLQUFBLEdBQU0sSUFBaEIsRUFBcUIsTUFBQSxHQUFPLENBQTVCLEVBQStCLENBQUMsR0FBaEMsRUFBb0MsQ0FBQyxJQUFyQyxDQUFqQixFQUEvQjs7QUFGWSIsInNvdXJjZXNDb250ZW50IjpbIlhPRkYgPSAxMVxyXG5cclxubGV2ZWwgPSAxXHJcbmJhbGxzID0gW11cclxuYnVsbGV0cyA9IFtdXHJcbnF1ZXVlID0gMFxyXG5jb3VudGVyID0gMFxyXG5zaG90ID0gWzAsMCwwXVxyXG5cclxuc2V0dXAgPSAtPlxyXG5cdGNyZWF0ZUNhbnZhcyA4MDAsODAwXHJcblx0dGV4dFNpemUgNjAwXHJcblx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHRyZWN0TW9kZSBDRU5URVJcclxuXHRuZXdMZXZlbCAxXHJcblxyXG5jb2xsaXNpb25zID0gLT5cclxuXHRmb3IgYnVsbGV0IGluIGJ1bGxldHNcclxuXHRcdGZvciBiYWxsIGluIGJhbGxzXHJcblx0XHRcdGlmIGJhbGwuZGlzdGFuY2UoYnVsbGV0KSA8IGJhbGwucmFkaXVzICsgYnVsbGV0LnJhZGl1c1xyXG5cdFx0XHRcdHNob3RbYmFsbC50eXBlXSArPSAxXHJcblx0XHRcdFx0YnVsbGV0LmFnZSA9IDk5OTk5OVxyXG5cdFx0XHRcdGJhbGwuYWdlID0gOTk5OTk5XHJcblx0Zm9yIGIxIGluIGJ1bGxldHNcclxuXHRcdGZvciBiMiBpbiBidWxsZXRzXHJcblx0XHRcdGlmIGIxICE9IGIyIGFuZCBiMS5kaXN0YW5jZShiMikgPCA1XHJcblx0XHRcdFx0YjEuYWdlID0gOTk5OTk5XHJcblx0XHRcdFx0YjIuYWdlID0gOTk5OTk5XHJcblxyXG5uZXdMZXZlbCA9IChsdmwpIC0+XHJcblx0bGV2ZWwgPSBsdmxcclxuXHRpZiBsZXZlbCA9PSAwIHRoZW4gbGV2ZWwgPSAxXHJcblx0YmFsbHMgPSBbXVxyXG5cdGJ1bGxldHMgPSBbXVxyXG5cdHF1ZXVlID0gMiAqIGxldmVsXHJcblx0Y291bnRlciA9IDBcclxuXHRzaG90ID0gWzAsMCwwXVxyXG5cdCNiZyAwLjVcclxuXHJcbmRyYXcgPSAtPlxyXG5cdGNvdW50ZXIgKz0gMVxyXG5cdGlmIGNvdW50ZXIgJSA1MCA9PSAxIGFuZCBxdWV1ZSA+IDBcclxuXHRcdHF1ZXVlIC09IDFcclxuXHRcdGJhbGxzLnB1c2ggbmV3IEJhbGwgMStxdWV1ZSUyLCB3aWR0aC9sZXZlbCoqMC43LzEwXHJcblxyXG5cdGJnIDAuNVxyXG5cdGZvciBiYWxsIGluIGJhbGxzLmNvbmNhdCBidWxsZXRzXHJcblx0XHRiYWxsLmRyYXcoKVxyXG5cdGZjIDEsMSwxLDAuMDVcclxuXHR0ZXh0IGxldmVsLHdpZHRoLzIsaGVpZ2h0LzJcclxuXHRjb2xsaXNpb25zKClcclxuXHJcblx0YnVsbGV0cyA9IChidWxsZXQgZm9yIGJ1bGxldCBpbiBidWxsZXRzIHdoZW4gYnVsbGV0LmFnZSA8IDI1MilcclxuXHRiYWxscyA9IChiYWxsIGZvciBiYWxsIGluIGJhbGxzIHdoZW4gYmFsbC5hZ2UgPCAxMDAwMDAwKVxyXG5cclxuXHRyZWN0IFhPRkYsICAgICAgaGVpZ2h0LTUsNSw1XHJcblx0cmVjdCB3aWR0aC1YT0ZGLGhlaWdodC01LDUsNVxyXG5cclxuXHRpZiBzaG90WzFdID09IGxldmVsIHRoZW4gbmV3TGV2ZWwgbGV2ZWwrMVxyXG5cdGlmIHNob3RbMl0gPT0gbGV2ZWwgdGhlbiBuZXdMZXZlbCBsZXZlbC0xXHJcblxyXG5rZXlQcmVzc2VkID0gLT5cclxuXHRpZiBrZXlDb2RlID09IExFRlRfQVJST1cgIHRoZW4gYnVsbGV0cy5wdXNoIG5ldyBCYWxsIDAsMiwgWE9GRiwgICAgICBoZWlnaHQtMiwgIDMuMSwtMTIuNlxyXG5cdGlmIGtleUNvZGUgPT0gUklHSFRfQVJST1cgdGhlbiBidWxsZXRzLnB1c2ggbmV3IEJhbGwgMCwyLCB3aWR0aC1YT0ZGLGhlaWdodC0yLCAtMy4xLC0xMi42XHJcbiJdfQ==
//# sourceURL=C:\Lab\2017\104-BouncingBalls Shootout\coffee\sketch.coffee