// Generated by CoffeeScript 1.11.1
var balls, bullets, collisions, counter, draw, keyPressed, level, newLevel, queue, setup, shot;

level = 1;

balls = [];

bullets = [];

queue = 0;

counter = 0;

shot = [0, 0, 0];

setup = function() {
  createCanvas(800, 800);
  textSize(600);
  textAlign(CENTER, CENTER);
  return newLevel(1);
};

collisions = function() {
  var b1, b2, ball, bullet, i, j, k, len, len1, len2, results;
  for (i = 0, len = bullets.length; i < len; i++) {
    bullet = bullets[i];
    for (j = 0, len1 = balls.length; j < len1; j++) {
      ball = balls[j];
      if (ball.distance(bullet) < ball.radius + bullet.radius) {
        shot[ball.type] += 1;
        bullet.age = 999999;
        ball.age = 999999;
      }
    }
  }
  results = [];
  for (k = 0, len2 = bullets.length; k < len2; k++) {
    b1 = bullets[k];
    results.push((function() {
      var l, len3, results1;
      results1 = [];
      for (l = 0, len3 = bullets.length; l < len3; l++) {
        b2 = bullets[l];
        if (b1 !== b2 && b1.distance(b2) < 5) {
          b1.age = 999999;
          results1.push(b2.age = 999999);
        } else {
          results1.push(void 0);
        }
      }
      return results1;
    })());
  }
  return results;
};

newLevel = function(lvl) {
  level = lvl;
  if (level === 0) {
    level = 1;
  }
  balls = [];
  bullets = [];
  queue = 2 * level;
  counter = 0;
  return shot = [0, 0, 0];
};

draw = function() {
  var ball, bullet, i, len, ref, t1, t2;
  counter += 1;
  if (counter % 50 === 1 && queue > 0) {
    queue -= 1;
    balls.push(new Ball(1 + queue % 2, width / Math.pow(level, 0.7) / 10));
  }
  this.bg(0.5);
  ref = balls.concat(bullets);
  for (i = 0, len = ref.length; i < len; i++) {
    ball = ref[i];
    ball.draw();
  }
  fc(1, 1, 1, 0.05);
  text(level, width / 2, height / 2);
  collisions();
  bullets = (function() {
    var j, len1, results;
    results = [];
    for (j = 0, len1 = bullets.length; j < len1; j++) {
      bullet = bullets[j];
      if (bullet.age < 252) {
        results.push(bullet);
      }
    }
    return results;
  })();
  balls = (function() {
    var j, len1, results;
    results = [];
    for (j = 0, len1 = balls.length; j < len1; j++) {
      ball = balls[j];
      if (ball.age < 1000000) {
        results.push(ball);
      }
    }
    return results;
  })();
  t1 = (function() {
    var j, len1, results;
    results = [];
    for (j = 0, len1 = balls.length; j < len1; j++) {
      ball = balls[j];
      if (ball.type === 1) {
        results.push(ball);
      }
    }
    return results;
  })();
  t2 = (function() {
    var j, len1, results;
    results = [];
    for (j = 0, len1 = balls.length; j < len1; j++) {
      ball = balls[j];
      if (ball.type === 2) {
        results.push(ball);
      }
    }
    return results;
  })();
  if (shot[1] === level) {
    newLevel(level + 1);
  }
  if (shot[2] === level) {
    return newLevel(level - 1);
  }
};

keyPressed = function() {
  if (keyCode === LEFT_ARROW) {
    bullets.push(new Ball(0, 2, 2 + 9, height - 2, 3.1, -12.6));
  }
  if (keyCode === RIGHT_ARROW) {
    return bullets.push(new Ball(0, 2, width - 2 - 9, height - 2, -3.1, -12.6));
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsS0FBQSxHQUFROztBQUNSLEtBQUEsR0FBUTs7QUFDUixPQUFBLEdBQVU7O0FBQ1YsS0FBQSxHQUFROztBQUNSLE9BQUEsR0FBVTs7QUFDVixJQUFBLEdBQU8sQ0FBQyxDQUFELEVBQUcsQ0FBSCxFQUFLLENBQUw7O0FBRVAsS0FBQSxHQUFRLFNBQUE7RUFDUCxZQUFBLENBQWEsR0FBYixFQUFpQixHQUFqQjtFQUNBLFFBQUEsQ0FBUyxHQUFUO0VBQ0EsU0FBQSxDQUFVLE1BQVYsRUFBaUIsTUFBakI7U0FDQSxRQUFBLENBQVMsQ0FBVDtBQUpPOztBQU1SLFVBQUEsR0FBYSxTQUFBO0FBQ1osTUFBQTtBQUFBLE9BQUEseUNBQUE7O0FBQ0MsU0FBQSx5Q0FBQTs7TUFDQyxJQUFHLElBQUksQ0FBQyxRQUFMLENBQWMsTUFBZCxDQUFBLEdBQXdCLElBQUksQ0FBQyxNQUFMLEdBQWMsTUFBTSxDQUFDLE1BQWhEO1FBQ0MsSUFBSyxDQUFBLElBQUksQ0FBQyxJQUFMLENBQUwsSUFBbUI7UUFDbkIsTUFBTSxDQUFDLEdBQVAsR0FBYTtRQUNiLElBQUksQ0FBQyxHQUFMLEdBQVcsT0FIWjs7QUFERDtBQUREO0FBTUE7T0FBQSwyQ0FBQTs7OztBQUNDO1dBQUEsMkNBQUE7O1FBQ0MsSUFBRyxFQUFBLEtBQU0sRUFBTixJQUFhLEVBQUUsQ0FBQyxRQUFILENBQVksRUFBWixDQUFBLEdBQWtCLENBQWxDO1VBQ0MsRUFBRSxDQUFDLEdBQUgsR0FBUzt3QkFDVCxFQUFFLENBQUMsR0FBSCxHQUFTLFFBRlY7U0FBQSxNQUFBO2dDQUFBOztBQUREOzs7QUFERDs7QUFQWTs7QUFhYixRQUFBLEdBQVcsU0FBQyxHQUFEO0VBQ1YsS0FBQSxHQUFRO0VBQ1IsSUFBRyxLQUFBLEtBQVMsQ0FBWjtJQUFtQixLQUFBLEdBQVEsRUFBM0I7O0VBQ0EsS0FBQSxHQUFRO0VBQ1IsT0FBQSxHQUFVO0VBQ1YsS0FBQSxHQUFRLENBQUEsR0FBSTtFQUNaLE9BQUEsR0FBVTtTQUNWLElBQUEsR0FBTyxDQUFDLENBQUQsRUFBRyxDQUFILEVBQUssQ0FBTDtBQVBHOztBQVNYLElBQUEsR0FBTyxTQUFBO0FBQ04sTUFBQTtFQUFBLE9BQUEsSUFBVztFQUNYLElBQUcsT0FBQSxHQUFVLEVBQVYsS0FBZ0IsQ0FBaEIsSUFBc0IsS0FBQSxHQUFRLENBQWpDO0lBQ0MsS0FBQSxJQUFTO0lBQ1QsS0FBSyxDQUFDLElBQU4sQ0FBZSxJQUFBLElBQUEsQ0FBSyxDQUFBLEdBQUUsS0FBQSxHQUFNLENBQWIsRUFBZ0IsS0FBQSxZQUFNLE9BQU8sSUFBYixHQUFpQixFQUFqQyxDQUFmLEVBRkQ7O0VBSUEsSUFBQyxDQUFBLEVBQUQsQ0FBSSxHQUFKO0FBQ0E7QUFBQSxPQUFBLHFDQUFBOztJQUNDLElBQUksQ0FBQyxJQUFMLENBQUE7QUFERDtFQUVBLEVBQUEsQ0FBRyxDQUFILEVBQUssQ0FBTCxFQUFPLENBQVAsRUFBUyxJQUFUO0VBQ0EsSUFBQSxDQUFLLEtBQUwsRUFBVyxLQUFBLEdBQU0sQ0FBakIsRUFBbUIsTUFBQSxHQUFPLENBQTFCO0VBQ0EsVUFBQSxDQUFBO0VBQ0EsT0FBQTs7QUFBVztTQUFBLDJDQUFBOztVQUFrQyxNQUFNLENBQUMsR0FBUCxHQUFhO3FCQUEvQzs7QUFBQTs7O0VBQ1gsS0FBQTs7QUFBUztTQUFBLHlDQUFBOztVQUE0QixJQUFJLENBQUMsR0FBTCxHQUFXO3FCQUF2Qzs7QUFBQTs7O0VBQ1QsRUFBQTs7QUFBTTtTQUFBLHlDQUFBOztVQUE0QixJQUFJLENBQUMsSUFBTCxLQUFhO3FCQUF6Qzs7QUFBQTs7O0VBQ04sRUFBQTs7QUFBTTtTQUFBLHlDQUFBOztVQUE0QixJQUFJLENBQUMsSUFBTCxLQUFhO3FCQUF6Qzs7QUFBQTs7O0VBQ04sSUFBRyxJQUFLLENBQUEsQ0FBQSxDQUFMLEtBQVcsS0FBZDtJQUF5QixRQUFBLENBQVMsS0FBQSxHQUFNLENBQWYsRUFBekI7O0VBQ0EsSUFBRyxJQUFLLENBQUEsQ0FBQSxDQUFMLEtBQVcsS0FBZDtXQUF5QixRQUFBLENBQVMsS0FBQSxHQUFNLENBQWYsRUFBekI7O0FBakJNOztBQW1CUCxVQUFBLEdBQWEsU0FBQTtFQUNaLElBQUcsT0FBQSxLQUFXLFVBQWQ7SUFBK0IsT0FBTyxDQUFDLElBQVIsQ0FBaUIsSUFBQSxJQUFBLENBQUssQ0FBTCxFQUFPLENBQVAsRUFBVSxDQUFBLEdBQUUsQ0FBWixFQUFvQixNQUFBLEdBQU8sQ0FBM0IsRUFBK0IsR0FBL0IsRUFBbUMsQ0FBQyxJQUFwQyxDQUFqQixFQUEvQjs7RUFDQSxJQUFHLE9BQUEsS0FBVyxXQUFkO1dBQStCLE9BQU8sQ0FBQyxJQUFSLENBQWlCLElBQUEsSUFBQSxDQUFLLENBQUwsRUFBTyxDQUFQLEVBQVUsS0FBQSxHQUFNLENBQU4sR0FBUSxDQUFsQixFQUFvQixNQUFBLEdBQU8sQ0FBM0IsRUFBOEIsQ0FBQyxHQUEvQixFQUFtQyxDQUFDLElBQXBDLENBQWpCLEVBQS9COztBQUZZIiwic291cmNlc0NvbnRlbnQiOlsibGV2ZWwgPSAxXHJcbmJhbGxzID0gW11cclxuYnVsbGV0cyA9IFtdXHJcbnF1ZXVlID0gMFxyXG5jb3VudGVyID0gMFxyXG5zaG90ID0gWzAsMCwwXVxyXG5cclxuc2V0dXAgPSAtPlxyXG5cdGNyZWF0ZUNhbnZhcyA4MDAsODAwXHJcblx0dGV4dFNpemUgNjAwXHJcblx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHRuZXdMZXZlbCAxXHJcblxyXG5jb2xsaXNpb25zID0gLT5cclxuXHRmb3IgYnVsbGV0IGluIGJ1bGxldHNcclxuXHRcdGZvciBiYWxsIGluIGJhbGxzXHJcblx0XHRcdGlmIGJhbGwuZGlzdGFuY2UoYnVsbGV0KSA8IGJhbGwucmFkaXVzICsgYnVsbGV0LnJhZGl1c1xyXG5cdFx0XHRcdHNob3RbYmFsbC50eXBlXSArPSAxXHJcblx0XHRcdFx0YnVsbGV0LmFnZSA9IDk5OTk5OVxyXG5cdFx0XHRcdGJhbGwuYWdlID0gOTk5OTk5XHJcblx0Zm9yIGIxIGluIGJ1bGxldHNcclxuXHRcdGZvciBiMiBpbiBidWxsZXRzXHJcblx0XHRcdGlmIGIxICE9IGIyIGFuZCBiMS5kaXN0YW5jZShiMikgPCA1XHJcblx0XHRcdFx0YjEuYWdlID0gOTk5OTk5XHJcblx0XHRcdFx0YjIuYWdlID0gOTk5OTk5XHJcblxyXG5uZXdMZXZlbCA9IChsdmwpIC0+XHJcblx0bGV2ZWwgPSBsdmxcclxuXHRpZiBsZXZlbCA9PSAwIHRoZW4gbGV2ZWwgPSAxXHJcblx0YmFsbHMgPSBbXVxyXG5cdGJ1bGxldHMgPSBbXVxyXG5cdHF1ZXVlID0gMiAqIGxldmVsXHJcblx0Y291bnRlciA9IDBcclxuXHRzaG90ID0gWzAsMCwwXVxyXG5cclxuZHJhdyA9IC0+XHJcblx0Y291bnRlciArPSAxXHJcblx0aWYgY291bnRlciAlIDUwID09IDEgYW5kIHF1ZXVlID4gMFxyXG5cdFx0cXVldWUgLT0gMVxyXG5cdFx0YmFsbHMucHVzaCBuZXcgQmFsbCAxK3F1ZXVlJTIsIHdpZHRoL2xldmVsKiowLjcvMTBcclxuXHJcblx0QGJnIDAuNVxyXG5cdGZvciBiYWxsIGluIGJhbGxzLmNvbmNhdCBidWxsZXRzXHJcblx0XHRiYWxsLmRyYXcoKVxyXG5cdGZjIDEsMSwxLDAuMDVcclxuXHR0ZXh0IGxldmVsLHdpZHRoLzIsaGVpZ2h0LzJcclxuXHRjb2xsaXNpb25zKClcclxuXHRidWxsZXRzID0gKGJ1bGxldCBmb3IgYnVsbGV0IGluIGJ1bGxldHMgd2hlbiBidWxsZXQuYWdlIDwgMjUyKVxyXG5cdGJhbGxzID0gKGJhbGwgZm9yIGJhbGwgaW4gYmFsbHMgd2hlbiBiYWxsLmFnZSA8IDEwMDAwMDApXHJcblx0dDEgPSAoYmFsbCBmb3IgYmFsbCBpbiBiYWxscyB3aGVuIGJhbGwudHlwZSA9PSAxKVxyXG5cdHQyID0gKGJhbGwgZm9yIGJhbGwgaW4gYmFsbHMgd2hlbiBiYWxsLnR5cGUgPT0gMilcclxuXHRpZiBzaG90WzFdID09IGxldmVsIHRoZW4gbmV3TGV2ZWwgbGV2ZWwrMVxyXG5cdGlmIHNob3RbMl0gPT0gbGV2ZWwgdGhlbiBuZXdMZXZlbCBsZXZlbC0xXHJcblxyXG5rZXlQcmVzc2VkID0gLT5cclxuXHRpZiBrZXlDb2RlID09IExFRlRfQVJST1cgIHRoZW4gYnVsbGV0cy5wdXNoIG5ldyBCYWxsIDAsMiwgMis5LCAgICAgIGhlaWdodC0yLCAgMy4xLC0xMi42XHJcblx0aWYga2V5Q29kZSA9PSBSSUdIVF9BUlJPVyB0aGVuIGJ1bGxldHMucHVzaCBuZXcgQmFsbCAwLDIsIHdpZHRoLTItOSxoZWlnaHQtMiwgLTMuMSwtMTIuNlxyXG4iXX0=
//# sourceURL=C:\Lab\2017\104-BouncingBalls Shootout\coffee\sketch.coffee