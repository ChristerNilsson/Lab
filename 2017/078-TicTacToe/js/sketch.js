// Generated by CoffeeScript 1.11.1
var MARKERS, WINNERS, ai, buttons, check, draw, marks, mousePressed, newGame, setup, state;

MARKERS = 'XO';

WINNERS = [7, 56, 448, 73, 146, 292, 273, 84];

buttons = null;

marks = [0, 0];

state = '';

setup = function() {
  createCanvas(400, 400);
  textAlign(CENTER, CENTER);
  textSize(90);
  return newGame();
};

newGame = function() {
  buttons = [[0, 0, ''], [0, 1, ''], [0, 2, ''], [1, 0, ''], [1, 1, ''], [1, 2, ''], [2, 0, ''], [2, 1, ''], [2, 2, '']];
  marks = [0, 0];
  return state = '';
};

ai = function() {
  var button, i;
  return _.sample((function() {
    var j, len, results;
    results = [];
    for (i = j = 0, len = buttons.length; j < len; i = ++j) {
      button = buttons[i];
      if (button[2] === '') {
        results.push(i);
      }
    }
    return results;
  })());
};

draw = function() {
  var j, len, ref, txt, x, y;
  for (j = 0, len = buttons.length; j < len; j++) {
    ref = buttons[j], x = ref[0], y = ref[1], txt = ref[2];
    fc(1);
    rect(100 * x, 100 * y, 100, 100);
    fc(0);
    text(txt, 100 * x + 50, 100 * y + 50);
  }
  fc(1, 0, 0);
  return text(state, 150, 150);
};

check = function(player, index) {
  var j, len, results, winner;
  if (state !== '') {
    return;
  }
  buttons[index][2] = MARKERS[player];
  marks[player] |= 1 << index;
  results = [];
  for (j = 0, len = WINNERS.length; j < len; j++) {
    winner = WINNERS[j];
    if ((winner & marks[player]) === winner) {
      results.push(state = MARKERS[player] + ' wins!');
    } else {
      results.push(void 0);
    }
  }
  return results;
};

mousePressed = function() {
  var index, j, len, mx, my, ref, results, txt, x, y;
  if (state !== '') {
    return newGame();
  }
  mx = int(mouseX / 100);
  my = int(mouseY / 100);
  results = [];
  for (j = 0, len = buttons.length; j < len; j++) {
    ref = buttons[j], x = ref[0], y = ref[1], txt = ref[2];
    index = 3 * x + y;
    if (mx === x && my === y && txt === '') {
      check(0, index);
      results.push(check(1, ai()));
    } else {
      results.push(void 0);
    }
  }
  return results;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsT0FBQSxHQUFVOztBQUNWLE9BQUEsR0FBVSxDQUFDLENBQUQsRUFBRyxFQUFILEVBQU0sR0FBTixFQUFVLEVBQVYsRUFBYSxHQUFiLEVBQWlCLEdBQWpCLEVBQXFCLEdBQXJCLEVBQXlCLEVBQXpCOztBQUVWLE9BQUEsR0FBVTs7QUFDVixLQUFBLEdBQVEsQ0FBQyxDQUFELEVBQUcsQ0FBSDs7QUFDUixLQUFBLEdBQVE7O0FBRVIsS0FBQSxHQUFRLFNBQUE7RUFDUCxZQUFBLENBQWEsR0FBYixFQUFpQixHQUFqQjtFQUNBLFNBQUEsQ0FBVSxNQUFWLEVBQWlCLE1BQWpCO0VBQ0EsUUFBQSxDQUFTLEVBQVQ7U0FDQSxPQUFBLENBQUE7QUFKTzs7QUFNUixPQUFBLEdBQVUsU0FBQTtFQUNULE9BQUEsR0FBVSxDQUFDLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQUQsRUFBVSxDQUFDLENBQUQsRUFBRyxDQUFILEVBQUssRUFBTCxDQUFWLEVBQW1CLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQW5CLEVBQTRCLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQTVCLEVBQXFDLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQXJDLEVBQThDLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQTlDLEVBQXVELENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQXZELEVBQWdFLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQWhFLEVBQXlFLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQXpFO0VBQ1YsS0FBQSxHQUFRLENBQUMsQ0FBRCxFQUFHLENBQUg7U0FDUixLQUFBLEdBQVE7QUFIQzs7QUFLVixFQUFBLEdBQUssU0FBQTtBQUFHLE1BQUE7U0FBQSxDQUFDLENBQUMsTUFBRjs7QUFBVTtTQUFBLGlEQUFBOztVQUErQixNQUFPLENBQUEsQ0FBQSxDQUFQLEtBQWE7cUJBQTVDOztBQUFBOztNQUFWO0FBQUg7O0FBRUwsSUFBQSxHQUFPLFNBQUE7QUFDTixNQUFBO0FBQUEsT0FBQSx5Q0FBQTtzQkFBSyxZQUFFLFlBQUU7SUFDUixFQUFBLENBQUcsQ0FBSDtJQUNBLElBQUEsQ0FBSyxHQUFBLEdBQUksQ0FBVCxFQUFXLEdBQUEsR0FBSSxDQUFmLEVBQWlCLEdBQWpCLEVBQXFCLEdBQXJCO0lBQ0EsRUFBQSxDQUFHLENBQUg7SUFDQSxJQUFBLENBQUssR0FBTCxFQUFTLEdBQUEsR0FBSSxDQUFKLEdBQU0sRUFBZixFQUFrQixHQUFBLEdBQUksQ0FBSixHQUFNLEVBQXhCO0FBSkQ7RUFLQSxFQUFBLENBQUcsQ0FBSCxFQUFLLENBQUwsRUFBTyxDQUFQO1NBQ0EsSUFBQSxDQUFLLEtBQUwsRUFBVyxHQUFYLEVBQWUsR0FBZjtBQVBNOztBQVNQLEtBQUEsR0FBUSxTQUFDLE1BQUQsRUFBUSxLQUFSO0FBQ1AsTUFBQTtFQUFBLElBQUcsS0FBQSxLQUFTLEVBQVo7QUFBb0IsV0FBcEI7O0VBQ0EsT0FBUSxDQUFBLEtBQUEsQ0FBTyxDQUFBLENBQUEsQ0FBZixHQUFvQixPQUFRLENBQUEsTUFBQTtFQUM1QixLQUFNLENBQUEsTUFBQSxDQUFOLElBQWlCLENBQUEsSUFBSztBQUN0QjtPQUFBLHlDQUFBOztJQUNDLElBQUcsQ0FBQyxNQUFBLEdBQVMsS0FBTSxDQUFBLE1BQUEsQ0FBaEIsQ0FBQSxLQUE0QixNQUEvQjttQkFDQyxLQUFBLEdBQVEsT0FBUSxDQUFBLE1BQUEsQ0FBUixHQUFrQixVQUQzQjtLQUFBLE1BQUE7MkJBQUE7O0FBREQ7O0FBSk87O0FBUVIsWUFBQSxHQUFlLFNBQUE7QUFDZCxNQUFBO0VBQUEsSUFBRyxLQUFBLEtBQVMsRUFBWjtBQUFvQixXQUFPLE9BQUEsQ0FBQSxFQUEzQjs7RUFDQSxFQUFBLEdBQUssR0FBQSxDQUFJLE1BQUEsR0FBTyxHQUFYO0VBQ0wsRUFBQSxHQUFLLEdBQUEsQ0FBSSxNQUFBLEdBQU8sR0FBWDtBQUNMO09BQUEseUNBQUE7c0JBQUssWUFBRSxZQUFFO0lBQ1IsS0FBQSxHQUFRLENBQUEsR0FBRSxDQUFGLEdBQUk7SUFDWixJQUFHLEVBQUEsS0FBSSxDQUFKLElBQVUsRUFBQSxLQUFJLENBQWQsSUFBb0IsR0FBQSxLQUFLLEVBQTVCO01BQ0MsS0FBQSxDQUFNLENBQU4sRUFBUSxLQUFSO21CQUNBLEtBQUEsQ0FBTSxDQUFOLEVBQVEsRUFBQSxDQUFBLENBQVIsR0FGRDtLQUFBLE1BQUE7MkJBQUE7O0FBRkQ7O0FBSmMiLCJzb3VyY2VzQ29udGVudCI6WyJNQVJLRVJTID0gJ1hPJ1xyXG5XSU5ORVJTID0gWzcsNTYsNDQ4LDczLDE0NiwyOTIsMjczLDg0XVxyXG5cclxuYnV0dG9ucyA9IG51bGxcclxubWFya3MgPSBbMCwwXVxyXG5zdGF0ZSA9ICcnXHJcblxyXG5zZXR1cCA9IC0+XHJcblx0Y3JlYXRlQ2FudmFzIDQwMCw0MDBcclxuXHR0ZXh0QWxpZ24gQ0VOVEVSLENFTlRFUlxyXG5cdHRleHRTaXplIDkwXHJcblx0bmV3R2FtZSgpXHJcblxyXG5uZXdHYW1lID0gLT5cclxuXHRidXR0b25zID0gW1swLDAsJyddLFswLDEsJyddLFswLDIsJyddLFsxLDAsJyddLFsxLDEsJyddLFsxLDIsJyddLFsyLDAsJyddLFsyLDEsJyddLFsyLDIsJyddXVxyXG5cdG1hcmtzID0gWzAsMF1cclxuXHRzdGF0ZSA9ICcnXHJcblxyXG5haSA9IC0+IF8uc2FtcGxlIChpIGZvciBidXR0b24saSBpbiBidXR0b25zIHdoZW4gYnV0dG9uWzJdID09ICcnKVxyXG5cclxuZHJhdyA9IC0+XHJcblx0Zm9yIFt4LHksdHh0XSBpbiBidXR0b25zXHJcblx0XHRmYyAxXHJcblx0XHRyZWN0IDEwMCp4LDEwMCp5LDEwMCwxMDBcclxuXHRcdGZjIDBcclxuXHRcdHRleHQgdHh0LDEwMCp4KzUwLDEwMCp5KzUwXHJcblx0ZmMgMSwwLDBcclxuXHR0ZXh0IHN0YXRlLDE1MCwxNTBcclxuXHJcbmNoZWNrID0gKHBsYXllcixpbmRleCkgLT5cclxuXHRpZiBzdGF0ZSAhPSAnJyB0aGVuIHJldHVyblxyXG5cdGJ1dHRvbnNbaW5kZXhdWzJdID0gTUFSS0VSU1twbGF5ZXJdXHJcblx0bWFya3NbcGxheWVyXSB8PSAxIDw8IGluZGV4XHJcblx0Zm9yIHdpbm5lciBpbiBXSU5ORVJTXHJcblx0XHRpZiAod2lubmVyICYgbWFya3NbcGxheWVyXSkgPT0gd2lubmVyXHJcblx0XHRcdHN0YXRlID0gTUFSS0VSU1twbGF5ZXJdICsgJyB3aW5zISdcclxuXHJcbm1vdXNlUHJlc3NlZCA9IC0+XHJcblx0aWYgc3RhdGUgIT0gJycgdGhlbiByZXR1cm4gbmV3R2FtZSgpXHJcblx0bXggPSBpbnQgbW91c2VYLzEwMFxyXG5cdG15ID0gaW50IG1vdXNlWS8xMDBcclxuXHRmb3IgW3gseSx0eHRdIGluIGJ1dHRvbnNcclxuXHRcdGluZGV4ID0gMyp4K3lcclxuXHRcdGlmIG14PT14IGFuZCBteT09eSBhbmQgdHh0PT0nJ1xyXG5cdFx0XHRjaGVjayAwLGluZGV4XHJcblx0XHRcdGNoZWNrIDEsYWkoKSJdfQ==
//# sourceURL=C:\Lab\2017\078-TicTacToe\coffee\sketch.coffee