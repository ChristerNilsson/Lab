// Generated by CoffeeScript 1.11.1
var MARKERS, WINNERS, ai, buttons, check, draw, marks, mousePressed, newGame, setup, state;

MARKERS = 'XO';

WINNERS = [7, 56, 448, 73, 146, 292, 273, 84];

buttons = null;

marks = [0, 0];

state = '';

setup = function() {
  createCanvas(400, 400);
  textAlign(CENTER, CENTER);
  textSize(90);
  return newGame();
};

newGame = function() {
  buttons = [[0, 0, ''], [0, 1, ''], [0, 2, ''], [1, 0, ''], [1, 1, ''], [1, 2, ''], [2, 0, ''], [2, 1, ''], [2, 2, '']];
  marks = [0, 0];
  return state = '';
};

ai = function() {
  var button, i;
  return _.sample((function() {
    var j, len, results;
    results = [];
    for (i = j = 0, len = buttons.length; j < len; i = ++j) {
      button = buttons[i];
      if (button[2] === '') {
        results.push(i);
      }
    }
    return results;
  })());
};

draw = function() {
  var j, len, ref, results, txt, x, y;
  results = [];
  for (j = 0, len = buttons.length; j < len; j++) {
    ref = buttons[j], x = ref[0], y = ref[1], txt = ref[2];
    fc(1);
    rect(100 * x, 100 * y, 100, 100);
    fc(0);
    text(txt, 100 * x + 50, 100 * y + 50);
    fc(1, 0, 0);
    results.push(text(state, 150, 150));
  }
  return results;
};

check = function(player, index) {
  var j, len, results, winner;
  if (state !== '') {
    return;
  }
  buttons[index][2] = MARKERS[player];
  marks[player] |= 1 << index;
  results = [];
  for (j = 0, len = WINNERS.length; j < len; j++) {
    winner = WINNERS[j];
    if ((winner & marks[player]) === winner) {
      results.push(state = MARKERS[player] + ' wins!');
    } else {
      results.push(void 0);
    }
  }
  return results;
};

mousePressed = function() {
  var index, j, len, mx, my, ref, results, txt, x, y;
  if (state !== '') {
    return newGame();
  }
  mx = int(mouseX / 100);
  my = int(mouseY / 100);
  results = [];
  for (j = 0, len = buttons.length; j < len; j++) {
    ref = buttons[j], x = ref[0], y = ref[1], txt = ref[2];
    index = 3 * x + y;
    if (mx === x && my === y && txt === '') {
      check(0, index);
      results.push(check(1, ai()));
    } else {
      results.push(void 0);
    }
  }
  return results;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsT0FBQSxHQUFVOztBQUNWLE9BQUEsR0FBVSxDQUFDLENBQUQsRUFBRyxFQUFILEVBQU0sR0FBTixFQUFVLEVBQVYsRUFBYSxHQUFiLEVBQWlCLEdBQWpCLEVBQXFCLEdBQXJCLEVBQXlCLEVBQXpCOztBQUVWLE9BQUEsR0FBVTs7QUFDVixLQUFBLEdBQVEsQ0FBQyxDQUFELEVBQUcsQ0FBSDs7QUFDUixLQUFBLEdBQVE7O0FBRVIsS0FBQSxHQUFRLFNBQUE7RUFDUCxZQUFBLENBQWEsR0FBYixFQUFpQixHQUFqQjtFQUNBLFNBQUEsQ0FBVSxNQUFWLEVBQWlCLE1BQWpCO0VBQ0EsUUFBQSxDQUFTLEVBQVQ7U0FDQSxPQUFBLENBQUE7QUFKTzs7QUFNUixPQUFBLEdBQVUsU0FBQTtFQUNULE9BQUEsR0FBVSxDQUFDLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQUQsRUFBVSxDQUFDLENBQUQsRUFBRyxDQUFILEVBQUssRUFBTCxDQUFWLEVBQW1CLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQW5CLEVBQTRCLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQTVCLEVBQXFDLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQXJDLEVBQThDLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQTlDLEVBQXVELENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQXZELEVBQWdFLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQWhFLEVBQXlFLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxFQUFMLENBQXpFO0VBQ1YsS0FBQSxHQUFRLENBQUMsQ0FBRCxFQUFHLENBQUg7U0FDUixLQUFBLEdBQVE7QUFIQzs7QUFLVixFQUFBLEdBQUssU0FBQTtBQUFHLE1BQUE7U0FBQSxDQUFDLENBQUMsTUFBRjs7QUFBVTtTQUFBLGlEQUFBOztVQUErQixNQUFPLENBQUEsQ0FBQSxDQUFQLEtBQWE7cUJBQTVDOztBQUFBOztNQUFWO0FBQUg7O0FBRUwsSUFBQSxHQUFPLFNBQUE7QUFDTixNQUFBO0FBQUE7T0FBQSx5Q0FBQTtzQkFBSyxZQUFFLFlBQUU7SUFDUixFQUFBLENBQUcsQ0FBSDtJQUNBLElBQUEsQ0FBSyxHQUFBLEdBQUksQ0FBVCxFQUFXLEdBQUEsR0FBSSxDQUFmLEVBQWlCLEdBQWpCLEVBQXFCLEdBQXJCO0lBQ0EsRUFBQSxDQUFHLENBQUg7SUFDQSxJQUFBLENBQUssR0FBTCxFQUFTLEdBQUEsR0FBSSxDQUFKLEdBQU0sRUFBZixFQUFrQixHQUFBLEdBQUksQ0FBSixHQUFNLEVBQXhCO0lBQ0EsRUFBQSxDQUFHLENBQUgsRUFBSyxDQUFMLEVBQU8sQ0FBUDtpQkFDQSxJQUFBLENBQUssS0FBTCxFQUFXLEdBQVgsRUFBZSxHQUFmO0FBTkQ7O0FBRE07O0FBU1AsS0FBQSxHQUFRLFNBQUMsTUFBRCxFQUFRLEtBQVI7QUFDUCxNQUFBO0VBQUEsSUFBRyxLQUFBLEtBQVMsRUFBWjtBQUFvQixXQUFwQjs7RUFDQSxPQUFRLENBQUEsS0FBQSxDQUFPLENBQUEsQ0FBQSxDQUFmLEdBQW9CLE9BQVEsQ0FBQSxNQUFBO0VBQzVCLEtBQU0sQ0FBQSxNQUFBLENBQU4sSUFBaUIsQ0FBQSxJQUFLO0FBQ3RCO09BQUEseUNBQUE7O0lBQ0MsSUFBRyxDQUFDLE1BQUEsR0FBUyxLQUFNLENBQUEsTUFBQSxDQUFoQixDQUFBLEtBQTRCLE1BQS9CO21CQUNDLEtBQUEsR0FBUSxPQUFRLENBQUEsTUFBQSxDQUFSLEdBQWtCLFVBRDNCO0tBQUEsTUFBQTsyQkFBQTs7QUFERDs7QUFKTzs7QUFRUixZQUFBLEdBQWUsU0FBQTtBQUNkLE1BQUE7RUFBQSxJQUFHLEtBQUEsS0FBUyxFQUFaO0FBQW9CLFdBQU8sT0FBQSxDQUFBLEVBQTNCOztFQUNBLEVBQUEsR0FBSyxHQUFBLENBQUksTUFBQSxHQUFPLEdBQVg7RUFDTCxFQUFBLEdBQUssR0FBQSxDQUFJLE1BQUEsR0FBTyxHQUFYO0FBQ0w7T0FBQSx5Q0FBQTtzQkFBSyxZQUFFLFlBQUU7SUFDUixLQUFBLEdBQVEsQ0FBQSxHQUFFLENBQUYsR0FBSTtJQUNaLElBQUcsRUFBQSxLQUFJLENBQUosSUFBVSxFQUFBLEtBQUksQ0FBZCxJQUFvQixHQUFBLEtBQUssRUFBNUI7TUFDQyxLQUFBLENBQU0sQ0FBTixFQUFRLEtBQVI7bUJBQ0EsS0FBQSxDQUFNLENBQU4sRUFBUSxFQUFBLENBQUEsQ0FBUixHQUZEO0tBQUEsTUFBQTsyQkFBQTs7QUFGRDs7QUFKYyIsInNvdXJjZXNDb250ZW50IjpbIk1BUktFUlMgPSAnWE8nXHJcbldJTk5FUlMgPSBbNyw1Niw0NDgsNzMsMTQ2LDI5MiwyNzMsODRdXHJcblxyXG5idXR0b25zID0gbnVsbFxyXG5tYXJrcyA9IFswLDBdXHJcbnN0YXRlID0gJydcclxuXHJcbnNldHVwID0gLT5cclxuXHRjcmVhdGVDYW52YXMgNDAwLDQwMFxyXG5cdHRleHRBbGlnbiBDRU5URVIsQ0VOVEVSXHJcblx0dGV4dFNpemUgOTBcclxuXHRuZXdHYW1lKClcclxuXHJcbm5ld0dhbWUgPSAtPlxyXG5cdGJ1dHRvbnMgPSBbWzAsMCwnJ10sWzAsMSwnJ10sWzAsMiwnJ10sWzEsMCwnJ10sWzEsMSwnJ10sWzEsMiwnJ10sWzIsMCwnJ10sWzIsMSwnJ10sWzIsMiwnJ11dXHJcblx0bWFya3MgPSBbMCwwXVxyXG5cdHN0YXRlID0gJydcclxuXHJcbmFpID0gLT4gXy5zYW1wbGUgKGkgZm9yIGJ1dHRvbixpIGluIGJ1dHRvbnMgd2hlbiBidXR0b25bMl0gPT0gJycpXHJcblxyXG5kcmF3ID0gLT5cclxuXHRmb3IgW3gseSx0eHRdIGluIGJ1dHRvbnNcclxuXHRcdGZjIDFcclxuXHRcdHJlY3QgMTAwKngsMTAwKnksMTAwLDEwMFxyXG5cdFx0ZmMgMFxyXG5cdFx0dGV4dCB0eHQsMTAwKngrNTAsMTAwKnkrNTBcclxuXHRcdGZjIDEsMCwwXHJcblx0XHR0ZXh0IHN0YXRlLDE1MCwxNTBcclxuXHJcbmNoZWNrID0gKHBsYXllcixpbmRleCkgLT5cclxuXHRpZiBzdGF0ZSAhPSAnJyB0aGVuIHJldHVyblxyXG5cdGJ1dHRvbnNbaW5kZXhdWzJdID0gTUFSS0VSU1twbGF5ZXJdXHJcblx0bWFya3NbcGxheWVyXSB8PSAxIDw8IGluZGV4XHJcblx0Zm9yIHdpbm5lciBpbiBXSU5ORVJTXHJcblx0XHRpZiAod2lubmVyICYgbWFya3NbcGxheWVyXSkgPT0gd2lubmVyXHJcblx0XHRcdHN0YXRlID0gTUFSS0VSU1twbGF5ZXJdICsgJyB3aW5zISdcclxuXHJcbm1vdXNlUHJlc3NlZCA9IC0+XHJcblx0aWYgc3RhdGUgIT0gJycgdGhlbiByZXR1cm4gbmV3R2FtZSgpXHJcblx0bXggPSBpbnQgbW91c2VYLzEwMFxyXG5cdG15ID0gaW50IG1vdXNlWS8xMDBcclxuXHRmb3IgW3gseSx0eHRdIGluIGJ1dHRvbnNcclxuXHRcdGluZGV4ID0gMyp4K3lcclxuXHRcdGlmIG14PT14IGFuZCBteT09eSBhbmQgdHh0PT0nJ1xyXG5cdFx0XHRjaGVjayAwLGluZGV4XHJcblx0XHRcdGNoZWNrIDEsYWkoKSJdfQ==
//# sourceURL=C:\Lab\2017\078-TicTacToe\coffee\sketch.coffee