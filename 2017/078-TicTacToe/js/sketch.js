// Generated by CoffeeScript 1.11.1
var EMPTY, MARKERS, WINNERS, ai, buttons, check, draw, marks, mousePressed, newGame, setup, state;

EMPTY = ' ';

MARKERS = 'XO';

WINNERS = [1 + 2 + 4, 8 + 16 + 32, 64 + 128 + 256, 1 + 8 + 64, 2 + 16 + 128, 4 + 32 + 256, 1 + 16 + 256, 4 + 16 + 64];

buttons = null;

marks = null;

state = null;

setup = function() {
  createCanvas(400, 400);
  textAlign(CENTER, CENTER);
  textSize(90);
  return newGame();
};

newGame = function() {
  var i;
  buttons = (function() {
    var j, len, ref, results;
    ref = range(9);
    results = [];
    for (j = 0, len = ref.length; j < len; j++) {
      i = ref[j];
      results.push(EMPTY);
    }
    return results;
  })();
  marks = [0, 0];
  return state = '';
};

ai = function() {
  var i, owner;
  return _.sample((function() {
    var j, len, results;
    results = [];
    for (i = j = 0, len = buttons.length; j < len; i = ++j) {
      owner = buttons[i];
      if (owner === EMPTY) {
        results.push(i);
      }
    }
    return results;
  })());
};

draw = function() {
  var index, j, len, owner, ref, x, y;
  for (index = j = 0, len = buttons.length; j < len; index = ++j) {
    owner = buttons[index];
    ref = [100 * (index % 3), 100 * int(index / 3)], x = ref[0], y = ref[1];
    fc(1);
    rect(x, y, 100, 100);
    fc(0);
    text(owner, x + 50, y + 50);
  }
  fc(1, 0, 0);
  return text(state, 150, 150);
};

check = function(player, index) {
  var j, len, results, winner;
  if (state !== '') {
    return;
  }
  buttons[index] = MARKERS[player];
  marks[player] |= 1 << index;
  results = [];
  for (j = 0, len = WINNERS.length; j < len; j++) {
    winner = WINNERS[j];
    if ((winner & marks[player]) === winner) {
      results.push(state = MARKERS[player] + ' wins!');
    } else {
      results.push(void 0);
    }
  }
  return results;
};

mousePressed = function() {
  var index;
  if (state !== '') {
    return newGame();
  }
  index = (int(mouseX / 100)) + 3 * int(mouseY / 100);
  if (buttons[index] === EMPTY) {
    check(0, index);
    return check(1, ai());
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsS0FBQSxHQUFROztBQUNSLE9BQUEsR0FBVTs7QUFDVixPQUFBLEdBQVUsQ0FBQyxDQUFBLEdBQUUsQ0FBRixHQUFJLENBQUwsRUFBTyxDQUFBLEdBQUUsRUFBRixHQUFLLEVBQVosRUFBZSxFQUFBLEdBQUcsR0FBSCxHQUFPLEdBQXRCLEVBQTBCLENBQUEsR0FBRSxDQUFGLEdBQUksRUFBOUIsRUFBaUMsQ0FBQSxHQUFFLEVBQUYsR0FBSyxHQUF0QyxFQUEwQyxDQUFBLEdBQUUsRUFBRixHQUFLLEdBQS9DLEVBQW1ELENBQUEsR0FBRSxFQUFGLEdBQUssR0FBeEQsRUFBNEQsQ0FBQSxHQUFFLEVBQUYsR0FBSyxFQUFqRTs7QUFFVixPQUFBLEdBQVU7O0FBQ1YsS0FBQSxHQUFROztBQUNSLEtBQUEsR0FBUTs7QUFFUixLQUFBLEdBQVEsU0FBQTtFQUNQLFlBQUEsQ0FBYSxHQUFiLEVBQWlCLEdBQWpCO0VBQ0EsU0FBQSxDQUFVLE1BQVYsRUFBaUIsTUFBakI7RUFDQSxRQUFBLENBQVMsRUFBVDtTQUNBLE9BQUEsQ0FBQTtBQUpPOztBQU1SLE9BQUEsR0FBVSxTQUFBO0FBQ1QsTUFBQTtFQUFBLE9BQUE7O0FBQVc7QUFBQTtTQUFBLHFDQUFBOzttQkFBQTtBQUFBOzs7RUFDWCxLQUFBLEdBQVEsQ0FBQyxDQUFELEVBQUcsQ0FBSDtTQUNSLEtBQUEsR0FBUTtBQUhDOztBQUtWLEVBQUEsR0FBSyxTQUFBO0FBQUcsTUFBQTtTQUFBLENBQUMsQ0FBQyxNQUFGOztBQUFVO1NBQUEsaURBQUE7O1VBQThCLEtBQUEsS0FBUztxQkFBdkM7O0FBQUE7O01BQVY7QUFBSDs7QUFFTCxJQUFBLEdBQU8sU0FBQTtBQUNOLE1BQUE7QUFBQSxPQUFBLHlEQUFBOztJQUNDLE1BQVEsQ0FBQyxHQUFBLEdBQU0sQ0FBQyxLQUFBLEdBQU0sQ0FBUCxDQUFQLEVBQWtCLEdBQUEsR0FBTSxHQUFBLENBQUksS0FBQSxHQUFNLENBQVYsQ0FBeEIsQ0FBUixFQUFDLFVBQUQsRUFBRztJQUNILEVBQUEsQ0FBRyxDQUFIO0lBQ0EsSUFBQSxDQUFLLENBQUwsRUFBTyxDQUFQLEVBQVMsR0FBVCxFQUFhLEdBQWI7SUFDQSxFQUFBLENBQUcsQ0FBSDtJQUNBLElBQUEsQ0FBSyxLQUFMLEVBQVcsQ0FBQSxHQUFFLEVBQWIsRUFBZ0IsQ0FBQSxHQUFFLEVBQWxCO0FBTEQ7RUFNQSxFQUFBLENBQUcsQ0FBSCxFQUFLLENBQUwsRUFBTyxDQUFQO1NBQ0EsSUFBQSxDQUFLLEtBQUwsRUFBVyxHQUFYLEVBQWUsR0FBZjtBQVJNOztBQVVQLEtBQUEsR0FBUSxTQUFDLE1BQUQsRUFBUSxLQUFSO0FBQ1AsTUFBQTtFQUFBLElBQUcsS0FBQSxLQUFTLEVBQVo7QUFBb0IsV0FBcEI7O0VBQ0EsT0FBUSxDQUFBLEtBQUEsQ0FBUixHQUFpQixPQUFRLENBQUEsTUFBQTtFQUN6QixLQUFNLENBQUEsTUFBQSxDQUFOLElBQWlCLENBQUEsSUFBSztBQUN0QjtPQUFBLHlDQUFBOztJQUNDLElBQUcsQ0FBQyxNQUFBLEdBQVMsS0FBTSxDQUFBLE1BQUEsQ0FBaEIsQ0FBQSxLQUE0QixNQUEvQjttQkFBMkMsS0FBQSxHQUFRLE9BQVEsQ0FBQSxNQUFBLENBQVIsR0FBa0IsVUFBckU7S0FBQSxNQUFBOzJCQUFBOztBQUREOztBQUpPOztBQU9SLFlBQUEsR0FBZSxTQUFBO0FBQ2QsTUFBQTtFQUFBLElBQUcsS0FBQSxLQUFTLEVBQVo7QUFBb0IsV0FBTyxPQUFBLENBQUEsRUFBM0I7O0VBQ0EsS0FBQSxHQUFRLENBQUMsR0FBQSxDQUFJLE1BQUEsR0FBTyxHQUFYLENBQUQsQ0FBQSxHQUFtQixDQUFBLEdBQUksR0FBQSxDQUFJLE1BQUEsR0FBTyxHQUFYO0VBQy9CLElBQUcsT0FBUSxDQUFBLEtBQUEsQ0FBUixLQUFrQixLQUFyQjtJQUNDLEtBQUEsQ0FBTSxDQUFOLEVBQVEsS0FBUjtXQUNBLEtBQUEsQ0FBTSxDQUFOLEVBQVEsRUFBQSxDQUFBLENBQVIsRUFGRDs7QUFIYyIsInNvdXJjZXNDb250ZW50IjpbIkVNUFRZID0gJyAnXHJcbk1BUktFUlMgPSAnWE8nXHJcbldJTk5FUlMgPSBbMSsyKzQsOCsxNiszMiw2NCsxMjgrMjU2LDErOCs2NCwyKzE2KzEyOCw0KzMyKzI1NiwxKzE2KzI1Niw0KzE2KzY0XVxyXG5cclxuYnV0dG9ucyA9IG51bGxcclxubWFya3MgPSBudWxsXHJcbnN0YXRlID0gbnVsbFxyXG5cclxuc2V0dXAgPSAtPlxyXG5cdGNyZWF0ZUNhbnZhcyA0MDAsNDAwXHJcblx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHR0ZXh0U2l6ZSA5MFxyXG5cdG5ld0dhbWUoKVxyXG5cclxubmV3R2FtZSA9IC0+XHJcblx0YnV0dG9ucyA9IChFTVBUWSBmb3IgaSBpbiByYW5nZSA5KVxyXG5cdG1hcmtzID0gWzAsMF1cclxuXHRzdGF0ZSA9ICcnXHJcblxyXG5haSA9IC0+IF8uc2FtcGxlIChpIGZvciBvd25lcixpIGluIGJ1dHRvbnMgd2hlbiBvd25lciA9PSBFTVBUWSlcclxuXHJcbmRyYXcgPSAtPlxyXG5cdGZvciBvd25lcixpbmRleCBpbiBidXR0b25zXHJcblx0XHRbeCx5XSA9IFsxMDAgKiAoaW5kZXglMyksIDEwMCAqIGludCBpbmRleC8zXVxyXG5cdFx0ZmMgMVxyXG5cdFx0cmVjdCB4LHksMTAwLDEwMFxyXG5cdFx0ZmMgMFxyXG5cdFx0dGV4dCBvd25lcix4KzUwLHkrNTBcclxuXHRmYyAxLDAsMFxyXG5cdHRleHQgc3RhdGUsMTUwLDE1MFxyXG5cclxuY2hlY2sgPSAocGxheWVyLGluZGV4KSAtPlxyXG5cdGlmIHN0YXRlICE9ICcnIHRoZW4gcmV0dXJuXHJcblx0YnV0dG9uc1tpbmRleF0gPSBNQVJLRVJTW3BsYXllcl1cclxuXHRtYXJrc1twbGF5ZXJdIHw9IDEgPDwgaW5kZXhcclxuXHRmb3Igd2lubmVyIGluIFdJTk5FUlNcclxuXHRcdGlmICh3aW5uZXIgJiBtYXJrc1twbGF5ZXJdKSA9PSB3aW5uZXIgdGhlbiBzdGF0ZSA9IE1BUktFUlNbcGxheWVyXSArICcgd2lucyEnXHJcblxyXG5tb3VzZVByZXNzZWQgPSAtPlxyXG5cdGlmIHN0YXRlICE9ICcnIHRoZW4gcmV0dXJuIG5ld0dhbWUoKVxyXG5cdGluZGV4ID0gKGludCBtb3VzZVgvMTAwKSArIDMgKiBpbnQgbW91c2VZLzEwMFxyXG5cdGlmIGJ1dHRvbnNbaW5kZXhdID09IEVNUFRZXHJcblx0XHRjaGVjayAwLGluZGV4XHJcblx0XHRjaGVjayAxLGFpKCkiXX0=
//# sourceURL=C:\Lab\2017\078-TicTacToe\coffee\sketch.coffee