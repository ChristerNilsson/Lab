// Generated by CoffeeScript 2.4.1
// http://www.husdyr.kvl.dk/htm/kc/popgen/genetics/4/5.htm
var N, calc, facit, i, j, k, l, len, len1, len2, len3, m, matrix, n, p, parents, person, ref, ref1, ref2, ref3;

facit = [[0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1 / 2, 1 / 2, 1 / 2, 1 / 2, 1 / 2, 1 / 2], [0, 1 / 2, 1, 1 / 4, 1 / 4, 5 / 8, 1 / 4, 7 / 16], [0, 1 / 2, 1 / 4, 1, 1 / 4, 5 / 8, 5 / 8, 5 / 8], [0, 1 / 2, 1 / 4, 1 / 4, 1, 1 / 4, 5 / 8, 7 / 16], [0, 1 / 2, 5 / 8, 5 / 8, 1 / 4, 1 + 1 / 8, 7 / 16, 25 / 32], [0, 1 / 2, 1 / 4, 5 / 8, 5 / 8, 7 / 16, 1 + 1 / 8, 25 / 32], [0, 1 / 2, 7 / 16, 5 / 8, 7 / 16, 25 / 32, 25 / 32, 1 + 7 / 32]];

parents = [];

person = (sire = 0, dame = 0) => {
  return parents.push({sire, dame});
};

person(); // not used

person(); // oldest, index=1

person(1); // sire=1 dame=unknown

person(1);

person(1);

person(3, 2);

person(3, 4);

person(5, 6);

N = parents.length;

matrix = (function() {
  var k, len, ref, results;
  ref = range(N);
  results = [];
  for (k = 0, len = ref.length; k < len; k++) {
    j = ref[k];
    results.push((function() {
      var l, len1, ref1, results1;
      ref1 = range(N);
      results1 = [];
      for (l = 0, len1 = ref1.length; l < len1; l++) {
        i = ref1[l];
        results1.push(0);
      }
      return results1;
    })());
  }
  return results;
})();

ref = range(1, N);
for (k = 0, len = ref.length; k < len; k++) {
  i = ref[k];
  matrix[i][i] = 1;
  p = parents[i];
  matrix[i][i] += matrix[p.sire][p.dame] / 2;
  ref1 = range(i + 1, N);
  for (l = 0, len1 = ref1.length; l < len1; l++) {
    j = ref1[l];
    p = parents[j];
    matrix[i][j] = matrix[j][i] = (matrix[i][p.sire] + matrix[i][p.dame]) / 2;
  }
}

ref2 = range(1, N);
for (m = 0, len2 = ref2.length; m < len2; m++) {
  i = ref2[m];
  ref3 = range(1, N);
  for (n = 0, len3 = ref3.length; n < len3; n++) {
    j = ref3[n];
    assert(matrix[i][j], facit[i][j]);
  }
}

calc = (a, b) => {
  return matrix[a][b];
};

assert(1 / 4, calc(3, 2));

assert(1 / 4, calc(3, 4));

assert(7 / 16, calc(5, 6));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQUEsSUFBQSxDQUFBLEVBQUEsSUFBQSxFQUFBLEtBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxNQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBOztBQUVBLEtBQUEsR0FBUSxDQUNQLENBQUMsQ0FBRCxFQUFJLENBQUosRUFBUyxDQUFULEVBQWUsQ0FBZixFQUFvQixDQUFwQixFQUEwQixDQUExQixFQUFpQyxDQUFqQyxFQUF3QyxDQUF4QyxDQURPLEVBRVAsQ0FBQyxDQUFELEVBQUksQ0FBSixFQUFTLENBQUEsR0FBRSxDQUFYLEVBQWUsQ0FBQSxHQUFFLENBQWpCLEVBQW9CLENBQUEsR0FBRSxDQUF0QixFQUEwQixDQUFBLEdBQUUsQ0FBNUIsRUFBaUMsQ0FBQSxHQUFFLENBQW5DLEVBQXdDLENBQUEsR0FBRSxDQUExQyxDQUZPLEVBR1AsQ0FBQyxDQUFELEVBQUksQ0FBQSxHQUFFLENBQU4sRUFBUyxDQUFULEVBQWUsQ0FBQSxHQUFFLENBQWpCLEVBQW9CLENBQUEsR0FBRSxDQUF0QixFQUEwQixDQUFBLEdBQUUsQ0FBNUIsRUFBaUMsQ0FBQSxHQUFFLENBQW5DLEVBQXdDLENBQUEsR0FBRSxFQUExQyxDQUhPLEVBSVAsQ0FBQyxDQUFELEVBQUksQ0FBQSxHQUFFLENBQU4sRUFBUyxDQUFBLEdBQUUsQ0FBWCxFQUFlLENBQWYsRUFBb0IsQ0FBQSxHQUFFLENBQXRCLEVBQTBCLENBQUEsR0FBRSxDQUE1QixFQUFpQyxDQUFBLEdBQUUsQ0FBbkMsRUFBd0MsQ0FBQSxH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QUEsR0FBTyxDQUFDLENBQUQsRUFBRyxDQUFILENBQUEsR0FBQTtTQUFTLE1BQU8sQ0FBQSxDQUFBLENBQUcsQ0FBQSxDQUFBO0FBQW5COztBQUVQLE1BQUEsQ0FBTyxDQUFBLEdBQUUsQ0FBVCxFQUFhLElBQUEsQ0FBSyxDQUFMLEVBQU8sQ0FBUCxDQUFiOztBQUNBLE1BQUEsQ0FBTyxDQUFBLEdBQUUsQ0FBVCxFQUFhLElBQUEsQ0FBSyxDQUFMLEVBQU8sQ0FBUCxDQUFiOztBQUNBLE1BQUEsQ0FBTyxDQUFBLEdBQUUsRUFBVCxFQUFhLElBQUEsQ0FBSyxDQUFMLEVBQU8sQ0FBUCxDQUFiIiwic291cmNlc0NvbnRlbnQiOlsiIyBodHRwOi8vd3d3Lmh1c2R5ci5rdmwuZGsvaHRtL2tjL3BvcGdlbi9nZW5ldGljcy80LzUuaHRtXHJcblxyXG5mYWNpdCA9IFtcclxuXHRbMCwgMCwgICAwLCAgICAwLCAgIDAsICAgIDAsICAgICAwLCAgICAgMF1cclxuXHRbMCwgMSwgICAxLzIsICAxLzIsIDEvMiwgIDEvMiwgICAxLzIsICAgMS8yXVxyXG5cdFswLCAxLzIsIDEsICAgIDEvNCwgMS80LCAgNS84LCAgIDEvNCwgICA3LzE2XVxyXG5cdFswLCAxLzIsIDEvNCwgIDEsICAgMS80LCAgNS84LCAgIDUvOCwgICA1LzhdXHJcblx0WzAsIDEvMiwgMS80LCAgMS80LCAxLCAgICAxLzQsICAgNS84LCAgIDcvMTZdXHJcblx0WzAsIDEvMiwgNS84LCAgNS84LCAxLzQsICAxKzEvOCwgNy8xNiwgIDI1LzMyXVxyXG5cdFswLCAxLzIsIDEvNCwgIDUvOCwgNS84LCAgNy8xNiwgIDErMS84LCAyNS8zMl1cclxuXHRbMCwgMS8yLCA3LzE2LCA1LzgsIDcvMTYsIDI1LzMyLCAyNS8zMiwgMSs3LzMyXVxyXG5dXHJcblxyXG5wYXJlbnRzID0gW11cclxuXHJcbnBlcnNvbiA9IChzaXJlPTAsZGFtZT0wKSA9PiBwYXJlbnRzLnB1c2gge3NpcmUsZGFtZX1cclxuXHJcbnBlcnNvbigpICMgbm90IHVzZWRcclxucGVyc29uKCkgIyBvbGRlc3QsIGluZGV4PTFcclxucGVyc29uIDEgIyBzaXJlPTEgZGFtZT11bmtub3duXHJcbnBlcnNvbiAxXHJcbnBlcnNvbiAxXHJcbnBlcnNvbiAzLDJcclxucGVyc29uIDMsNFxyXG5wZXJzb24gNSw2XHJcblxyXG5OID0gcGFyZW50cy5sZW5ndGhcclxuXHJcbm1hdHJpeCA9ICgwIGZvciBpIGluIHJhbmdlIE4gZm9yIGogaW4gcmFuZ2UgTilcclxuXHJcbmZvciBpIGluIHJhbmdlIDEsTlxyXG5cdG1hdHJpeFtpXVtpXSA9IDFcclxuXHRwID0gcGFyZW50c1tpXVxyXG5cdG1hdHJpeFtpXVtpXSArPSBtYXRyaXhbcC5zaXJlXVtwLmRhbWVdLzJcclxuXHRmb3IgaiBpbiByYW5nZSBpKzEsTlxyXG5cdFx0cCA9IHBhcmVudHNbal1cclxuXHRcdG1hdHJpeFtpXVtqXSA9IG1hdHJpeFtqXVtpXSA9IChtYXRyaXhbaV1bcC5zaXJlXSArIG1hdHJpeFtpXVtwLmRhbWVdKS8yXHJcblxyXG5mb3IgaSBpbiByYW5nZSAxLE5cclxuXHRmb3IgaiBpbiByYW5nZSAxLE5cclxuXHRcdGFzc2VydCBtYXRyaXhbaV1bal0sIGZhY2l0W2ldW2pdXHJcblxyXG5jYWxjID0gKGEsYikgPT4gbWF0cml4W2FdW2JdXHJcblxyXG5hc3NlcnQgMS80LCAgY2FsYyAzLDJcclxuYXNzZXJ0IDEvNCwgIGNhbGMgMyw0XHJcbmFzc2VydCA3LzE2LCBjYWxjIDUsNlxyXG4iXX0=
//# sourceURL=c:\Lab\2020\022-Inbreeding\coffee\sketch.coffee