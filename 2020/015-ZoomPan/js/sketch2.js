// Generated by CoffeeScript 2.4.1
var bakgrund, clearLog, draw, enableLog, handle_pinch_zoom, logga, loggaEvents, setup, touchEnded, touchMoved, touchStarted, tpCache, update_background;

loggaEvents = false;

tpCache = [];

bakgrund = '#888';

setup = function() {
  createCanvas(windowWidth, windowHeight / 2);
  return logga("Hej HÃ¤pp 30!");
};

draw = function() {
  return background(bakgrund);
};

enableLog = function() {
  return loggaEvents = !loggaEvents;
};

logga = function(name, printTargetIds = false) {
  var o, t;
  if (!loggaEvents) {
    return;
  }
  o = document.getElementsByTagName('output')[0];
  o.innerHTML += `${name}: touches = ${touches.length} <br>`;
  if (printTargetIds) {
    return o.innerHTML += ((function() {
      var j, len, results;
      results = [];
      for (j = 0, len = touches.length; j < len; j++) {
        t = touches[j];
        results.push(`... id = ${t.id}`);
      }
      return results;
    })()).join('<br>');
  }
};

clearLog = function() {
  var o;
  o = document.getElementsByTagName('output')[0];
  return o.innerHTML = "";
};

update_background = function(ev) {
  var n;
  n = touches.length;
  bakgrund = "lightblue";
  if (n === 1) {
    bakgrund = "yellow";
  }
  if (n === 2) {
    bakgrund = "pink";
  }
  return logga(`update_background ${bakgrund}`);
};

handle_pinch_zoom = function(ev) {
  var PINCH_THRESHHOLD, diff0, diff1, e, i, index0, index1, j, len, ref;
  try {
    logga(`--HPZ ${tpCache.length} ${touches.length}`);
    if (touches.length === 2) {
      // Check if the two target touches are the same ones that started the 2-touch
      index0 = -1;
      index1 = -1;
      ref = range(tpCache.length);
      for (j = 0, len = ref.length; j < len; j++) {
        i = ref[j];
        if (tpCache[i].id === touches[0].id) {
          index0 = i;
        }
        if (tpCache[i].id === touches[1].id) {
          index1 = i;
        }
      }
      logga(`----index ${index0} ${index1}`);
      if (index0 >= 0 && index1 >= 0) {
        // Calculate the difference between the start and move coordinates
        diff0 = int(dist(tpCache[index0].x, tpCache[index0].y, touches[0].x, touches[0].y));
        diff1 = int(dist(tpCache[index1].x, tpCache[index1].y, touches[1].x, touches[1].y));
        // This threshold is device dependent as well as application specific
        PINCH_THRESHHOLD = ev.target.clientWidth / 10;
        logga(`----diff ${diff0} ${diff1} ${PINCH_THRESHHOLD}`);
        if (diff0 >= PINCH_THRESHHOLD && diff1 >= PINCH_THRESHHOLD) {
          bakgrund = "green";
        }
        return logga(`----bakgrund ${bakgrund}`);
      } else {
        return tpCache = [];
      }
    }
  } catch (error) {
    e = error;
    return logga(`error in HPZ ${e}`);
  }
};

touchStarted = function(ev) {
  var e, j, len, t;
  try {
    logga('touchStarted', true);
    ev.preventDefault();
    if (touches.length === 2) {
      for (j = 0, len = touches.length; j < len; j++) {
        t = touches[j];
        tpCache.push(t);
      }
    }
    return update_background(ev);
  } catch (error) {
    e = error;
    return logga("error in Started");
  }
};

touchMoved = function(ev) {
  try {
    logga('touchMoved');
    ev.preventDefault();
    if (!touches.length === 2) {
      update_background(ev);
    }
    ev.target.style.outline = "dashed";
    return handle_pinch_zoom(ev);
  } catch (error) {
    return logga("error in Moved");
  }
};

touchEnded = function(ev) {
  var e;
  try {
    logga('touchEnded');
    ev.preventDefault();
    if (touches.length === 0) {
      // Restore background and outline to original values
      ev.target.style.background = "white";
      return ev.target.style.outline = "1px solid black";
    }
  } catch (error) {
    e = error;
    return logga("error in Ended");
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoMi5qcyIsInNvdXJjZVJvb3QiOiIuLiIsInNvdXJjZXMiOlsiY29mZmVlXFxza2V0Y2gyLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsSUFBQSxRQUFBLEVBQUEsUUFBQSxFQUFBLElBQUEsRUFBQSxTQUFBLEVBQUEsaUJBQUEsRUFBQSxLQUFBLEVBQUEsV0FBQSxFQUFBLEtBQUEsRUFBQSxVQUFBLEVBQUEsVUFBQSxFQUFBLFlBQUEsRUFBQSxPQUFBLEVBQUE7O0FBQUEsV0FBQSxHQUFjOztBQUNkLE9BQUEsR0FBVTs7QUFDVixRQUFBLEdBQVc7O0FBRVgsS0FBQSxHQUFRLFFBQUEsQ0FBQSxDQUFBO0VBQ1AsWUFBQSxDQUFhLFdBQWIsRUFBeUIsWUFBQSxHQUFhLENBQXRDO1NBQ0EsS0FBQSxDQUFNLGNBQU47QUFGTzs7QUFJUixJQUFBLEdBQU8sUUFBQSxDQUFBLENBQUE7U0FBRyxVQUFBLENBQVcsUUFBWDtBQUFIOztBQUVQLFNBQUEsR0FBWSxRQUFBLENBQUEsQ0FBQTtTQUFHLFdBQUEsR0FBYyxDQUFJO0FBQXJCOztBQUVaLEtBQUEsR0FBUSxRQUFBLENBQUMsSUFBRCxFQUFPLGlCQUFlLEtBQXRCLENBQUE7QUFDUCxNQUFBLENBQUEsRUFBQTtFQUFBLElBQUcsQ0FBSSxXQUFQO0FBQXdCLFdBQXhCOztFQUNBLENBQUEsR0FBSSxRQUFRLENBQUMsb0JBQVQsQ0FBOEIsUUFBOUIsQ0FBd0MsQ0FBQSxDQUFBO0VBQzVDLENBQUMsQ0FBQyxTQUFGLElBQWUsQ0FBQSxDQUFBLENBQUcsSUFBSCxDQUFRLFlBQVIsQ0FBQSxDQUFzQixPQUFPLENBQUMsTUFBOUIsQ0FBcUMsS0FBckM7RUFDZixJQUFHLGNBQUg7V0FBdUIsQ0FBQyxDQUFDLFNBQUYsSUFBZTs7QUFBb0I7TUFBQSxLQUFBLHlDQUFBOztxQkFBbkIsQ0FBQSxTQUFBLENBQUEsQ0FBWSxDQUFDLENBQUMsRUFBZCxDQUFBO01BQW1CLENBQUE7O1FBQXBCLENBQXFDLENB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RDs7QUFEWSIsInNvdXJjZXNDb250ZW50IjpbImxvZ2dhRXZlbnRzID0gZmFsc2VcclxudHBDYWNoZSA9IFtdXHJcbmJha2dydW5kID0gJyM4ODgnXHJcblxyXG5zZXR1cCA9IC0+XHJcblx0Y3JlYXRlQ2FudmFzIHdpbmRvd1dpZHRoLHdpbmRvd0hlaWdodC8yXHJcblx0bG9nZ2EgXCJIZWogSMOkcHAgMzAhXCJcclxuXHJcbmRyYXcgPSAtPlx0YmFja2dyb3VuZCBiYWtncnVuZFxyXG5cclxuZW5hYmxlTG9nID0gLT4gbG9nZ2FFdmVudHMgPSBub3QgbG9nZ2FFdmVudHNcclxuXHJcbmxvZ2dhID0gKG5hbWUsIHByaW50VGFyZ2V0SWRzPWZhbHNlKSAtPlxyXG5cdGlmIG5vdCBsb2dnYUV2ZW50cyB0aGVuIHJldHVyblxyXG5cdG8gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnb3V0cHV0JylbMF1cclxuXHRvLmlubmVySFRNTCArPSBcIiN7bmFtZX06IHRvdWNoZXMgPSAje3RvdWNoZXMubGVuZ3RofSA8YnI+XCJcclxuXHRpZiBwcmludFRhcmdldElkcyB0aGVuIG8uaW5uZXJIVE1MICs9IChcIi4uLiBpZCA9ICN7dC5pZH1cIiBmb3IgdCBpbiB0b3VjaGVzKS5qb2luICc8YnI+J1xyXG5cclxuY2xlYXJMb2cgPSAtPlxyXG5cdG8gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnb3V0cHV0JylbMF1cclxuXHRvLmlubmVySFRNTCA9IFwiXCJcclxuXHJcbnVwZGF0ZV9iYWNrZ3JvdW5kID0gKGV2KSAtPlxyXG5cdG4gPSB0b3VjaGVzLmxlbmd0aFxyXG5cdGJha2dydW5kID0gXCJsaWdodGJsdWVcIlxyXG5cdGlmIG49PTEgdGhlbiBiYWtncnVuZCA9IFwieWVsbG93XCJcclxuXHRpZiBuPT0yIHRoZW4gYmFrZ3J1bmQgPSBcInBpbmtcIlxyXG5cdGxvZ2dhIFwidXBkYXRlX2JhY2tncm91bmQgI3tiYWtncnVuZH1cIlxyXG5cclxuaGFuZGxlX3BpbmNoX3pvb20gPSAoZXYpIC0+XHJcblx0dHJ5XHJcblx0XHRsb2dnYSBcIi0tSFBaICN7dHBDYWNoZS5sZW5ndGh9ICN7dG91Y2hlcy5sZW5ndGh9XCJcclxuXHRcdGlmIHRvdWNoZXMubGVuZ3RoID09IDJcclxuXHRcdFx0IyBDaGVjayBpZiB0aGUgdHdvIHRhcmdldCB0b3VjaGVzIGFyZSB0aGUgc2FtZSBvbmVzIHRoYXQgc3RhcnRlZCB0aGUgMi10b3VjaFxyXG5cdFx0XHRpbmRleDAgPSAtMVxyXG5cdFx0XHRpbmRleDEgPSAtMVxyXG5cdFx0XHRmb3IgaSBpbiByYW5nZSB0cENhY2hlLmxlbmd0aFxyXG5cdFx0XHRcdGlmIHRwQ2FjaGVbaV0uaWQgPT0gdG91Y2hlc1swXS5pZCB0aGVuIGluZGV4MCA9IGlcclxuXHRcdFx0XHRpZiB0cENhY2hlW2ldLmlkID09IHRvdWNoZXNbMV0uaWQgdGhlbiBpbmRleDEgPSBpXHJcblx0XHRcdGxvZ2dhIFwiLS0tLWluZGV4ICN7aW5kZXgwfSAje2luZGV4MX1cIlxyXG5cdFx0XHRpZiBpbmRleDAgPj0wIGFuZCBpbmRleDEgPj0gMFxyXG5cdFx0XHRcdCMgQ2FsY3VsYXRlIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIHN0YXJ0IGFuZCBtb3ZlIGNvb3JkaW5hdGVzXHJcblx0XHRcdFx0ZGlmZjAgPSBpbnQgZGlzdCB0cENhY2hlW2luZGV4MF0ueCwgdHBDYWNoZVtpbmRleDBdLnksIHRvdWNoZXNbMF0ueCwgdG91Y2hlc1swXS55XHJcblx0XHRcdFx0ZGlmZjEgPSBpbnQgZGlzdCB0cENhY2hlW2luZGV4MV0ueCwgdHBDYWNoZVtpbmRleDFdLnksIHRvdWNoZXNbMV0ueCwgdG91Y2hlc1sxXS55XHJcblxyXG5cdFx0XHRcdCMgVGhpcyB0aHJlc2hvbGQgaXMgZGV2aWNlIGRlcGVuZGVudCBhcyB3ZWxsIGFzIGFwcGxpY2F0aW9uIHNwZWNpZmljXHJcblx0XHRcdFx0UElOQ0hfVEhSRVNISE9MRCA9IGV2LnRhcmdldC5jbGllbnRXaWR0aCAvIDEwXHJcblx0XHRcdFx0bG9nZ2EgXCItLS0tZGlmZiAje2RpZmYwfSAje2RpZmYxfSAje1BJTkNIX1RIUkVTSEhPTER9XCJcclxuXHRcdFx0XHRpZiBkaWZmMCA+PSBQSU5DSF9USFJFU0hIT0xEIGFuZCBkaWZmMSA+PSBQSU5DSF9USFJFU0hIT0xEIHRoZW4gYmFrZ3J1bmQgPSBcImdyZWVuXCJcclxuXHRcdFx0XHRsb2dnYSBcIi0tLS1iYWtncnVuZCAje2Jha2dydW5kfVwiXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHR0cENhY2hlID0gW11cclxuXHRjYXRjaCBlXHJcblx0XHRsb2dnYSBcImVycm9yIGluIEhQWiAje2V9XCJcclxuXHJcbnRvdWNoU3RhcnRlZCA9IChldikgLT5cclxuXHR0cnlcclxuXHRcdGxvZ2dhICd0b3VjaFN0YXJ0ZWQnLCB0cnVlXHJcblx0XHRldi5wcmV2ZW50RGVmYXVsdCgpXHJcblx0XHRpZiB0b3VjaGVzLmxlbmd0aCA9PSAyXHJcblx0XHRcdGZvciB0IGluIHRvdWNoZXNcclxuXHRcdFx0XHR0cENhY2hlLnB1c2ggdFxyXG5cdFx0dXBkYXRlX2JhY2tncm91bmQgZXZcclxuXHRjYXRjaCBlXHJcblx0XHRsb2dnYSBcImVycm9yIGluIFN0YXJ0ZWRcIlxyXG5cclxudG91Y2hNb3ZlZCA9IChldikgLT5cclxuXHR0cnlcclxuXHRcdGxvZ2dhICd0b3VjaE1vdmVkJ1xyXG5cdFx0ZXYucHJldmVudERlZmF1bHQoKVxyXG5cdFx0aWYgbm90IHRvdWNoZXMubGVuZ3RoID09IDIgdGhlbiB1cGRhdGVfYmFja2dyb3VuZCBldlxyXG5cdFx0ZXYudGFyZ2V0LnN0eWxlLm91dGxpbmUgPSBcImRhc2hlZFwiXHJcblx0XHRoYW5kbGVfcGluY2hfem9vbSBldlxyXG5cdGNhdGNoIFxyXG5cdFx0bG9nZ2EgXCJlcnJvciBpbiBNb3ZlZFwiXHJcblxyXG50b3VjaEVuZGVkID0gKGV2KSAtPlxyXG5cdHRyeVx0XHJcblx0XHRsb2dnYSAndG91Y2hFbmRlZCdcclxuXHRcdGV2LnByZXZlbnREZWZhdWx0KClcclxuXHRcdGlmIHRvdWNoZXMubGVuZ3RoID09IDBcclxuXHRcdFx0IyBSZXN0b3JlIGJhY2tncm91bmQgYW5kIG91dGxpbmUgdG8gb3JpZ2luYWwgdmFsdWVzXHJcblx0XHRcdGV2LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kID0gXCJ3aGl0ZVwiXHJcblx0XHRcdGV2LnRhcmdldC5zdHlsZS5vdXRsaW5lID0gXCIxcHggc29saWQgYmxhY2tcIlxyXG5cdGNhdGNoIGVcclxuXHRcdGxvZ2dhIFwiZXJyb3IgaW4gRW5kZWRcIlxyXG4iXX0=
//# sourceURL=c:\Lab\2020\015-ZoomPan\coffee\sketch2.coffee