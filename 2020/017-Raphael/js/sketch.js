// Generated by CoffeeScript 2.4.1
var Button, H, SQ2, VERSION, W, cx, cy, h, image, info, messages, move_drag, move_start, move_up, myRound, ox, oy, p, startup, stdText, w;

VERSION = 3;

p = null;

image = null;

SQ2 = Math.sqrt(2);

messages = [];

[W, H] = [
  innerWidth - 10,
  innerHeight - 10 // screen
];

[w, h] = [
  1639,
  986 // image
];

[cx, cy] = [0, 0];

[ox, oy] = [0, 0];

stdText = {
  font: '40px Arial',
  fill: '#888'
};

myRound = function(x, n = 0) {
  return Math.round(x * 10 ** n) / 10 ** n;
};

Button = class Button {
  constructor(x1, y1, prompt, click = function() {}) {
    this.x = x1;
    this.y = y1;
    this.prompt = prompt;
    this.click = click;
    this.circle = p.circle(this.x, this.y, 100).attr({
      fill: '#ff0',
      opacity: 0.5
    }).click(this.click);
    this.text = p.text(this.x, this.y, this.prompt).attr(stdText).click(this.click);
  }

};

move_start = function(x, y, event) {
  //event.preventDefault()
  ox = image.attrs.x;
  return oy = image.attrs.y;
};

move_drag = function(dx, dy, x, y, event) {
  //event.preventDefault()
  image.translate((dx - ox) / image._.sx, (dy - oy) / image._.sy);
  ox = dx;
  return oy = dy;
};

move_up = function(event) {
  //event.preventDefault()
  return info();
};

info = function() {
  var dx, dy, sx, sy;
  ({dx, dy, sx, sy} = image._);
  cx = (W / 2 - dx) / sx;
  cy = (H / 2 - dy) / sy;
  return messages[0].attr({
    text: `dx=${myRound(dx)}\ndy=${myRound(dy)}\nsx=${myRound(sx, 2)}\nsy=${myRound(sy, 2)}\ncx=${myRound(cx)}\ncy=${myRound(cy)}`
  });
};

startup = function() {
  var a, b;
  p = Raphael('canvasdiv', W, H);
  p.rect(0, 0, W, H).attr({
    fill: '#fff'
  });
  image = p.image("skarpnÃ¤ck.png", 0, 0, w, h);
  image.translate((W - w) / 2, (H - h) / 2);
  a = p.text(0.9 * W, 200, "").attr(stdText);
  b = p.text(0.9 * W, 500, `Ver:${VERSION}`).attr(stdText);
  messages = [a, b];
  image.drag(move_drag, move_start, move_up);
  info();
  p.circle(W / 2, H / 2, 20); // crossHair
  p.circle(W / 2, H / 2, 0.5); // crossHair
  new Button(100, 100, 'in', function() {
    return info(image.scale(SQ2, SQ2, cx, cy));
  });
  new Button(100, 300, 'out', function() {
    return info(image.scale(1 / SQ2, 1 / SQ2, cx, cy));
  });
  return new Button(100, 500, 'center', function() {
    return info(image.translate(cx - 990, cy - 216)); // 990,216 Kaninparken
  });
};


// document.getElementById("canvasdiv").addEventListener "wheel", (event) -> 
// 	if event.deltaY > 0 then image.scale 1.1,1.1,cx,cy
// 	else image.scale 1/1.1,1/1.1,cx,cy
// 	info()

// image.mousemove (e) -> 
// 	{dx,dy,sx,sy} = image._
// 	messages[1].attr {text: "x=#{myRound (e.x - dx)/sx}\ny=#{myRound (e.y - dy)/sy}"}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsTUFBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsT0FBQSxFQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLENBQUEsRUFBQSxLQUFBLEVBQUEsSUFBQSxFQUFBLFFBQUEsRUFBQSxTQUFBLEVBQUEsVUFBQSxFQUFBLE9BQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxDQUFBLEVBQUEsT0FBQSxFQUFBLE9BQUEsRUFBQTs7QUFBQSxPQUFBLEdBQVU7O0FBRVYsQ0FBQSxHQUFJOztBQUNKLEtBQUEsR0FBUTs7QUFFUixHQUFBLEdBQU0sSUFBSSxDQUFDLElBQUwsQ0FBVSxDQUFWOztBQUNOLFFBQUEsR0FBVzs7QUFFWCxDQUFDLENBQUQsRUFBRyxDQUFILENBQUEsR0FBUTtFQUFDLFVBQUEsR0FBVyxFQUFaO0VBQWUsV0FBQSxHQUFZLEVBQTNCOzs7QUFDUixDQUFDLENBQUQsRUFBRyxDQUFILENBQUEsR0FBUTtFQUFDLElBQUQ7RUFBTSxHQUFOOzs7QUFDUixDQUFDLEVBQUQsRUFBSSxFQUFKLENBQUEsR0FBVSxDQUFDLENBQUQsRUFBRyxDQUFIOztBQUNWLENBQUMsRUFBRCxFQUFJLEVBQUosQ0FBQSxHQUFVLENBQUMsQ0FBRCxFQUFHLENBQUg7O0FBRVYsT0FBQSxHQUFVO0VBQUMsSUFBQSxFQUFNLFlBQVA7RUFBcUIsSUFBQSxFQUFNO0FBQTNCOztBQUVWLE9BQUEsR0FBVSxRQUFBLENBQUMsQ0FBRCxFQUFHLElBQUUsQ0FBTCxDQUFBO1NBQVcsSUFBSSxDQUFDLEtBQUwsQ0FBVyxDQUFBLEdBQUUsRUFBQSxJQUFJLENBQWpCLENBQUEsR0FBb0IsRUFBQSxJQUFJO0FBQW5DOztBQUVKLFNBQU4sTUFBQSxPQUFBO0VBQ0MsV0FBYyxHQUFBLElBQUEs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QUFBLEdBQUUsR0FBZCxFQUFrQixDQUFBLEdBQUUsR0FBcEIsRUFBd0IsRUFBeEIsRUFBMkIsRUFBM0IsQ0FBTDtFQUFILENBQTdCO1NBQ0EsSUFBSSxNQUFKLENBQVcsR0FBWCxFQUFlLEdBQWYsRUFBbUIsUUFBbkIsRUFBNkIsUUFBQSxDQUFBLENBQUE7V0FBRyxJQUFBLENBQUssS0FBSyxDQUFDLFNBQU4sQ0FBZ0IsRUFBQSxHQUFHLEdBQW5CLEVBQXVCLEVBQUEsR0FBRyxHQUExQixDQUFMLEVBQUg7RUFBQSxDQUE3QjtBQW5CUzs7QUEvQ1YiLCJzb3VyY2VzQ29udGVudCI6WyJWRVJTSU9OID0gM1xyXG5cclxucCA9IG51bGwgXHJcbmltYWdlID0gbnVsbFxyXG5cclxuU1EyID0gTWF0aC5zcXJ0IDJcclxubWVzc2FnZXMgPSBbXVxyXG5cclxuW1csSF0gPSBbaW5uZXJXaWR0aC0xMCxpbm5lckhlaWdodC0xMF0gIyBzY3JlZW5cclxuW3csaF0gPSBbMTYzOSw5ODZdICMgaW1hZ2VcclxuW2N4LGN5XSA9IFswLDBdXHJcbltveCxveV0gPSBbMCwwXVxyXG5cclxuc3RkVGV4dCA9IHtmb250OiAnNDBweCBBcmlhbCcsIGZpbGw6ICcjODg4J31cclxuXHJcbm15Um91bmQgPSAoeCxuPTApIC0+IE1hdGgucm91bmQoeCoxMCoqbikvMTAqKm5cclxuXHJcbmNsYXNzIEJ1dHRvblx0XHJcblx0Y29uc3RydWN0b3IgOiAoQHgsIEB5LCBAcHJvbXB0LCBAY2xpY2sgPSAtPikgLT5cclxuXHRcdEBjaXJjbGUgPSBwLmNpcmNsZSBAeCxAeSwxMDBcclxuXHRcdFx0LmF0dHIge2ZpbGw6ICcjZmYwJywgb3BhY2l0eTogMC41fVxyXG5cdFx0XHQuY2xpY2sgQGNsaWNrXHJcblx0XHRAdGV4dCA9IHAudGV4dCBAeCxAeSxAcHJvbXB0XHJcblx0XHRcdC5hdHRyIHN0ZFRleHRcclxuXHRcdFx0LmNsaWNrIEBjbGlja1xyXG5cclxubW92ZV9zdGFydCA9ICh4LHksZXZlbnQpIC0+XHJcblx0I2V2ZW50LnByZXZlbnREZWZhdWx0KClcclxuXHRveCA9IGltYWdlLmF0dHJzLnhcclxuXHRveSA9IGltYWdlLmF0dHJzLnlcclxuXHJcbm1vdmVfZHJhZyA9IChkeCwgZHksIHgsIHksIGV2ZW50KSAtPlxyXG5cdCNldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0aW1hZ2UudHJhbnNsYXRlIChkeC1veCkgLyBpbWFnZS5fLnN4LCAoZHktb3kpIC8gaW1hZ2UuXy5zeVxyXG5cdG94ID0gZHhcclxuXHRveSA9IGR5IFxyXG5cclxubW92ZV91cCA9IChldmVudCkgLT5cclxuXHQjZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG5cdGluZm8oKVxyXG5cclxuaW5mbyA9IC0+XHJcblx0e2R4LGR5LHN4LHN5fSA9IGltYWdlLl9cclxuXHRjeCA9IChXLzItZHgpL3N4XHJcblx0Y3kgPSAoSC8yLWR5KS9zeVxyXG5cdG1lc3NhZ2VzWzBdLmF0dHIge3RleHQgOiBcImR4PSN7bXlSb3VuZCBkeH1cXG5keT0je215Um91bmQgZHl9XFxuc3g9I3tteVJvdW5kIHN4LDJ9XFxuc3k9I3tteVJvdW5kIHN5LDJ9XFxuY3g9I3tteVJvdW5kIGN4fVxcbmN5PSN7bXlSb3VuZCBjeX1cIn1cclxuXHJcbnN0YXJ0dXAgPSAtPlxyXG5cdHAgPSBSYXBoYWVsICdjYW52YXNkaXYnLCBXLCBIXHJcblx0cC5yZWN0IDAsIDAsIFcsIEhcclxuXHRcdC5hdHRyIHtmaWxsOiAnI2ZmZid9XHJcblxyXG5cdGltYWdlID0gcC5pbWFnZSBcInNrYXJwbsOkY2sucG5nXCIsIDAsMCwgdyxoXHJcblx0aW1hZ2UudHJhbnNsYXRlIChXLXcpLzIsIChILWgpLzJcclxuXHRhID0gcC50ZXh0KDAuOSpXLCAyMDAsIFwiXCIpLmF0dHIgc3RkVGV4dFxyXG5cdGIgPSBwLnRleHQoMC45KlcsIDUwMCwgXCJWZXI6I3tWRVJTSU9OfVwiKS5hdHRyIHN0ZFRleHRcclxuXHRtZXNzYWdlcyA9IFthLGJdXHJcblxyXG5cdGltYWdlLmRyYWcgbW92ZV9kcmFnLCBtb3ZlX3N0YXJ0LCBtb3ZlX3VwXHJcblx0aW5mbygpXHJcblxyXG5cdHAuY2lyY2xlIFcvMixILzIsMjAgIyBjcm9zc0hhaXJcclxuXHRwLmNpcmNsZSBXLzIsSC8yLDAuNSAjIGNyb3NzSGFpclxyXG5cclxuXHRuZXcgQnV0dG9uIDEwMCwxMDAsJ2luJywgICAgIC0+IGluZm8gaW1hZ2Uuc2NhbGUgU1EyLFNRMixjeCxjeVxyXG5cdG5ldyBCdXR0b24gMTAwLDMwMCwnb3V0JywgICAgLT4gaW5mbyBpbWFnZS5zY2FsZSAxL1NRMiwxL1NRMixjeCxjeVxyXG5cdG5ldyBCdXR0b24gMTAwLDUwMCwnY2VudGVyJywgLT4gaW5mbyBpbWFnZS50cmFuc2xhdGUgY3gtOTkwLGN5LTIxNiAjIDk5MCwyMTYgS2FuaW5wYXJrZW5cclxuXHJcblx0IyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhc2RpdlwiKS5hZGRFdmVudExpc3RlbmVyIFwid2hlZWxcIiwgKGV2ZW50KSAtPiBcclxuXHQjIFx0aWYgZXZlbnQuZGVsdGFZID4gMCB0aGVuIGltYWdlLnNjYWxlIDEuMSwxLjEsY3gsY3lcclxuXHQjIFx0ZWxzZSBpbWFnZS5zY2FsZSAxLzEuMSwxLzEuMSxjeCxjeVxyXG5cdCMgXHRpbmZvKClcclxuXHJcblx0IyBpbWFnZS5tb3VzZW1vdmUgKGUpIC0+IFxyXG5cdCMgXHR7ZHgsZHksc3gsc3l9ID0gaW1hZ2UuX1xyXG5cdCMgXHRtZXNzYWdlc1sxXS5hdHRyIHt0ZXh0OiBcIng9I3tteVJvdW5kIChlLnggLSBkeCkvc3h9XFxueT0je215Um91bmQgKGUueSAtIGR5KS9zeX1cIn1cclxuIl19
//# sourceURL=c:\Lab\2020\017-Raphael\coffee\sketch.coffee