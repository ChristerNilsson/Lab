{
  "version": 3,
  "file": "montecarlo.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\montecarlo.coffee"
  ],
  "names": [],
  "mappings": ";;;;;;;AAAA,IAAA;;AAAA,AAAM;AAEL,AAAc,sBAAA;;;AAAC,AAAC,SAAA,OAAF;AAEd,AAAY;;;;;AACX,UADY,6EAAD,AAAU;;UACrB,KAAA,MAAA;AAAA,YAAM,AAAI,KAAJ,AAAK,QAAQ,SAAS,AAC5B;aAAM,AAAI,KAAJ,AAAK,QAAX,AAAmB;AAClB,eAAO,AAAC,KAAD,AAAC;AACR,YAAG,SAAH,AAAW,MAAU;AAArB;;AACA,iBAAS,AAAI,KAAC,AAAK,MAAV,AAAW;AACpB,YAAG,WAAH,AAAa;AACZ,iBAAO,AAAC,KAAD,AAAC,OAAD,AAAQ;AACf,mBAAS,AAAC,KAAD,AAAC,SAFX,AAEU,AAAU;;AACpB,AAAC,aAAD,AAAC,cAAD,AAAe,MAPhB,AAOC,AAAqB;AATX;AAWZ,AAAW;;;6BAAA,AAAC,MACX;UAAA,UAAA,UAAA,WAAA,GAAA,KAAA,KAAA,MAAA;AAAA,iBAAW,AAAI,KAAJ,AAAK;AAChB,iBAAW;AACX,YAAM,CAAC;AACP,WAAA,uCAAA;;AACC,oBAAY,AAAI,KAAC,AAAS,SAA1B,AAA0B;;AAG1B,gBAAQ,AAAS,UAAC;AAElB,YAAG,QAAH,AAAW;AACV,qBAAW;AACX,gBAFD,AAEO;AARR;;aAJU,AAaV;AAED,AAAS;;;6BAAA;AACR;UAAA,UAAA,MAAA,OAAA,MAAA;AAAA,aAAO,AAAC,KAAA,AACR;aAAM,AAAI,KAAV,AAAM,AAAK;AACV,gBAAQ,AAAI,KAAJ,AAAK;AACb;sBAA+C;;AAAA,eAAA,oCAAA;;yBAAtC,CAAC,AAAI,KAAC,AAAS,SAAA,AAAK,MAApB,AAAC,AAAoB,WAArB,AAAgC,AAAM;AAAA;;;AAC/C,YAAG,AAAK,MAAL,AAAM,WAAT,AAAiB,GAAO;iBAAxB,AAA+B;;AAC/B,qBAAW,AAAE,IAAF,AAAM,OAAO,UAAA,AAAC;iBAAS,AAAK,KAAf,AAAe;AAA5B,AAAgC,SAAhC,AAAC,EAA+B;AAC3C,eAAO,AAAI,KAAC,AAAS,SALtB,AAKsB;;aAPd,AAQR;AAED,AAAS;;;2BAAA,AAAC;aAAS,AAAI,KAAJ,AAAK,OAAO,AAAC,EAAD,AAAE,OAAO,AAAI,KAAnC,AAAU,AAAY,AAAS,AAAK;AAE7C,AAAW;;;6BAAA,AAAC,MACX;UAAA,OAAA;AAAA,cAAQ,AAAI,KAAC;AACb,eAAS,AAAK,MAAL,AAAM,AACf;aAAM,WAAN,AAAgB;AACf,gBAAQ,AAAK,MAAL,AAAM,UAAU,AAAC,EAAD,AAAE,OAAO,AAAK,MAA9B,AAAgB,AAAS,AAAM;AACvC,iBAAS,AAAK,MAFf,AAEU,AAAM;;aALN,AAMV;AAED,AAAgB;;;kCAAA,AAAC,MAAD,AAAO,QACtB;UAAA;;aAAM,SAAN,AAAc;AACb,AAAI,aAAJ,AAAK;AACL,YAAG,AAAI,KAAC,AAAK,MAAV,AAAW,SAAS,CAAvB,AAAG,AAAqB;AAAY,AAAI,eAAxC,AAAoC,AAAK;;qBACzC,OAAO,AAAI,KAHZ,AAGa;AAHb;aADe;AAlDjB",
  "sourcesContent": [
    "class MonteCarlo\r\n\r\n\tconstructor : (@root) ->\r\n\r\n\trunSearch : (factor = 1) ->\r\n\t\tend = Date.now() + factor * thinkingTime \r\n\t\twhile Date.now() < end\r\n\t\t\tnode = @select()\r\n\t\t\tif node == null then return\r\n\t\t\twinner = node.board.winner()\r\n\t\t\tif winner == null\r\n\t\t\t\tnode = @expand node\r\n\t\t\t\twinner = @simulate node\r\n\t\t\t@backpropagate node, winner\r\n\r\n\tbestPlay : (node) ->\r\n\t\tallPlays = node.allPlays()\r\n\t\tbestPlay = null\r\n\t\tmax = -Infinity\r\n\t\tfor play in allPlays\r\n\t\t\tchildNode = node.children[play]\r\n\r\n\t\t\t#ratio = childNode.t / childNode.n\r\n\t\t\tratio = childNode.n\r\n\r\n\t\t\tif ratio > max\r\n\t\t\t\tbestPlay = play\r\n\t\t\t\tmax = ratio\r\n\t\tbestPlay\r\n\r\n\tselect : -> # väljer en nod ur trädet\r\n\t\tnode = @root\r\n\t\twhile node.isFullyExpanded()\r\n\t\t\tplays = node.allPlays()\r\n\t\t\tpairs = ([node.children[play].getUCB1(), play] for play in plays)\r\n\t\t\tif pairs.length==0 then return null \r\n\t\t\tbestPlay = _.max(pairs, (pair) -> pair[0])[1]\r\n\t\t\tnode = node.children[bestPlay]\r\n\t\tnode\r\n \r\n\texpand : (node) -> node.expand _.sample node.unexpandedPlays() \r\n\r\n\tsimulate : (node) ->\r\n\t\tboard = node.board\r\n\t\twinner = board.winner()\r\n\t\twhile winner == null\r\n\t\t\tboard = board.nextBoard _.sample board.legalPlays()\r\n\t\t\twinner = board.winner()\r\n\t\twinner\r\n\r\n\tbackpropagate : (node, winner) ->\r\n\t\twhile node != null\r\n\t\t\tnode.n++\r\n\t\t\tif node.board.isPlayer -winner then node.t++\r\n\t\t\tnode = node.parent\r\n\t\r\n# b = new Board()\r\n# n = new Node null,null,b\r\n# mc = new MonteCarlo n\r\n# mc.runSearch()\r\n# print mc\r\n# print mc.bestPlay mc.root\r\n"
  ]
}