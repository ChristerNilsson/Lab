{
  "version": 3,
  "file": "korg.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\korg.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "class Korg\r\n\tconstructor : ->\r\n\t\t@table = null\r\n\t\t@branch = []\r\n\t\t@items = []\r\n\t\t@targets = {}\r\n\r\n\trensa : -> @table.innerHTML = \"\"\r\n\tadd : (item) -> @items.push item\r\n\r\n\tupdateTotal : ->\r\n\t\t[count,total] = @total()\r\n\t\tsend.innerHTML = \"Send Order (#{count} meal#{if count==1 then '' else 's'}, #{total}kr)\"\t\r\n\r\n\tupdate0 : (b,item,delta) ->\r\n\t\titem[1] += delta\r\n\t\tb.value = item[1] \r\n\t\t@updateTotal()\r\n\r\n\tupdate1 : (b,items,source,dir,mapping,delta) ->\r\n\t\tdeltaValue = dir\r\n\t\tif delta and delta[source] then deltaValue = dir * delta[source]\r\n\t\ttarget = mapping[source]\r\n\t\tif items[target]-deltaValue >= 0 \r\n\t\t\titems[target] -= deltaValue\r\n\t\t\titems[source] += deltaValue\r\n\t\t\t@targets[target].innerHTML = items[target] \r\n\t\t\tb.value = items[source] \r\n\r\n\ttraverse : (items=@items, mapping=null, passive=null, delta=null, level=0, br=[]) ->\r\n\t\tif false == goDeeper @branch,br then return \r\n\t\tif level == 0\r\n\t\t\tfor item,i in items\r\n\t\t\t\t[id,antal,pris,title,children,mapping1,passive1,delta1] = item\r\n\t\t\t\t@addTitle0 item,id,pris,title,br.concat(i),antal,children\r\n\t\t\t\tif children then @traverse children,mapping1,passive1,delta1,level+1,br.concat(i)\r\n\t\telse if level==1\r\n\t\t\tfor key of items\r\n\t\t\t\t@addTitle1 items,key,klartext[key][1],br.concat(i),mapping,passive,delta\r\n\r\n\thandleRow : (b1,b05,b2,b3) ->\r\n\t\ttr = document.createElement \"tr\"\r\n\t\taddCell tr,b1,100\r\n\t\taddCell tr,b05,5 \r\n\t\taddCell tr,b2,5\r\n\t\taddCell tr,b3,5\r\n\t\t@table.appendChild tr\r\n\r\n\taddTitle0 : (item,id,pris,title,br,antal,children) ->\r\n\t\tb05 = document.createElement \"div\"\r\n\t\tb05.innerHTML = pris + \"kr\"  \r\n\t\tb05.style.textAlign = 'right'\r\n\r\n\t\tif children\r\n\t\t\tb1 = makeButton \"#{id}. #{title}\" \r\n\t\t\tb1.style.textAlign = 'left'\r\n\t\t\tb1.branch = br\r\n\t\t\tb1.onclick = => \r\n\t\t\t\t@branch = calcBranch @branch, b1.branch\r\n\t\t\t\tupdateTables()\r\n\r\n\t\telse\r\n\t\t\tb1 = document.createElement \"div\"\r\n\t\t\tb1.innerHTML = \"#{id}. #{title}\"  \r\n\t\t\tb1.style.cssText = \"font-size:100%; white-space:normal; width:100%;\"\r\n\r\n\t\tb2 = makeButton antal, GREEN,BLACK \r\n\t\tb2.onclick = => @update0 b2,item,+1\r\n\r\n\t\tb3 = makeButton \"-\", RED,BLACK\r\n\t\tb3.onclick = => if b2.value > 0 then @update0 b2,item,-1\r\n\r\n\t\t@handleRow b1,b05,b2,b3\r\n\r\n\taddTitle1 : (items,key,title,br,mapping,passive,delta) ->\r\n\t\t#if passive then passive = passive.split ' '\r\n\t\tantal = items[key]\r\n\t\tb05 = document.createElement \"div\"\r\n\t\tb1 = document.createElement \"div\"\r\n\t\tb1.innerHTML = title  \r\n\t\tb1.style.cssText = \"font-size:100%; white-space:normal; width:100%; text-align:right\"\r\n\r\n\t\tif passive \r\n\t\t\tif key in passive\r\n\t\t\t\tb2 = makeDiv antal\r\n\t\t\t\tb3 = makeDiv ''\r\n\t\t\t\t@targets[key] = b2\r\n\t\t\telse\r\n\t\t\t\tb2 = makeButton antal, GREEN,BLACK\r\n\t\t\t\tb3 = makeButton '-',RED,BLACK\r\n\t\telse\r\n\t\t\tb2 = makeDiv antal\r\n\t\t\tb3 = makeDiv ''\r\n\r\n\t\tb2.style.textAlign = \"center\"\r\n\r\n\t\tb2.onclick = => @update1 b2,items,key,+1,mapping,delta\r\n\t\tb3.onclick = => if b2.value>0 then @update1 b2,items,key,-1,mapping,delta\r\n\r\n\t\t@handleRow b1,b05,b2,b3\r\n\r\n\ttotal : ->\r\n\t\tres = 0\r\n\t\tcount = 0\r\n\t\tfor [id,antal,pris] in @items\r\n\t\t\tres += antal * pris\r\n\t\t\tif id not in nonMeals then count += antal\r\n\t\t[count,res] \r\n\r\n\tclear : -> \r\n\t\tnewitems = @items.filter (e) -> e[1] != 0\r\n\t\tif newitems.length == @items.length\r\n\t\t\t@items = [] # alla tas bort\r\n\t\telse\r\n\t\t\t@items = newitems # alla med antal==0 tas bort\r\n\r\n\tsend : ->\r\n\t\tt = 0 # kr\r\n\t\ts = '' # full text\r\n\t\tu = '' # compact\r\n\t\tfor [id,antal,pris,title,children] in @items\r\n\t\t\tif antal > 0\r\n\t\t\t\tsarr = []\r\n\t\t\t\tif children \r\n\t\t\t\t\tfor key of children\r\n\t\t\t\t\t\tsubantal = children[key]\r\n\t\t\t\t\t\tif subantal == 1\r\n\t\t\t\t\t\t\tsarr.push key\r\n\t\t\t\t\t\telse if subantal > 1\r\n\t\t\t\t\t\t\tsarr.push subantal + key\r\n\t\t\t\tif sarr.length > 0 then ss=' ('+sarr.join(' ')+')' else ss='' \r\n\t\t\t\tt += antal * pris\r\n\t\t\t\ts += (if antal>1 then antal + ' x ' else '') + id + \". \" + title + ss + CRLF\r\n\t\t\t\tu += (if antal>1 then antal + 'x' else '') + id + ss + CRLF\r\n\r\n\t\tif t == 0 then return \r\n\r\n\t\toutput = encodeURI \"mailto:#{MAIL}?&subject=Order till #{SHOP}&body=\" + s + CRLF + t + \" kr\"\r\n\t\tif output.length > 2000 \r\n\t\t\toutput = encodeURI \"mailto:#{MAIL}?&subject=Order till #{SHOP}&body=\" + u + CRLF + t + \" kr\"\r\n\t\twindow.open output,'_blank'\r\n"
  ]
}