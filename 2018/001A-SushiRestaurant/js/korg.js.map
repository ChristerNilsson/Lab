{
  "version": 3,
  "file": "korg.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\korg.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "class Korg\r\n\tconstructor : ->\r\n\t\t@table = null\r\n\t\t@branch = []\r\n\t\t@items = []\r\n\t\t@targets = {}\r\n\r\n\tadd : (item) -> @items.push item\r\n\r\n\tupdate0 : (b,item,delta) ->\r\n\t\titem[1] += delta\r\n\t\tb.value = if item[1]==0 then \"\" else item[1]\r\n\r\n\tupdate1 : (b,items,source,delta,mapping) ->\r\n\t\ttarget = mapping[source]\r\n\t\tif items[target]-delta >= 0 \r\n\t\t\titems[target] -= delta\r\n\t\t\titems[source] += delta\r\n\t\t\t@targets[target].innerHTML = if items[target]==0 then \"\" else items[target]\r\n\t\t\tb.value = if items[source]==0 then \"\" else items[source]\r\n\r\n\ttraverse : (mapping=null,items=@items,level=0, br=[]) ->\r\n\t\tif false == goDeeper @branch,br then return \r\n\t\tif level==0\r\n\t\t\tfor item,i in items\r\n\t\t\t\t[id,antal,pris,title,children,mapping1] = item\r\n\t\t\t\t@addTitle0 item,id,pris,title,-1,0,br.concat(i),antal\r\n\t\t\t\tif children then @traverse mapping1,children,level+1,br.concat(i)\r\n\t\telse if level==1\r\n\t\t\tfor key of items\r\n\t\t\t\tsubantal = items[key]\r\n\t\t\t\t@addTitle1 items,key,'',0,sushi[key][1],-1,1,br.concat(i),subantal,mapping\r\n\r\n\thandleRow : (b1,b2,b3,id='',pris='') ->\r\n\t\ttr = document.createElement \"tr\"\r\n\t\t#td0 = document.createElement \"td\"\r\n\t\ttd1 = document.createElement \"td\"\r\n\t\ttd2 = document.createElement \"td\"\r\n\t\ttd3 = document.createElement \"td\"\r\n\r\n\t\t#td0.style.cssText = \"width:5%\"\r\n\t\ttd1.style.cssText = \"width:100%\"\r\n\t\ttd2.style.cssText = \"width:5%\"\r\n\t\ttd3.style.cssText = \"width:5%\"\r\n\r\n\t\t@table.appendChild tr\r\n\t\t#tr.appendChild td0\r\n\t\ttr.appendChild td1\r\n\t\ttr.appendChild td2\r\n\t\ttr.appendChild td3\r\n\r\n\t\t#div = document.createElement \"div\"\r\n\t\t#div.style.cssText = \"font-size:70%\"\r\n\t\t#if id != '' then div.innerHTML = '<b>' + id + '</b><br>' + pris + ':-'\r\n\t\t#td0.appendChild div\r\n\t\ttd1.appendChild b1\r\n\t\ttd2.appendChild b2\r\n\t\ttd3.appendChild b3\r\n\r\n\taddTitle0 : (item,id,pris,title,count,level,br,antal) ->\r\n\t\tif count>0 then scount = \" (#{count})\" else scount =\"\"\r\n\t\tv = '........'.slice(0,4*level) + title + scount\r\n\t\tb1 = makeButton v\r\n\t\tb1.style.textAlign = 'left'\r\n\t\tb1.branch = br\r\n\t\tb1.onclick = => \r\n\t\t\t@branch = calcBranch @branch, b1.branch\r\n\t\t\tupdateTables()\r\n\r\n\t\tv = if antal==0 then \"\" else antal\r\n\t\tb2 = makeButton v, GREEN,BLACK \r\n\t\tb2.onclick = => @update0 b2,item,+1\r\n\r\n\t\tb3 = makeButton \"-\", RED,BLACK\r\n\t\tb3.onclick = => if b2.value>0 then @update0 b2,item,-1\r\n\r\n\t\t@handleRow b1,b2,b3\r\n\r\n\taddTitle1 : (items,key,id,pris,title,count,level,br,antal,mapping) ->\r\n\t\tb1 = document.createElement \"div\"\r\n\t\tb1.innerHTML = title  \r\n\t\tb1.style.cssText = \"font-size:100%; white-space:normal; width:100%; text-align:right\"\r\n\r\n\t\tv = if antal==0 then \"\" else antal\r\n\t\tif mapping and key of mapping\r\n\t\t\tb2 = makeButton v,  GREEN,BLACK\r\n\t\t\tb3 = makeButton '-',RED,BLACK\r\n\t\telse\r\n\t\t\tb2 = makeDiv v\r\n\t\t\tb3 = makeDiv ''\r\n\t\t\t@targets[key] = b2\r\n\r\n\t\tb2.onclick = => if mapping then @update1 b2,items,key,+1,mapping\r\n\t\tb3.onclick = => if mapping and b2.value>0 then @update1 b2,items,key,-1,mapping\r\n\r\n\t\t@handleRow b1,b2,b3,id,pris\r\n\r\n\trensa : -> @items = []\r\n\r\n\tsend : ->\r\n\t\tt = 0 # kr\r\n\t\ts = '' # full text\r\n\t\tu = '' # compact\r\n\t\tfor [id,antal,pris,title,children] in @items\r\n\t\t\tif antal > 0\r\n\t\t\t\tss =''\r\n\t\t\t\tif children \r\n\t\t\t\t\tfor key of children\r\n\t\t\t\t\t\tsubantal = children[key]\r\n\t\t\t\t\t\tif subantal == 1\r\n\t\t\t\t\t\t\tss += ' ' + key\r\n\t\t\t\t\t\telse if subantal > 1\r\n\t\t\t\t\t\t\tss += ' ' + subantal + key\r\n\t\t\t\ts += antal + ' x ' + id + \". \" + title + ss + CRLF\r\n\t\t\t\tt += antal * pris\r\n\t\t\t\tif antal == 1 \r\n\t\t\t\t\tu += id + ss + CRLF\r\n\t\t\t\telse\r\n\t\t\t\t\tu += antal + 'x' + id + ss + CRLF\r\n\r\n\t\tif t==0 then return \r\n\r\n\t\tconsole.log t\r\n\t\tconsole.log s\r\n\t\tconsole.log u\r\n\t\toutput = encodeURI \"mailto:#{MAIL}?&subject=Order till #{SHOP}&body=\" + s + CRLF + t + \" kr\"\r\n\t\tif output.length > 2000 \r\n\t\t\toutput = encodeURI \"mailto:#{MAIL}?&subject=Order till #{SHOP}&body=\" + u + CRLF + t + \" kr\"\r\n\t\tconsole.log output.length\r\n\t\tconsole.log output \r\n\t\twindow.open output,'_blank'\r\n"
  ]
}