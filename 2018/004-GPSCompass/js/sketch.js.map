{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "places = []\r\nplaces.push {name:'Bron S Söderbysjön',lat:59.279155, lng:18.149318}\r\nplaces.push {name:'Golfklubben',       lat:59.284052, lng:18.145925}\r\nplaces.push {name:'Sushi Bagarmossen', lat:59.277560, lng:18.132739}\r\nplaces.push {name:'Hem',               lat:59.265205, lng:18.132735}\r\nplaces.push {name:'Hellasgården',      lat:59.289813, lng:18.160577}\r\nplaces.push {name:'Ulvsjön, Udden',    lat:59.277103, lng:18.164897}\r\nplaceIndex = 0\r\nplace = places[placeIndex]\r\n\r\ntrack = []\r\nbearing = 0\r\nheading_12 = 0\r\nlastObservation = 0\r\n\r\ntexts = ['','','','','','','','','','','','']\r\n\r\nlocationUpdate = (position) ->\r\n\tp1 = \r\n\t\tlat : position.coords.latitude\r\n\t\tlng : position.coords.longitude\r\n\t\taccuracy : position.coords.accuracy\r\n\t\ttimestamp : position.timestamp/1000\r\n\r\n\ttrack.push p1\r\n\r\n\theading_12 = calcHeading p1,place\r\n\tlastObservation = millis()\r\n\r\n\ttexts[0] = precisionRound place.lat,6\r\n\ttexts[1] = precisionRound place.lng,6\r\n\ttexts[3] = \"#{track.length}\"  \r\n\ttexts[6] = \"#{Math.round p1.accuracy} m\"\r\n\ttexts[8] = \"#{Math.round heading_12}°\"\r\n\t#texts[3] = 'nospeed' #p1.spd\r\n\t#texts[4] = p1.timestamp\r\n\ttexts[10] = \"#{Math.round distance_on_geoid p1,place} m\"\r\n\r\n\tif track.length >= 2 \r\n\t\tp0 = track[track.length-2]\r\n\t\tdt = p1.timestamp-p0.timestamp\r\n\t\tds = distance_on_geoid p0,p1\r\n\t\ttexts[2] = \"#{precisionRound dt,3} s\"\r\n\t\ttexts[4] = \"#{Math.round ds} m\"\r\n\t\ttexts[5] = \"#{precisionRound ds/dt,1} m/s\"\r\n\t\ttexts[9] = \"#{Math.round calcHeading p0,p1}°\"\r\n\r\nlocationUpdateFail = (error) ->\r\n\ttexts[0] = \"n/a\"\r\n\ttexts[1] = \"n/a\"\r\n\r\nnavigator.geolocation.watchPosition locationUpdate, locationUpdateFail, \r\n\tenableHighAccuracy: true\r\n\tmaximumAge: 30000\r\n\ttimeout: 27000\r\n\r\nwindow.addEventListener \"deviceorientation\", (event) ->\r\n\tbearing = event.alpha\r\n\r\n\tif typeof event.webkitCompassHeading != \"undefined\"\r\n\t\tbearing = event.webkitCompassHeading # iOS non-standard\r\n\r\n\ttexts[7] = \"#{Math.round (millis() - lastObservation)/1000} s\"\r\n\ttexts[9] = \"#{Math.round bearing}°\"\r\n\ttexts[11] = \"#{Math.round bearing - heading_12}°\"\r\n\r\nsetFillColor = (delta) ->\r\n\tif delta<-180 then delta += 180\r\n\tif delta>180 then delta -= 180\r\n\tif delta < 0 \r\n\t\tr = map delta,0,-180,1,0\r\n\t\tfc 1,r,r\r\n\telse\r\n\t\tg = map delta,0,180,1,0\r\n\t\tfc g,1,g\r\n\r\nsetup = ->\r\n\tcreateCanvas windowWidth,windowHeight\r\n\r\ndrawCompass = ->\r\n\tw = windowWidth\r\n\th = windowHeight\r\n\tradius = 0.8 * w / 2\r\n\tsetFillColor heading_12 - bearing\r\n\tsw 5\r\n\tsc 1\r\n\tcircle w/2,h/2,radius\r\n\tpush()\r\n\ttranslate w/2,h/2\r\n\tsc 1\r\n\tline 0,0,0,-radius\r\n\ttry\r\n\t\trd heading_12 - bearing\r\n\t\tsc 0 \r\n\t\tline 0,0,0,-radius\r\n\tpop()\r\n\r\ndraw = ->\r\n\tbg 0\r\n\tdrawCompass()\r\n\tfc 0.5\r\n\td = windowHeight/6\r\n\tsc 0.5\r\n\tsw 1\r\n\ttextSize 0.08*windowHeight\r\n\tfor t,i in texts\r\n\t\tx = i%2 * windowWidth\r\n\t\tif i%2==0 then textAlign LEFT else textAlign RIGHT\r\n\t\ty = d*Math.floor i/2\r\n\t\ttext t,x,d+y\r\n\ttextAlign CENTER\r\n\ttext place.name,windowWidth/2,d/2\r\n\r\nmousePressed = ->\r\n\tif mouseY > windowHeight/2 and track.length>0\r\n\t\tp = track[track.length-1]\r\n\t\tplaces.push {name:places.length, lat:p.lat, lng:p.lng}\r\n\t\tplaceIndex = places.length-1\r\n\r\n\telse if mouseX> windowWidth/2 then placeIndex++\r\n\telse placeIndex--\r\n\tplaceIndex %%= places.length\r\n\tplace = places[placeIndex]\r\n\ttexts = ['','','','','','','','','','','','']\r\n\ttexts[0] = precisionRound place.lat,6\r\n\ttexts[1] = precisionRound place.lng,6"
  ]
}