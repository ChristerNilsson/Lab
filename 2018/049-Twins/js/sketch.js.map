{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "SIZE = 12\r\nTILE = 60\r\nFREE = -1\r\nCOLORS = '#fff #f00 #0f0 #ff0 #f0f #0ff #800 #080'.split ' '\r\nKEY = '049-Twins'\r\n\r\nsize = null\r\nlevel = null\r\nmaxLevel=null\r\nnumbers = null\r\n\r\nb = null\r\nselected = []\r\nmessage = ''\r\nbuttons = []\r\npath = []\r\npathTimestamp = null\r\ndeathTimestamp = null\r\nhearts = null\r\nmilliseconds0 = null\r\nmilliseconds1 = null\r\nstate = 'halted' # 'running' 'halted'\r\ndelta = 0\r\nfound = null\r\nlittera = 0 # 0=off 1=on\r\n\r\nclass Hearts\r\n\tconstructor : (@x,@y,@count=9,@maximum=9) -> \r\n\r\n\tdraw : ->\r\n\t\tfor i in range @maximum\r\n\t\t\tx = @x + 60*i\r\n\t\t\tif i < @count\r\n\t\t\t\t@drawHeart x,@y,10,1,0,0\r\n\t\t\telse\r\n\t\t\t\t@drawHeart x,@y,10,0.5,0.5,0.5\r\n\r\n\tdrawHeart : (x,y,n,r,g,b) ->\r\n\t\t\tfc r,g,b\r\n\t\t\tsc r,g,b\r\n\t\t\tsw n\r\n\t\t\tdx = 1.2*n\r\n\t\t\ty -= 0.8*n\r\n\t\t\ty1 = y+0.6*n\r\n\t\t\ty2 = y+2.2*n\r\n\t\t\tline x-dx,y1, x,y2\r\n\t\t\tline x+dx,y1, x,y2\r\n\t\t\tline x,y+0.5*n,x,y+2*n\r\n\t\t\tsc()\r\n\t\t\tcircle x-n,y,n\r\n\t\t\tcircle x+n,y,n\r\n\r\nclass Button\r\n\tconstructor : (@x,@y,@txt,@click) -> @r=24\r\n\tinside : (x,y) -> @r > dist @x,@y,x,y\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\tif level == maxLevel then sc 1 else sc()\r\n\t\tsw 2\r\n\t\tcircle @x,@y,@r\r\n\t\tfc 0\r\n\t\ttextSize 30\r\n\t\tsc()\r\n\t\ttext @txt,@x,@y\r\n\r\nnewGame = (n) ->\r\n\tif n in [1,maxLevel+1] then return \r\n\tlevel = constrain n,2,maxLevel\r\n\tmakeGame()\r\n\r\nsaveStorage = -> localStorage[KEY] = maxLevel\r\nloadStorage = -> maxLevel = if KEY of localStorage then parseInt localStorage[KEY]\telse maxLevel = 2\r\n\r\nsetup = ->\r\n\tcanvas = createCanvas 30+TILE*SIZE+30,50+TILE*SIZE+TILE\r\n\tcanvas.position 0,0 # hides text field used for clipboard copy.\r\n\r\n\trectMode CENTER\r\n\tloadStorage()\r\n\tlevel = maxLevel\r\n\tbuttons.push new Button 60,40,'-', -> newGame level-1\r\n\tbuttons.push new Button 120,40,level, -> littera = (littera+1) % 2\r\n\tbuttons.push new Button 180,40,'+', -> newGame level+1\r\n\thearts = new Hearts 240,35\r\n\r\n\tif -1 != window.location.href.indexOf 'level'\r\n\t\turlGame()\r\n\telse\r\n\t\tmakeGame()\r\n\r\nurlGame = ->\r\n\tparams = getParameters()\r\n\tlevel = parseInt params.level\r\n\tb = JSON.parse params.b\r\n\tsize = 5+level//4 \r\n\tif size>12 then size=12\r\n\thearts.count = size - 3\r\n\thearts.maximum = size - 3\r\n\tnumbers = (size-2)*(size-2)\r\n\tif numbers%2==1 then numbers -= 1\r\n\tmilliseconds0 = millis()\r\n\tstate = 'running'\t\r\n\r\nmakeGame = ->\r\n\tlevel += delta\r\n\tmaxLevel += delta\r\n\tdelta = 0\r\n\tsaveStorage()\r\n\r\n\tsize = 5+level//4 \r\n\tif size>12 then size=12\r\n\thearts.count = size - 3\r\n\thearts.maximum = size - 3\r\n\r\n\tnumbers = (size-2)*(size-2)\r\n\tif numbers%2==1 then numbers -= 1\r\n\r\n\tcandidates = []\r\n\tfor i in range numbers/2\r\n\t\tcandidates.push i % level\r\n\t\tcandidates.push level-1 - i % level\r\n\tcandidates = _.shuffle candidates\r\n\r\n\tb = new Array size\r\n\tfor i in range size\r\n\t\tb[i] = new Array size\r\n\t\tfor j in range size\r\n\t\t\tif i in [0,size-1] or j in [0,size-1] then b[i][j] = FREE\r\n\t\t\telse \r\n\t\t\t\tif size % 2 == 0\r\n\t\t\t\t\tb[i][j] = candidates.pop()\r\n\t\t\t\telse\r\n\t\t\t\t\tif i == size//2 and j == size//2\r\n\t\t\t\t\t\tb[i][j] = FREE\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tb[i][j] = candidates.pop()\r\n\tmilliseconds0 = millis()\r\n\tstate = 'running'\r\n\tlink = makeLink()\r\n\tcopyToClipboard link\r\n\tprint link \r\n\r\nmakeLink = -> \r\n\turl = 'https://christernilsson.github.io/Lab/2018/049-Twins/index.html'\r\n\t#url = 'file:///C:/Lab/2018/049-Twins/index.html'\r\n\turl += '?b=' + JSON.stringify b\r\n\turl += '&level=' + level\r\n\turl\r\n\r\ndraw = ->\r\n\tbg 0.25\r\n\tsw 1\r\n\tbuttons[1].txt = level-1\r\n\r\n\tfor button in buttons\r\n\t\tbutton.draw()\r\n\thearts.draw()\r\n\r\n\ttextSize 0.8 * TILE\r\n\ttranslate TILE,TILE+50\r\n\ttextAlign CENTER,CENTER\r\n\tfc 1\r\n\tsc 0\r\n\tfor i in range size\r\n\t\tfor j in range size\r\n\t\t\tfc 0\r\n\t\t\tsc 1\r\n\t\t\tsw 1\r\n\t\t\trect TILE*i,TILE*j,TILE,TILE\r\n\t\t\tcell = b[i][j]\r\n\t\t\tif cell >= 0 \r\n\t\t\t\tsw 3\r\n\t\t\t\tfill   COLORS[cell%%COLORS.length]\r\n\t\t\t\tstroke COLORS[cell//COLORS.length]\r\n\t\t\t\ttext b[i][j],TILE*i,TILE*j\r\n\t\t\tif i in [0,size-1] or j in [0,size-1] then drawLittera i,j\r\n\tfor [i,j] in selected\r\n\t\tfc 1,1,0,0.5\r\n\t\tsc()\r\n\t\tcircle TILE*i,TILE*j,TILE/2-3\r\n\tdrawPath()\r\n\tif state=='halted'\r\n\t\tfc 1,1,0,0.5\r\n\t\tx = (size-1)*TILE/2\r\n\t\ty = (size-1)*TILE/2\r\n\t\tw = size*TILE\r\n\t\th = size*TILE\r\n\t\trect x,y,w,h\r\n\t\tms = round(milliseconds1-milliseconds0)/1000\r\n\t\tif ms > 0\r\n\t\t\ty = size*TILE-10\r\n\t\t\tfc 1\r\n\t\t\tsc()\r\n\t\t\ttextSize 20\r\n\t\t\ttext ms,x,y\r\n\tif millis() < deathTimestamp\r\n\t\tx = size//2*TILE\r\n\t\ty = size//2*TILE\r\n\t\tif size % 2 == 0 then [x,y] = [x-TILE/2, y-TILE/2]\r\n\t\thearts.drawHeart x,y,size*TILE/5,1,0,0\r\n\r\ndrawLittera = (i,j) ->\r\n\tif littera==0 then return \r\n\tpush()\r\n\ttextSize 32\r\n\tfc 0.5\r\n\tsc()\r\n\tif j in [0,size-1] and i < size-1\r\n\t\ttext ' abcdefghik '[i],TILE*i,TILE*j\r\n\telse if i in [0,size-1] and 0<j<size-1\r\n\t\ttext size-1-j,TILE*i,TILE*j\r\n\tpop()\r\n\r\nwithin = (i,j) -> 0 <= i < size and 0 <= j < size\r\n\r\nmousePressed = ->\r\n\tif state=='halted' \r\n\t\tnewGame level\r\n\t\treturn\r\n\tfor button in buttons\r\n\t\tif button.inside mouseX,mouseY then button.click()\r\n\t[i,j] = [(mouseX-TILE/2)//TILE,(mouseY-50-TILE/2)//TILE]\r\n\tif not within i,j then return\r\n\tif selected.length == 0\r\n\t\tif b[i][j] != FREE then selected.push [i,j]\r\n\telse\r\n\t\t[i1,j1] = selected[0]\r\n\t\tif i==i1 and j==j1 then return selected.pop()\r\n\t\tif b[i][j] + b[i1][j1] != level-1\r\n\t\t\thearts.count -= 1 # Punish one, wrong sum\r\n\t\t\tdeathTimestamp = 200 + millis()\r\n\t\t\tselected.pop()\r\n\t\telse\r\n\t\t\tpath = legal false,i1,j1,i,j\r\n\t\t\tif path.length == 0\r\n\t\t\t\tpath = legal true,i1,j1,i,j\r\n\t\t\t\tif path.length == 0\r\n\t\t\t\t\thearts.count -= 2 # Punish two, anything goes\r\n\t\t\t\telse\r\n\t\t\t\t\thearts.count -= 1 # Punish one, wrap\r\n\t\t\t\tdeathTimestamp = 200 + millis()\r\n\t\t\tb[i][j] = b[i1][j1] = FREE\r\n\t\t\tnumbers -= 2\r\n\t\t\tselected.pop()\r\n\t\t\tif numbers==0\r\n\t\t\t\tmilliseconds1 = millis()\r\n\t\t\t\tstate = 'halted'\r\n\t\t\t\t#if level == maxLevel \r\n\t\t\t\tif hearts.count >= 0 then delta = 1 else delta = -1\r\n\t\t\telse\r\n\t\t\t\tif level == maxLevel \r\n\t\t\t\t\tif hearts.count < 0 \r\n\t\t\t\t\t\tstate = 'halted'\r\n\t\t\t\t\t\tdelta = -1\r\n\r\n\r\nmakeMove = (wrap,x,y) -> if wrap then [x %% size, y %% size] else [x,y]\r\n\r\nmakePath = (wrap,reached,i,j) ->\r\n\tres = []\r\n\tkey = \"#{i},#{j}\"\r\n\t[turns0,i0,j0,indexes0] = reached[key]\r\n\t[i,j] = [i0,j0]\r\n\tres.push [i,j]\r\n\tpathTimestamp = millis()\r\n\tindexes0.reverse()\r\n\tfor index in indexes0\r\n\t\t[di,dj] = [[1,0],[-1,0],[0,1],[0,-1]][index]\r\n\t\t[i,j] = makeMove wrap,i+di,j+dj\r\n\t\tres.push [i,j]\r\n\tres\r\n\r\ndrawPath = ->\r\n\tif path.length == 0 then return \r\n\tsw 3\r\n\tsc 1,1,0\r\n\t[i1,j1] = path[0]\r\n\tfor [i2,j2] in path\r\n\t\tif 1 == dist i1,j1,i2,j2\r\n\t\t\tline TILE*i1,TILE*j1,TILE*i2,TILE*j2\r\n\t\t[i1,j1] = [i2,j2]\r\n\tif millis() > 500 + pathTimestamp then path = []\r\n\r\n# A*\r\nlegal = (wrap,i0,j0,i1,j1) ->\r\n\tstart = [0,i0,j0,[]] # turns,x,y,move\r\n\tcands = []\r\n\tcands.push start\r\n\treached = {}\r\n\treached[[i0,j0]] = start\r\n\twhile cands.length > 0\r\n\t\tfront = cands\r\n\t\tfront.sort (a,b) -> a[0]-b[0]\r\n\t\tcands = []\r\n\t\tfor [turns0,x0,y0,indexes0] in front\r\n\t\t\tfor [dx,dy],index in [[-1,0],[1,0],[0,-1],[0,1]]\r\n\t\t\t\t[x,y] = makeMove wrap,x0+dx,y0+dy\r\n\t\t\t\tkey = \"#{x},#{y}\"\r\n\t\t\t\tturns = turns0\r\n\t\t\t\tif indexes0.length > 0 and index != _.last(indexes0) then turns++\r\n\t\t\t\tnext = [turns,x,y,indexes0.concat [index]]\r\n\t\t\t\tif x==i1 and y==j1 and turns<=2\r\n\t\t\t\t\treached[key] = next\r\n\t\t\t\t\treturn makePath wrap,reached,i1,j1\r\n\t\t\t\tif within x,y\r\n\t\t\t\t\tif b[x][y]==FREE\r\n\t\t\t\t\t\tif key not of reached or reached[key][0] >= next[0]\r\n\t\t\t\t\t\t\tif next[0] < 3\r\n\t\t\t\t\t\t\t\treached[key] = next\r\n\t\t\t\t\t\t\t\tcands.push next\r\n\t[]\r\n\r\ncopyToClipboard = (txt) ->\r\n\tcopyText = document.getElementById \"myClipboard\"\r\n\tcopyText.value = txt \r\n\tcopyText.select()\r\n\tdocument.execCommand \"copy\"\r\n"
  ]
}