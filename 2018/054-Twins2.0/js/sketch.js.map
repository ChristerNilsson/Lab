{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# fungerar för nämnare <= 10\r\n\r\nb = null\r\nlevel = 0\r\nSize = null\r\n\r\nselected = null # innehåller [i,j]\r\nmsg = null  # innehåller [i,j]\r\n\r\nmsg2 = null # innehåller [n,d]\r\nmode = 4\r\nsums = []\r\n\r\nf = (n,a,b,base=10) -> g n,(a/b).toString base\r\ng = (n,s) ->\r\n\tif s.length < n then return [s,'']\r\n\ts = s.slice 0,s.length-1\r\n\tif '.' not in s then return [s,'']  \r\n\t[integer,mantissa] = s.split '.'\r\n\tres = integer + '.'\r\n\r\n\tfor i in range s.length\r\n\t\tp = pattern mantissa.slice i\r\n\t\tif p.length>0 then return [res+mantissa.slice(0,i), p]\r\n\t[res,mantissa]\r\n\r\ngcd = (x, y) -> if y == 0 then x else gcd y, x % y\r\n\r\npattern = (s) ->\r\n\tfor antal in range 1,13\r\n\t\tok = true\r\n\t\tp = s.slice 0,antal\r\n\t\tif 2*antal > s.length then ok = false \r\n\t\tfor j in range s.length // antal\r\n\t\t\tq = s.slice j*antal,(j+1)*antal \r\n\t\t\tif p != q then ok = false\r\n\t\tif ok then return p\r\n\t''\r\n\r\nmakeGame = (delta=0) ->\r\n\tlevel += delta\r\n\tlevel = constrain level,0,7\r\n\tmode = [0,0,1,1,2,2,3,4][level]\r\n\r\n\tSize = 3+level \r\n\r\n\tcandidates = []\r\n\tb = new Array Size\r\n\tfor i in range Size\r\n\t\tb[i] = new Array Size\r\n\t\tfor j in range Size\r\n\t\t\tif i==j\r\n\t\t\t\tb[i][j] = null\r\n\t\t\telse\r\n\t\t\t\tb[i][j] = [i+1,j+1]\r\n\t\t\t\tcandidates.push [i+1,j+1]\r\n\r\n\tfor c1,i in candidates\r\n\t\t[n1,d1] = c1\r\n\t\tfor c2,j in candidates\r\n\t\t\t[n2,d2] = c2\r\n\t\t\tif i>j \r\n\t\t\t\td = d1*d2\r\n\t\t\t\tn = n1*d2+n2*d1\r\n\t\t\t\te = gcd n,d\r\n\t\t\t\tn //= e\r\n\t\t\t\td //= e\r\n\t\t\t\t#print n1,d1,n2,d2,n,d\r\n\t\t\t\t#print \"#{n}/#{d}\" #f(13,n,d,10), f(50,n,d,2)\r\n\r\n\tcandidates = _.shuffle candidates\r\n\tsums = []\r\n\tfor i in range candidates.length//2\r\n\t\t[n1,d1] = candidates.pop()\r\n\t\t[n2,d2] = candidates.pop()\r\n\t\td = d1*d2\r\n\t\tn = n1*d2+n2*d1\r\n\t\te = gcd n,d\r\n\t\tn //= e\r\n\t\td //= e\r\n\t\tsums.push [n,d]\r\n\t\t#print n1,d1,n2,d2,n,d\r\n\t\t#print f 13,n,d,10\r\n\t\t#print f 50,n,d,2\r\n\r\n\t#milliseconds0 = millis()\r\n\t#state = 'running'\r\n\r\nfindSum = ->\r\n\tlst = []\r\n\tfor i in range Size\r\n\t\tfor j in range Size\r\n\t\t\tif b[i][j] then lst.push [i,j]\r\n\tif lst.length==0 \r\n\t\tmakeGame 1\r\n\t\tfor i in range Size\r\n\t\t\tfor j in range Size\r\n\t\t\t\tif b[i][j] then lst.push [i,j]\r\n\r\n\tindex1 = [-1,-1]\r\n\tindex2 = [-1,-1]\r\n\twhile index1[0]==index2[0] and index1[1]==index2[1]\t\t\r\n\t\tindex1 = _.sample lst\r\n\t\tindex2 = _.sample lst\r\n\t[n1,d1] = fetchCell index1\r\n\t[n2,d2] = fetchCell index2\r\n\td = d1*d2\r\n\tn = n1*d2+n2*d1\r\n\te = gcd n,d\r\n\tn //= e\r\n\td //= e\r\n\t[n,d]\r\n\r\ndisplay = (m,n,d,x,y) ->\r\n\tif m==0\r\n\t\tif d==1 then text \"#{n}\",x,y\r\n\t\telse text \"#{n}/#{d}\",x,y\r\n\tif m==1 then text \"DEC #{n/d}\",x,y\r\n\tif m==2 \r\n\t\t[s,t] = f 13,n,d,10\r\n\t\ttext \"DEC #{[s,t].join ''}\",x,y\r\n\t\tx0 = x+4+4*37+37*s.length\r\n\t\tif t != \"\" then line x0,y+2,x0+37*t.length,y+2\r\n\tif m==3 then\ttext \"BIN #{(n/d).toString(2)}\",20,y\r\n\tif m==4 \r\n\t\t[s,t] = f 50,n,d,2\r\n\t\ttext \"BIN #{[s,t].join ''}\",20,y\r\n\t\tx0 = x+4+4*37+37*s.length\r\n\t\tif t != \"\" then line x0,y+2,x0+37*t.length,y+2\r\n\r\nsetup = ->\r\n\tcreateCanvas 1900,800\r\n\trectMode CENTER\r\n\ttextAlign CENTER,CENTER\r\n\tmakeGame()\r\n\tmsg2 = findSum()\r\n\txdraw()\r\n\tprintHelp()\r\n\r\nxdraw = ->\r\n\tbg 0.5\r\n\ttextFont 'Courier'\r\n\tpush()\r\n\ttextSize 20\r\n\ttextAlign CENTER,CENTER\r\n\tsw 1\r\n\r\n\ttranslate 100,100\r\n\tfor i in range Size\r\n\t\tfor j in range Size\r\n\t\t\tsw 1\r\n\t\t\trect 40*i,40*j,40,40\r\n\t\t\tif b[j][i] \r\n\t\t\t\t[n,d] = b[j][i] \r\n\t\t\t\te = gcd n,d\r\n\t\t\t\tn //= e\r\n\t\t\t\td //= e\r\n\t\t\t\tif d==1 \r\n\t\t\t\t\ttext n,40*i,40*j\r\n\t\t\t\telse\r\n\t\t\t\t\ttext n,40*i,40*j-10+2\r\n\t\t\t\t\tsw 1\r\n\t\t\t\t\tline 40*i-10,40*j,40*i+10,40*j\r\n\t\t\t\t\ttext d,40*i,40*j+10+2\r\n\tpop()\r\n\r\n\ttextSize 64\r\n\ttextAlign LEFT,TOP\r\n\tsw 1\r\n\r\n\tif selected\r\n\t\t[j,i] = selected\r\n\t\tpush()\r\n\t\tfc 1,1,0,0.5\r\n\t\tcircle 100+40*i,100+40*j,19\r\n\t\tpop()\r\n\r\n\tif msg\r\n\t\t[n,d] = fetchCell msg\r\n\t\tif n != d then display mode,n,d,20,18\r\n\t[n,d] = msg2\r\n\tdisplay mode,n,d,20,480\r\n\t# display 1,n,d,20,540\r\n\t# display 2,n,d,20,600\r\n\t# display 3,n,d,20,660\r\n\t# display 4,n,d,20,720\r\n\r\nwithin = (i,j) -> 0 <= i < Size and 0 <= j < Size and i!=j\r\n\r\nfetchCell = (pair) -> b[pair[0]][pair[1]]\r\nclearCell = (pair) -> b[pair[0]][pair[1]] = null\r\n\r\nmousePressed = ->\r\n\tj = (mouseX-80)//40\r\n\ti = (mouseY-80)//40\t\r\n\tmsg = if within i,j then [i,j] else null\r\n\tif not selected # first selection\r\n\t\tselected = msg\r\n\telse if msg # second selection\r\n\t\t[n1,d1] = fetchCell selected\r\n\t\t[n2,d2] = fetchCell msg\r\n\t\td = d1*d2\r\n\t\tn = n1*d2+n2*d1\r\n\t\te = gcd n,d\r\n\t\tn //= e\r\n\t\td //= e\r\n\t\tif n==msg2[0] and d==msg2[1] # correct sum\r\n\t\t\tclearCell selected\r\n\t\t\tclearCell msg\r\n\t\t\tmsg2 = findSum()\r\n\t\tselected = null \r\n\t\tmsg = null\r\n\txdraw()\r\n\r\nbredd = (nr,digits) ->\r\n\ts = nr.toString()\r\n\t'      '.slice(0,digits-s.length) + s\r\n\r\nprintHelp = ->\r\n\tm = 2\r\n\tres = ''\r\n\tfor n in range 3,11\r\n\t\tdigits = [0,0,0,2,2,3,3,4,4,5,5][n]\r\n\t\tm *= n / gcd m,n\r\n\t\tres += \"n = #{n} ############ #{m}-delar\\n\"\r\n\t\tfor i in range 1,n+1\r\n\t\t\ts = ''\r\n\t\t\tfor j in range 1,n+1\r\n\t\t\t\tif i==j then s += \"      \".slice(0,digits) + 'x'\r\n\t\t\t\telse s += ' ' + bredd m*i/j, digits\r\n\t\t\tres += s+\"\\n\"\r\n\t\tres += \"\\n\"\r\n\tprint res \r\n"
  ]
}