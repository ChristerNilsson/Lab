{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "spara = (lat,lon, x,y) -> {lat,lon, x,y}\r\n\r\n# 2019-SommarN\r\nA = spara 59.300716, 18.125680, 197,278 # Lilla halvön\r\nB = spara 59.299235, 18.169492, 4306,367 # Kranglans väg/Östervägen\r\nC = spara 59.285443, 18.124585, 236,3082 # Ishockeyrink Mitten\r\nD = spara 59.287806, 18.170784, 4525,2454 # Mittenhus t v\r\n\r\nFILENAME = '2019-SommarN.jpg' \r\n\r\ncontrols = \r\n\t1: [1830,333]\r\n\t2: [1506,521]\r\n\t3: [907,711]\r\n\t4: [1193,873]\r\n\t5: [472,617]\r\n\t6: [228,841]\r\n\t7: [672,1013]\r\n\t8: [1125,1196]\r\n\t9: [1430,1290]\r\n\t10: [4361,503]\r\n\t11: [4118,1106]\r\n\t12: [3830,640]\r\n\t13: [3192,1133]\r\n\t14: [2664,873]\r\n\t15: [2322,1862]\r\n\t16: [4120,2699]\r\n\t17: [4181,3069]\r\n\t19: [3340,2904]\r\n\t20: [2691,2554]\r\n\t24: [3366,3217]\r\n\t26: [390,1935]\r\n\t27: [547,2143]\r\n\t28: [1462,2293]\r\n\t29: [1055,2620]\r\n\t30: [371,2502]\r\n\t31: [1090,3104]\r\n\t32: [2250,2750]\r\n\r\n# 2019-SommarS\r\n# A = spara 59.279157, 18.149313, 2599,676 # Mellanbron\r\n# B = spara 59.275129, 18.169590, 4531,1328 # Ulvsjön Vändplan Huset\r\n# C = spara 59.270072, 18.150229, 2763,2334 # Brotorpsbron\r\n# D = spara 59.267894, 18.167087, 4339,2645 # Älta huset\r\n\r\n# FILENAME = '2019-SommarS.jpg' \r\n\r\n# controls = \r\n# \t21: [4303,255]\r\n# \t22: [4066,407]\r\n# \t23: [3436,158]\r\n# \t25: [3534,485]\r\n# \t34: [1709,65]\r\n# \t35: [1212,151]\r\n# \t36: [2215,1008]\r\n# \t37: [2571,1186]\r\n# \t38: [2894,485]\r\n# \t39: [3245,778]\r\n# \t40: [4317,1003]\r\n# \t41: [4303,685]\r\n# \t42: [3868,1292]\r\n# \t43: [3426,1281]\r\n# \t44: [3536,1650]\r\n# \t45: [4538,1763]\r\n# \t46: [3926,2133]\r\n# \t47: [3104,2025]\r\n# \t48: [4256,2514]\r\n# \t49: [3773,2493]\r\n# \t50: [3231,2757]\r\n\r\n#################\r\n\r\nDATA = \"gpsKarta\"\r\nWIDTH = null\r\nHEIGHT = null\r\n[cx,cy] = [0,0] # center (image coordinates)\r\nSCALE = 1\r\n\r\ngps = null\r\nTRACKED = 5 # circles shows the player's position\r\nposition = null # gps position (pixels)\r\ntrack = [] # five latest GPS positions (pixels)\r\nbuttons = []\r\npoints = [] # remembers e.g. car/bike position\r\nimg = null \r\nheading = null\r\nmessages = []\r\nlastLatLon = null\r\ncurrLatLon = null\r\n\r\n[gpsLat,gpsLon] = [0,0]\r\ncurrentControl = \"1\"\r\n\r\npreload = -> img = loadImage FILENAME\r\n\r\nmyround = (x,dec=6) ->\r\n\tx *= 10**dec\r\n\tx = round x\r\n\tx/10**dec\r\n\r\nshow = (prompt,p) -> print prompt,\"http://maps.google.com/maps?q=#{p.lat},#{p.lon}\"\t\r\n\r\nvercal = (a,b,y) ->\r\n\tx = map y, a.y,b.y, a.x,b.x\r\n\tlat = map y, a.y,b.y, a.lat,b.lat\r\n\tlon = map y, a.y,b.y, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\nhortal = (a,b,x) ->\r\n\ty = map x, a.x,b.x, a.y,b.y\r\n\tlat = map x, a.x,b.x, a.lat,b.lat\r\n\tlon = map x, a.x,b.x, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\ncorner = (a,b,c,d,x,y)->\r\n\tlat = map y, c.y,d.y, c.lat,d.lat  \r\n\tlon = map x, a.x,b.x, a.lon,b.lon\r\n\t{lat,lon,x,y}\r\n\r\nmakeCorners = ->\r\n\r\n\tac0 = vercal A,C,0  \t                  # beräkna x\r\n\tac1 = vercal A,C,HEIGHT\r\n\tbd0 = vercal B,D,0\r\n\tbd1 = vercal B,D,HEIGHT\r\n\r\n\tab0 = hortal A,B,0                      # beräkna y\r\n\tab1 = hortal A,B,WIDTH\r\n\tcd0 = hortal C,D,0\r\n\tcd1 = hortal C,D,WIDTH\r\n\r\n\tnw = corner ac0,bd0,ab0,cd0, 0,    0\t\t# beräkna hörnen\r\n\tne = corner ac0,bd0,ab1,cd1, WIDTH,0\r\n\tse = corner ac1,bd1,ab1,cd1, WIDTH,HEIGHT\r\n\tsw = corner ac1,bd1,ab0,cd0, 0,    HEIGHT\r\n\r\n\tgps = new GPS nw,ne,se,sw,WIDTH,HEIGHT\r\n\r\nlocationUpdate = (p) ->\r\n\tgpsLat = p.coords.latitude\r\n\tgpsLon = p.coords.longitude\r\n\r\n\tcurrLatLon = LatLon gpsLat,gpsLon\r\n\tif lastLatLon == null then lastLatLon = currLatLon\r\n\tif lastLatLon.distanceTo(currLatLon) > 2\r\n\t\theading = lastLatLon.bearingTo currLatLon\r\n\t\tlastLatLon = currLatLon\r\n\r\n\tposition = gps.gps2bmp gpsLat,gpsLon\r\n\r\n\ttrack.push position\r\n\tif track.length > TRACKED then track.shift()\r\n\txdraw()\r\n\tposition\r\n\r\nlocationUpdateFail = (error) ->\tif error.code == error.PERMISSION_DENIED then messages = ['Check location permissions']\r\n\r\nstoreData = -> localStorage[DATA] = JSON.stringify points\t\r\nfetchData = -> if localStorage[DATA] then points = JSON.parse localStorage[DATA]\r\n\r\nsetup = ->\r\n\r\n\tcreateCanvas windowWidth,windowHeight\r\n\r\n\tWIDTH = img.width\r\n\tHEIGHT = img.height\r\n\r\n\tSCALE = 1 \r\n\t[cx,cy] = [width,height] \r\n\t\r\n\tfetchData()\r\n\r\n\tx = width/2\r\n\ty = height/2\r\n\tx1 = 100\r\n\tx2 = width-100\r\n\ty1 = 100\r\n\ty2 = height-100\r\n\r\n\tbuttons.push new Button 'S',x1,y1, -> \r\n\t\tpoints.push position\r\n\t\tstoreData()\r\n\r\n\tbuttons.push new Button 'U',x,y1, -> cy -= 0.25*height/SCALE\r\n\tbuttons.push new Button '0',x2,y1, -> \r\n\t\tif points.length > 0 \r\n\t\t\tpoints.pop()\r\n\t\t\tstoreData()\r\n\r\n\tbuttons.push new Button 'L',x1,y, -> cx -= 0.25*width/SCALE\r\n\tbuttons.push new Button ' ',x,y, ->\t[cx,cy] = position\r\n\tbuttons.push new Button 'R',x2,y, -> cx += 0.25*width/SCALE\r\n\tbuttons.push new Button '-',x1,y2, -> if SCALE > 0.5 then SCALE /= 1.2\r\n\tbuttons.push new Button 'D',x,y2, -> cy += 0.25*height/SCALE\r\n\tbuttons.push new Button '+',x2,y2, ->\tSCALE *= 1.2\r\n\r\n\tmakeCorners()\r\n\r\n\tposition = [WIDTH/2,HEIGHT/2]\r\n\r\n\tnavigator.geolocation.watchPosition locationUpdate, locationUpdateFail, \r\n\t\tenableHighAccuracy: true\r\n\t\tmaximumAge: 30000\r\n\t\ttimeout: 27000\r\n\r\n\txdraw()\r\n\r\n\taddEventListener 'touchstart', (evt) ->\r\n\t\ttouches = evt.changedTouches\r\n\t\ttouch = touches[touches.length-1]\r\n\t\tmx = touch.pageX\r\n\t\tmy = touch.pageY\r\n\t\tmyMousePressed mx,my\r\n\r\ndrawTrack = ->\r\n\tpush()\r\n\tfc()\r\n\tsw 4\r\n\tsc 0 # BLACK\r\n\ttranslate width/2, height/2\r\n\tscale SCALE\r\n\tfor [x,y],i in track\r\n\t\tcircle x-cx, y-cy, 10 * (track.length-i)\r\n\tpop()\r\n\r\ndrawPoints = ->\r\n\tpush()\r\n\tsc()\r\n\tfc 1,0,0,0.5 # RED\r\n\ttranslate width/2, height/2\r\n\tscale SCALE\r\n\tfor [x,y],i in points\r\n\t\tcircle x-cx, y-cy, 20\r\n\tpop()\r\n\r\ndrawControl = ->\r\n\tcontrol = controls[currentControl]\r\n\tx = control[0]\r\n\ty = control[1]\r\n\r\n\t[lat,lon] = gps.bmp2gps x,y\r\n\r\n\tlatLon2 = LatLon lat,lon\r\n\tlatLon1 = LatLon gpsLat,gpsLon\r\n\tdistance = latLon1.distanceTo latLon2\r\n\r\n\tbearing = latLon1.bearingTo latLon2\r\n\tbuttons[3].prompt = currentControl\r\n\tbuttons[4].prompt = int bearing\r\n\tbuttons[5].prompt = int distance\t\t\r\n\r\n\tif heading == null or isNaN heading\r\n\t\tbuttons[1].prompt = ''\r\n\t\tbuttons[7].prompt = ''\r\n\telse\r\n\t\tbuttons[1].prompt = int heading\r\n\t\tbuttons[7].prompt = int bearing - heading\r\n\r\n\t# if distance == null\r\n\t# \tbuttons[5].prompt = ''\r\n\t# else\r\n\r\n\t#buttons[1].prompt = gpsLat\r\n\r\n\tpush()\r\n\tsc()\r\n\tfc 0,0,0,0.5\r\n\ttranslate width/2, height/2\r\n\tscale SCALE\r\n\tcircle x-cx, y-cy, 75\r\n\tpop()\r\n\r\ndrawButtons = ->\r\n\tbuttons[2].prompt = points.length\r\n\tfor button in buttons\r\n\t\tbutton.draw()\r\n\r\nxdraw = ->\r\n\tbg 1,1,0\r\n\tfc()\r\n\timage img, 0,0, width,height, cx-width/SCALE/2, cy-height/SCALE/2, width/SCALE, height/SCALE\r\n\tdrawTrack()\r\n\tdrawPoints()\r\n\tdrawControl()\r\n\tdrawButtons()\r\n\ttextSize 50\r\n\tfor message,i in messages\r\n\t\ttext message,width/2,50*(i+1)\r\n\r\nmyMousePressed = (mx,my) ->\r\n\tfor button in buttons\r\n\t\tif button.contains mx,my\r\n\t\t\tbutton.click()\r\n\t\t\txdraw()\r\n\t\t\treturn\r\n\tarr = ([dist(cx-width/SCALE/2 + mx/SCALE, cy-height/SCALE/2+my/SCALE, control[0], control[1]), key] for key,control of controls)\r\n\tclosestControl = _.min arr, (item) -> item[0]\r\n\t[d,key] = closestControl\r\n\tif d < 85 \r\n\t\tcurrentControl = key\r\n\t\txdraw()\r\n\r\n#mousePressed = -> myMousePressed mouseX,mouseY\r\n"
  ]
}