{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "FILENAME = '2019-SommarS.jpg' # S eller N\r\n\r\nspara = (lat,lon, x,y) -> {lat,lon, x,y}\r\n\r\n# Vinterpasset 2019\r\n# A = spara 59.285607,18.150687, 178,442   # Norra brofästet\r\n# B = spara 59.284808,18.180402, 3222,338  # Shooting Range, mitt i huset\r\n# C = spara 59.270078,18.150334, 359,3488  # Östra brofästet\r\n# D = spara 59.269380,18.169612, 2303,3494 # Kolarängsvägen/Klisätravägen\r\n\r\n# Sommarpasset 2019\r\n# A = spara 59.300751, 18.125673, 223, 168  # Lilla halvön\r\n# B = spara 59.300588, 18.163454, 2680, 126  # Huset Hästhagen\r\n# C = spara 59.281980, 18.124751, 311, 2598  # Vägkorsning\r\n# D = spara 59.269734, 18.167462, 3165, 3915 # Vändplan Klisätravägen\r\n\r\n# 2019-SommarN\r\n# A = spara 59.300716, 18.125680, 197,278 # Lilla halvön\r\n# B = spara 59.299235, 18.169492, 4306,367 # Kranglans väg/Östervägen\r\n# C = spara 59.285443, 18.124585, 236,3082 # Ishockeyrink Mitten\r\n# D = spara 59.287806, 18.170784, 4525,2454 # Mittenhus t v\r\n\r\n# 2019-SommarS\r\nA = spara 59.279157, 18.149313, 2599,676 # Mellanbron\r\nB = spara 59.275129, 18.169590, 4531,1328 # Ulvsjön Vändplan Huset\r\nC = spara 59.270072, 18.150229, 2763,2334 # Brotorpsbron\r\nD = spara 59.267894, 18.167087, 4339,2645 # Älta huset\r\n\r\nDATA = \"gpsKarta\"\r\nWIDTH = null\r\nHEIGHT = null\r\n[cx,cy] = [0,0] # center (image coordinates)\r\nSCALE = 1\r\n\r\n# released = true # to make Android work\r\n\r\ngps = null\r\nTRACKED = 5 # circles shows the player's position\r\nposition = null # gps position (pixels)\r\ntrack = [] # five latest GPS positions (pixels)\r\nbuttons = []\r\npoints = [] # remembers e.g. car/bike position\r\nimg = null \r\nbearing = 360\r\nmessages = []\r\n\r\npreload = -> img = loadImage FILENAME\r\n\r\nmyround = (x,dec=6) ->\r\n\tx *= 10**dec\r\n\tx = round x\r\n\tx/10**dec\r\n\r\nshow = (prompt,p) -> print prompt,\"http://maps.google.com/maps?q=#{p.lat},#{p.lon}\"\t\r\n\r\nvercal = (a,b,y) ->\r\n\tx = map y, a.y,b.y, a.x,b.x\r\n\tlat = map y, a.y,b.y, a.lat,b.lat\r\n\tlon = map y, a.y,b.y, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\nhortal = (a,b,x) ->\r\n\ty = map x, a.x,b.x, a.y,b.y\r\n\tlat = map x, a.x,b.x, a.lat,b.lat\r\n\tlon = map x, a.x,b.x, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\ncorner = (a,b,c,d,x,y)->\r\n\tlat = map y, c.y,d.y, c.lat,d.lat  \r\n\tlon = map x, a.x,b.x, a.lon,b.lon\r\n\t{lat,lon,x,y}\r\n\r\nmakeCorners = ->\r\n\r\n\tac0 = vercal A,C,0  \t                  # beräkna x\r\n\tac1 = vercal A,C,HEIGHT\r\n\tbd0 = vercal B,D,0\r\n\tbd1 = vercal B,D,HEIGHT\r\n\r\n\tab0 = hortal A,B,0                      # beräkna y\r\n\tab1 = hortal A,B,WIDTH\r\n\tcd0 = hortal C,D,0\r\n\tcd1 = hortal C,D,WIDTH\r\n\r\n\tnw = corner ac0,bd0,ab0,cd0, 0,    0\t\t# beräkna hörnen\r\n\tne = corner ac0,bd0,ab1,cd1, WIDTH,0\r\n\tse = corner ac1,bd1,ab1,cd1, WIDTH,HEIGHT\r\n\tsw = corner ac1,bd1,ab0,cd0, 0,    HEIGHT\r\n\r\n\tgps = new GPS nw,ne,se,sw,WIDTH,HEIGHT\r\n\r\nlocationUpdate = (p) ->\r\n\t#print \r\n\tlat = p.coords.latitude\r\n\tlon = p.coords.longitude #+0.000500\r\n\t#print 'locationUpdate',lat,lon,gps\r\n\tposition = gps.gps2bmp lat,lon\r\n\ttrack.push position\r\n\tif track.length > TRACKED then track.shift()\r\n\txdraw()\r\n\tposition\r\n\r\nlocationUpdateFail = (error) ->\tif error.code == error.PERMISSION_DENIED then messages = ['Check location permissions']\r\n\r\nsetupCompass = ->\r\n\twindow.addEventListener \"deviceorientation\", (event) ->\r\n\t\tbearing = round event.alpha \r\n\t\txdraw()\r\n\r\nstoreData = -> localStorage[DATA] = JSON.stringify points\t\r\nfetchData = -> if localStorage[DATA] then points = JSON.parse localStorage[DATA]\r\n\r\nsetup = ->\r\n\tcreateCanvas windowWidth,windowHeight\r\n\r\n\tWIDTH = img.width\r\n\tHEIGHT = img.height\r\n\r\n\t[cx,cy] = [WIDTH/2,HEIGHT/2] \r\n\r\n\tfetchData()\r\n\r\n\tx = width/2\r\n\ty = height/2\r\n\tx1 = 100\r\n\tx2 = width-100\r\n\ty1 = 100\r\n\ty2 = height-100\r\n\r\n\tbuttons.push new Button 'S',x1,y1, -> \r\n\t\tpoints.push position\r\n\t\tstoreData()\r\n\r\n\tbuttons.push new Button 'U',x,y1, -> cy -= 0.5*height/SCALE\r\n\tbuttons.push new Button '0',x2,y1, -> \r\n\t\tif points.length > 0 \r\n\t\t\tpoints.pop()\r\n\t\t\tstoreData()\r\n\r\n\tbuttons.push new Button 'L',x1,y, -> cx -= 0.5*width/SCALE\r\n\tbuttons.push new Button 'C',x,y, ->\t[cx,cy] = position\r\n\tbuttons.push new Button 'R',x2,y, -> cx += 0.5*width/SCALE\r\n\tbuttons.push new Button 'D',x,y2, -> cy += 0.5*height/SCALE\r\n\tbuttons.push new Button '-',x1,y2, -> SCALE /= 1.5\r\n\tbuttons.push new Button '+',x2,y2, ->\tSCALE *= 1.5\r\n\r\n\tmakeCorners()\r\n\r\n\tposition = [WIDTH/2,HEIGHT/2]\r\n\r\n\tnavigator.geolocation.watchPosition locationUpdate, locationUpdateFail, \r\n\t\tenableHighAccuracy: true\r\n\t\tmaximumAge: 30000\r\n\t\ttimeout: 27000\r\n\r\n\tsetupCompass()\r\n\txdraw()\r\n\r\n\taddEventListener 'touchstart', (evt) ->\t\r\n\t\ttouches = evt.changedTouches\t\r\n\t\ttouch = touches[touches.length-1]\r\n\t\tfor button in buttons\r\n\t\t\tif button.contains touch.pageX,touch.pageY then button.click()\r\n\t\txdraw()\r\n\r\n\t# test \r\n\t# \tlat: 59.279170\r\n\t# \tlon: 18.149327 \r\n\t# \tx: 1932\r\n\t# \ty: 2923\r\n\r\n\t# test # Bron Ö om golfstugan\r\n\t# \tlat:59.285496\r\n\t# \tlon: 18.150525 \r\n\t# \tx: 2662\r\n\t# \ty: 2830\r\n\t# test A\r\n\t# test B\r\n\t# test C\r\n\t# test D\r\n\r\n\t# test # Brotorpsbron\r\n\t# \tlat: 59.270066 \r\n\t# \tlon: 18.150228\r\n\t# \tx: 2171\r\n\t# \ty: 4124\r\n\r\n# test = ({lat,lon,x,y}) ->\r\n# \tprint 'test'\r\n# \thash =\r\n# \t\tcoords:\r\n# \t\t\tlatitude:  lat\r\n# \t\t\tlongitude: lon\r\n# \tprint x,y,locationUpdate hash\r\n\r\ndrawTrack = ->\r\n\tpush()\r\n\tfc()\r\n\tsw 2\r\n\tsc 0 # BLACK\r\n\ttranslate width/2, height/2\r\n\tscale SCALE\r\n\tfor [x,y],i in track\r\n\t\tcircle x-cx, y-cy, 20 * (track.length-i)\r\n\tpop()\r\n\r\ndrawPoints = ->\r\n\tpush()\r\n\tsc()\r\n\tfc 1,0,0,0.5 # RED\r\n\ttranslate width/2, height/2\r\n\tscale SCALE\r\n\tfor [x,y],i in points\r\n\t\tcircle x-cx, y-cy, 20\r\n\tpop()\r\n\r\ndrawButtons = ->\r\n\tbuttons[2].prompt = points.length\r\n\tbuttons[4].prompt = 360 - bearing\r\n\tfor button in buttons\r\n\t\tbutton.draw()\r\n\r\n# drawCompass = ->\r\n# \tpush()\r\n# \tstrokeCap SQUARE\r\n# \ttranslate width/2, height/2\r\n# \trotate radians bearing\r\n# \tsw 10\r\n# \tsc 1,0,0\r\n# \tline 0,-100,0,-150\r\n# \tsc 1\r\n# \tline 0,100,0,150\r\n# \tpop()\r\n\r\nxdraw = ->\r\n\tbg 1,1,0\r\n\tfc()\r\n\timage img, 0,0, width,height, cx-width/SCALE/2, cy-height/SCALE/2, width/SCALE, height/SCALE\r\n\tdrawTrack()\r\n\tdrawPoints()\r\n\t#drawCompass()\r\n\tdrawButtons()\r\n\ttextSize 50\r\n\tfor message,i in messages\r\n\t\ttext message,width/2,50*(i+1)\r\n\r\n# mousePressed = -> # For use on PC during development only.\r\n# \tx = cx + mouseX/SCALE - width/2\r\n# \ty = cy + mouseY/SCALE - height/2\r\n# \tprint {mouseX,mouseY,cx,cy,SCALE,x,y}\r\n# \tprint gps.bmp2gps mouseX,mouseY\r\n# \tfor button in buttons\r\n# \t\tif button.contains mouseX,mouseY then button.click()\r\n# \txdraw()\r\n"
  ]
}