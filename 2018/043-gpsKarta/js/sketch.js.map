{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "FILENAME = 'karta.jpg'\r\n\r\nspara = ([lat,lon],[x,y]) -> {lat, lon, x, y}\r\nA = spara [59.300736, 18.125648],[554,433] \r\nB = spara [59.300593, 18.163456],[5422,158] \r\nC = spara [59.265339, 18.159501],[5384,9114] \r\nD = spara [59.281411, 18.122435],[338,5298] # Sockenvägen/Ätravägen\r\nE = spara [59.266262, 18.144961],[3496,8980] # Garden Center\r\n\r\nWIDTH = 6912\r\nHEIGHT = 9216\r\n[cx,cy] = [0,0] # center (image coordinates)\r\nSCALE = 1\r\n\r\nreleased = true # android\r\n\r\ngps = null\r\nTRACKED = 5 # circles shows the player's position\r\nposition = null # gps position (pixels)\r\ntrack = [] # five latest GPS positions (pixels)\r\n\r\nbuttons = []\r\n\r\nimg = null\r\n\r\npreload = -> img = loadImage FILENAME\r\n\r\nmyround = (x,dec=6) ->\r\n\tx *= 10**dec\r\n\tx = round x\r\n\tx/10**dec\r\n\r\nshow = (prompt,p) -> print prompt,\"http://maps.google.com/maps?q=#{p.lat},#{p.lon}\"\t\r\n\r\nvercal = (a,b,y) ->\r\n\tx = map y, a.y,b.y, a.x,b.x\r\n\tlat = map y, a.y,b.y, a.lat,b.lat\r\n\tlon = map y, a.y,b.y, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\nhortal = (a,b,x) ->\r\n\ty = map x, a.x,b.x, a.y,b.y\r\n\tlat = map x, a.x,b.x, a.lat,b.lat\r\n\tlon = map x, a.x,b.x, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\ncorner = (a,b,c,d,x,y)->\r\n\tlon = map x, a.x,b.x, a.lon,b.lon\r\n\tlat = map y, c.y,d.y, c.lat,d.lat  \r\n\t{lat,lon,x,y} \t\r\n\r\nmakeCorners = ->\r\n\tf = vercal A,D,0\r\n\tk = vercal A,D,HEIGHT\r\n\tg = vercal B,C,0\r\n\tj = vercal B,C,HEIGHT\r\n\r\n\tm = hortal A,B,0\r\n\th = hortal A,B,WIDTH\r\n\tl = hortal E,C,0\r\n\ti = hortal E,C,WIDTH\r\n\r\n\tnw = corner f,g,m,l,0,    0\r\n\tne = corner f,g,h,i,WIDTH,0\r\n\tse = corner k,j,h,i,WIDTH,HEIGHT\r\n\tsw = corner k,j,m,l,0,    HEIGHT\r\n\r\n\tgps = new GPS nw,ne,se,sw,WIDTH,HEIGHT\r\n\r\n\t# Testpunkter\r\n\tP1 = spara [59.275687,18.155340], [4697, 6518] # krknök\r\n\tP2 = spara [59.280348,18.155122], [4590,5310] # trevägsskylt\r\n\tP3 = B\r\n\tP4 = spara [59.279172,18.149319], [3877,5681] # Bron\r\n\r\n\tgps.check_gps2bmp P1, [6,7]\r\n\tgps.check_gps2bmp P2, [24,38]\r\n\tgps.check_gps2bmp P3, [0,1]\r\n\tgps.check_gps2bmp P4, [-4,7]\r\n\r\n\tgps.check_bmp2gps P1,[2.4,-1.2]\r\n\tgps.check_bmp2gps P2,[14.9, -7.35]\r\n\tgps.check_bmp2gps P3,[0.2,0]\r\n\tgps.check_bmp2gps P4,[2.3,2.75]\r\n\r\n\t# show 'A',A\r\n\t# show 'B',B\r\n\t# show 'C',C\r\n\t# show 'D',D\r\n\t# show 'E',E\r\n\t# show 'F',F\r\n\t# show 'G',G\r\n\t# show 'H',H\r\n\t# show 'I',I\r\n\t# show 'J',J\r\n\t# show 'K',K\r\n\t# show 'L',L\r\n\t# show 'M',M\r\n\t# show 'N',N\r\n\t# show 'O',O\r\n\t# show 'P',P\r\n\t# show 'Q',Q\r\n\r\nlocationUpdate = (p) ->\r\n\tlat = p.coords.latitude\r\n\tlon = p.coords.longitude\r\n\tposition = gps.gps2bmp lat,lon\r\n\ttrack.push position\r\n\tif track.length > TRACKED then track.shift()\r\n\r\nlocationUpdateFail = (error) ->\tif error.code == error.PERMISSION_DENIED then messages = ['Check location permissions']\r\n\r\nsetup = ->\r\n\tcreateCanvas windowWidth,windowHeight\r\n\r\n\tx = width/2\r\n\ty = height/2\r\n\tx1 = 100\r\n\tx2 = width-100\r\n\ty1 = 100\r\n\ty2 = height-100\r\n\r\n\tbuttons.push new Button 'X',x1,y1\r\n\tbuttons.push new Button 'up',x,y1, -> cy -= height/2/SCALE\r\n\tbuttons.push new Button 'Y',x2,y1\r\n\tbuttons.push new Button 'left',x1,y, -> cx -= width/2/SCALE\r\n\tbuttons.push new Button 'C',x,y, ->\t[cx,cy] = position\r\n\tbuttons.push new Button 'right',x2,y, -> cx += width/2/SCALE\r\n\tbuttons.push new Button 'down',x,y2, -> cy += height/2/SCALE\r\n\tbuttons.push new Button '-',x1,y2, -> SCALE /= 1.2\r\n\tbuttons.push new Button '+',x2,y2, -> SCALE *= 1.2\r\n\r\n\t[cx,cy] = [WIDTH/2,HEIGHT/2] \r\n\tmakeCorners()\r\n\r\n\tnavigator.geolocation.watchPosition locationUpdate, locationUpdateFail, \r\n\t\tenableHighAccuracy: true\r\n\t\tmaximumAge: 30000\r\n\t\ttimeout: 27000\r\n\r\ndrawTrack = ->\r\n\tfc()\r\n\tsw 2\r\n\tsc 1,1,0 # YELLOW\r\n\tpush()\r\n\ttranslate width/2, height/2\r\n\tscale SCALE\r\n\tfor [x,y],i in track\r\n\t\tcircle x-cx, y-cy, 5*(track.length-i)\r\n\tpop()\r\n\r\ndrawButtons = ->\r\n\tsw 1\r\n\tsc 1,1,0,0.5\r\n\tbuttons[0].prompt = round cx\r\n\tbuttons[2].prompt = round cy\r\n\tfor button in buttons\r\n\t\tbutton.draw()\r\n\r\ndraw = ->\r\n\tbg 0\r\n\timage img, 0,0, width,height, cx-width/SCALE/2, cy-height/SCALE/2, width/SCALE, height/SCALE\r\n\tdrawTrack()\r\n\tdrawButtons()\r\n\r\nmouseReleased = -> # to make Android work\r\n\treleased = true\r\n\tfalse\r\n\r\nmousePressed = ->\r\n\tif not released then return # to make Android work\r\n\treleased = false\r\n\tfor button in buttons\r\n\t\tif button.radius > dist mouseX,mouseY,button.x,button.y then button.click()\r\n"
  ]
}