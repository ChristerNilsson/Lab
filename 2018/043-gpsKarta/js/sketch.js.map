{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "spara = ([lat,lon],[x,y]) -> {lat, lon, x, y}\r\n\r\nA = spara [59.300736, 18.125648],[554,433] \r\nB = spara [59.300593, 18.163456],[5422,158] \r\nC = spara [59.265339, 18.159501],[5384,9114] \r\nD = spara [59.281411, 18.122435],[338,5298] # Sockenvägen/Ätravägen\r\nE = spara [59.266262, 18.144961],[3496,8980] # Garden Center\r\n\r\n# Testpunkter\r\nP1 = spara [59.275687,18.155340], [4697, 6518] # krknök\r\nP2 = spara [59.280348,18.155122],[4590,5310] # trevägsskylt\r\nP3 = B\r\nP4 = spara [59.279172,18.149319],[3877,5681] # Bron\r\n\r\nN = null\r\nO = null\r\nP = null\r\nQ = null\r\n\r\ncx = 0 # center\r\ncy = 0\r\nswidth = 0\r\nsheight = 0\r\n\r\nWIDTH = 6912\r\nHEIGHT = 9216\r\n\r\ngps = null\r\nSCALE = 1\r\nTRACKED = 5 # circles shows the player's position\r\nposition = null # gps position\r\ntrack = [] # five latest GPS positions\r\n\r\nbuttons = []\r\n\r\nimg = null\r\nmessage = ''\r\npreload = -> img = \tloadImage 'karta.jpg'\r\n\r\nmyround = (x) ->\r\n\tx *= 1000000\r\n\tx = round x\r\n\tx/1000000\r\n\r\nshow = (prompt,p) -> print prompt,\"http://maps.google.com/maps?q=#{p.lat},#{p.lon}\"\t\r\n\r\nvercal = (a,b,y) ->\r\n\tx = map y, a.y,b.y, a.x,b.x\r\n\tlat = map y, a.y,b.y, a.lat,b.lat\r\n\tlon = map y, a.y,b.y, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\nhortal = (a,b,x) ->\r\n\ty = map x, a.x,b.x, a.y,b.y\r\n\tlat = map x, a.x,b.x, a.lat,b.lat\r\n\tlon = map x, a.x,b.x, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\ncorner = (a,b,c,d,x,y)->\r\n\tlon = map x, a.x,b.x, a.lon,b.lon\r\n\tlat = map y, c.y,d.y, c.lat,d.lat  \r\n\t{lat,lon,x,y} \t\r\n\r\nmakeCorners = ->\r\n\tF = vercal A,D,0\r\n\tG = vercal B,C,0\r\n\tH = hortal A,B,WIDTH\r\n\tI = hortal E,C,WIDTH\r\n\tJ = vercal B,C,HEIGHT\r\n\tK = vercal A,D,HEIGHT\r\n\tL = hortal E,C,0\r\n\tM = hortal A,B,0\r\n\r\n\tN = corner F,G,M,L,0,    0\r\n\tO = corner F,G,H,I,WIDTH,0\r\n\tP = corner K,J,H,I,WIDTH,HEIGHT\r\n\tQ = corner K,J,M,L,0,    HEIGHT\r\n\r\n\tgps = new GPS N,O,P,Q,WIDTH,HEIGHT\r\n\tprint gps\r\n\r\n\t# show 'A',A\r\n\t# show 'B',B\r\n\t# show 'C',C\r\n\t# show 'D',D\r\n\t# show 'E',E\r\n\t# show 'F',F\r\n\t# show 'G',G\r\n\t# show 'H',H\r\n\t# show 'I',I\r\n\t# show 'J',J\r\n\t# show 'K',K\r\n\t# show 'L',L\r\n\t# show 'M',M\r\n\t# show 'N',N\r\n\t# show 'O',O\r\n\t# show 'P',P\r\n\t# show 'Q',Q\r\n\r\ncalcx = (x,y,a,b) ->\r\n\tlon = map x, a.x,b.x, a.lon,b.lon\r\n\tlat = map x, a.x,b.x, a.lat,b.lat  \r\n\t{lat,lon,x,y} \t\r\n\r\ncalcy = (x,y,a,b) ->\r\n\tlon = map y, a.y,b.y, a.lon,b.lon\r\n\tlat = map y, a.y,b.y, a.lat,b.lat  \r\n\t{lat,lon,x,y} \t\r\n\r\nbmp2gps = (mx,my) ->\r\n\tq1 = calcx mx,0,N,O\r\n\tq2 = calcx mx,HEIGHT,Q,P\r\n\tq = calcy mx,my,q1,q2\r\n\t[myround(q.lat,6),myround(q.lon,6)]\r\n\r\ncheck_bmp2gps = (p,error) ->\r\n\t[lat,lon] = bmp2gps p.x,p.y \r\n\tassert error, [myround(100000*(lat-p.lat),6), myround(50000*(lon-p.lon),6)]\r\n\r\nlocationUpdate = (p) ->\r\n\t#messages = []\r\n\tlat = p.coords.latitude\r\n\tlon = p.coords.longitude\r\n\t#print 'locationupdate',lat,lon\r\n\tposition = {lat,lon} \r\n\ttrack.push position\r\n\tif track.length > TRACKED then track.shift()\r\n\r\nlocationUpdateFail = (error) ->\tif error.code == error.PERMISSION_DENIED then messages = ['Check location permissions']\r\n\r\nsetup = ->\r\n\tcreateCanvas windowWidth,windowHeight\r\n\r\n\tx = width/2\r\n\ty = height/2\r\n\tx1 = 100\r\n\tx2 = width-100\r\n\ty1 = 100\r\n\ty2 = height-100\r\n\r\n\tbuttons.push new Button 'X',x1,y1\r\n\tbuttons.push new Button 'U',x,y1, -> cy-=height/2/SCALE\r\n\tbuttons.push new Button 'Y',x2,y1\r\n\tbuttons.push new Button 'L',x1,y, -> cx-=width/2/SCALE\r\n\tbuttons.push new Button 'C',x,y, ->\r\n\t\t{lat,lon} = position\r\n\t\t{x,y} = gps.gps2bmp lat,lon\r\n\t\tcx = x-width/SCALE/2 \r\n\t\tcy = y-height/SCALE/2 \r\n\tbuttons.push new Button 'R',x2,y, -> cx+=width/2/SCALE\r\n\tbuttons.push new Button 'D',x,y2, -> cy+=height/2/SCALE\r\n\tbuttons.push new Button '-',x1,y2, -> SCALE /= 1.2\r\n\tbuttons.push new Button '+',x2,y2, -> SCALE *= 1.2\r\n\r\n\t[cx,cy]=[WIDTH/2,HEIGHT/2] # A\r\n\t#[sx,sy]=[5000,0] # B\r\n\t#[sx,sy]=[3500,8000] # C\r\n\t#[sx,sy]=[0,4000] # D\r\n\t#[sx,sy]=[3000,8000] # E\r\n\t#[sx,sy]=[3500,6000] # krknök\r\n\t#[sx,sy]=[3500,5000] # trevägsskylt\r\n\r\n\ttextSize 50\r\n\r\n\tmakeCorners()\r\n\r\n\t# check_gps2bmp P1, [5,6]\r\n\t# check_gps2bmp P2, [23,37]\r\n\t# check_gps2bmp P3, [0,0]\r\n\t# check_gps2bmp P4, [-5,7]\r\n\r\n\tcheck_bmp2gps P1,[2.4,-1.2]\r\n\tcheck_bmp2gps P2,[14.9, -7.35]\r\n\tcheck_bmp2gps P3,[0.2,0]\r\n\tcheck_bmp2gps P4,[2.3,2.75]\r\n\r\n\tnavigator.geolocation.watchPosition locationUpdate, locationUpdateFail, \r\n\t\tenableHighAccuracy: true\r\n\t\tmaximumAge: 30000\r\n\t\ttimeout: 27000\r\n\r\n\tlat = 59.280348\r\n\tlon = 18.155122\r\n\tposition = {lat,lon}\r\n\ttrack.push position\t\r\n\r\ndrawGpsCircles = ->\r\n\tw = width\r\n\th = height\r\n\tfc()\r\n\tsw 2\r\n\tfor p,i in track\r\n\t\t{lat,lon} = p\t\t\r\n\t\t{x,y} = gps.gps2bmp lat,lon\r\n\t\tsc 1,1,0 # YELLOW\r\n\t\tsw 2\r\n\t\tcircle cx-width/SCALE/2 + x, cy-height/SCALE/2 + y, 5*(track.length-i)\r\n\r\ndraw = ->\r\n\tbg 0\r\n\timage img, 0,0, width,height, cx-width/SCALE/2, cy-height/SCALE/2, width/SCALE, height/SCALE\r\n\tdrawGpsCircles()\r\n\tbuttons[0].prompt = int cx\r\n\tbuttons[2].prompt = int cy\r\n\tfor button in buttons\r\n\t\tbutton.draw()\r\n\r\n\tfc 1\r\n\ttext message,100,100\r\n\r\nmousePressed = -> \r\n\tfor button in buttons\r\n\t\tif button.radius > dist mouseX,mouseY,button.x,button.y then button.click()\r\n"
  ]
}