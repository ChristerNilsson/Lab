{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# Beskrivning av kolumner i kandidaturer.js:\r\nVALTYP = 0\r\nVALOMRÅDESKOD = 1\r\nVALOMRÅDESNAMN = 2\r\nVALKRETSKOD = 3\r\nVALKRETSNAMN = 4\r\nPARTIBETECKNING = 5\r\nPARTIFÖRKORTNING = 6\r\nPARTIKOD = 7\r\nVALSEDELSSTATUS = 8\r\nLISTNUMMER = 9\r\nORDNING = 10\r\nANMKAND = 11\r\nANMDELTAGANDE = 12\r\nSAMTYCKE = 13\r\nFÖRKLARING = 14\r\nKANDIDATNUMMER = 15\r\nNAMN = 16\r\nÅLDER_PÅ_VALDAGEN = 17\r\nKÖN = 18\r\nFOLKBOKFÖRINGSORT = 19\r\nVALSEDELSUPPGIFT = 20\r\nANT_BEST_VALS = 21\r\nVALBAR_PÅ_VALDAGEN = 22\r\nGILTIG = 23\r\n\r\nPERSONS_PER_PAGE = 32\r\n\r\nVOTES = 5\r\n\r\nkommunkod = null\r\nlänskod = null\r\n\r\ntree = {}\r\nstate = 0 # 0=normal 1=qrcode\r\n\r\ncanvas = null\r\nqrcode = null\r\n\r\ndictionary = {} \r\n\t# S -> Socialdemokraterna\r\n\t# 01 -> Stockholms läns landsting\r\n\t# 0180 -> Stockholm\r\n\r\nbuttons = [] # RKL\r\npbuttons = [] # parti\r\nlbuttons = [] # letters\r\nkbuttons = [] # kandidater\r\nsbuttons = [] # Del, Up, Down\r\n\r\nselectedPersons = {R:[], L:[], K:[]}\r\n\r\nselectedButton = null\r\nselectedPartiButton = null\r\nselectedLetterButton = null\r\nselectedPersonButton = null\r\n\r\nclass Button\r\n\tconstructor : (@title, @x,@y,@w,@h,@click = ->) ->\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize 20\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif selectedButton==@ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x,@y\r\n\tinside : (mx,my) -> @x-@w/2 < mx < @x+@w/2 and @y-@h/2 < my < @y+@h/2\r\n\r\nclass PartiButton extends Button \r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize if @title in 'S C MP L M V SD KD'.split ' ' then 28 else 20\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif selectedPartiButton==@ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x,@y\r\n\r\nclass PersonButton extends Button\r\n\tconstructor : (person, x,y,w,h,click = ->) ->\r\n\t\ttitle = \"#{person[NAMN]} - #{person[VALSEDELSUPPGIFT]}\"\r\n\t\tsuper title,x,y,w,h,click\r\n\t\t@person = person\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize 12\r\n\t\ttextAlign LEFT,CENTER\r\n\t\tfc 1\r\n\t\ttext @title,@x-@w/2+5,@y\r\n\r\nclass LetterButton extends Button \r\n\tconstructor : (title,x,y,w,h,@antal,click) ->\r\n\t\tsuper title,x,y,w,h,click\r\n\t\t@page = -1\r\n\t\t@pages = 1 + @antal // PERSONS_PER_PAGE\r\n\t\tif @antal % PERSONS_PER_PAGE == 0 then @pages--\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize 20\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif selectedLetterButton==@ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x,@y\r\n\t\tpush()\r\n\t\t@pageIndicator()\r\n\t\tpop()\r\n\tpageIndicator : ->\r\n\t\tif @pages <= 1 then return \r\n\t\tdx = @w//(@pages+1)\r\n\t\tfor i in range @pages\r\n\t\t\tif i==@page then fc 1 else fc 0\r\n\t\t\tcircle @x + i*dx - dx//2*(@pages-1), @y+15, 3\r\n\r\nspara = (lista,key,value) ->\r\n\tcurrent = tree\r\n\tfor name in lista\r\n\t\ta = current[name]\r\n\t\tif a == undefined then current[name] = {}\r\n\t\tcurrent = current[name]\r\n\tcurrent[key] = value\r\n\r\nantal = (letter,personer) ->\r\n\tlst = (1 for key,person of personer when letter == person[NAMN][0])\r\n\tlst.length\r\n\r\ncreateSelectButtons = ->\r\n\tsbuttons = []\r\n\tfor typ,persons of selectedPersons\r\n\t\tprint persons\r\n\t\tfor person,i in persons\r\n\t\t\tprint person\r\n\t\t\tx = 770\r\n\t\t\ty = {R:100,L:370,K:640}[typ] + i*40\r\n\t\t\tdo (typ,i) ->\r\n\t\t\t\tsbuttons.push                            new Button ' x ',x+ 0,y,40,30, -> clickDelete @,typ,i\r\n\t\t\t\tif i>0                then sbuttons.push new Button 'upp',x+45,y,40,30, -> clickUp     @,typ,i\r\n\t\t\t\tif i<persons.length-1 then sbuttons.push new Button 'ner',x+90,y,40,30, -> clickDown   @,typ,i\r\n\r\nclickDelete = (button,typ,index) ->\r\n\tselectedPersons[typ].splice index,1 \t\r\n\tcreateSelectButtons()\r\n\r\nclickUp = (button,typ,index) ->\r\n\tarr = selectedPersons[typ]\r\n\tif index == 0 then return\r\n\t[item] = arr.splice index,1 \t\r\n\tarr.splice index-1,0,item \t\r\n\tcreateSelectButtons()\r\n\r\nclickDown = (button,typ,index) ->\r\n\tarr = selectedPersons[typ]\r\n\tif index == arr.length-1 then return\r\n\t[item] = arr.splice index,1 \t\r\n\tarr.splice index+1,0,item \t\r\n\tcreateSelectButtons()\r\n\r\nclickPersonButton = (person) ->\r\n\tpersons = selectedPersons[selectedButton.title[0]]\r\n\t# Finns partiet redan? I så fall: ersätt denna person med den nya.\r\n\tfor p,i in persons \r\n\t\tif p[PARTIKOD] == person[PARTIKOD]\r\n\t\t\tpersons[i] = person\r\n\t\t\treturn \r\n\tif persons.length < VOTES\r\n\t\tpersons.push person \r\n\t\tcreateSelectButtons()\r\n\r\nclickLetterButton = (button,letters,personer) ->\r\n\tN = PERSONS_PER_PAGE\r\n\tselectedLetterButton = button\r\n\tbutton.page = (button.page + 1) % button.pages\r\n\tkbuttons = []\r\n\tkeys = _.keys personer \r\n\tkeys.sort (a,b) -> if a.slice(a.indexOf('-')) < b.slice(b.indexOf('-')) then -1 else 1\r\n\tj = 0\r\n\tfor key in keys\r\n\t\tperson = personer[key]\r\n\t\tif person[NAMN][0] in letters\r\n\t\t\tif j // N == button.page \r\n\t\t\t\tx = 505\r\n\t\t\t\ty = 38+25*(j%N)\r\n\t\t\t\tdo (person) -> kbuttons.push new PersonButton person,x,y,400,20, -> clickPersonButton person\r\n\t\t\tj++\r\n\r\nmakeFreq = (personer) ->\r\n\tres = {}\r\n\tkeys = (person[NAMN] for key,person of personer)\r\n\tkeys.sort()\r\n\tfor key in keys\r\n\t\tletter = key[0]\r\n\t\tres[letter] = if res[letter] == undefined then 1 else res[letter] + 1\r\n\tres\r\n\r\ngruppera = (letters,n=32) ->\r\n\tres = {}\r\n\tgroup = ''\r\n\tcount = 0\r\n\tfor letter,m of letters\r\n\t\tif count + m <= n\r\n\t\t\tgroup += letter\r\n\t\t\tcount += m\r\n\t\telse\r\n\t\t\tif count > 0 then res[group] = count\r\n\t\t\tgroup = letter\r\n\t\t\tcount = m\r\n\tif count > 0 then res[group] = count\r\n\tres\r\nassert {AB:25,C:14,D:57}, gruppera {A:12, B:13, C:14, D:57}\r\nassert {ABDEF:28, GH:25}, gruppera {A:2, B:1, D:3,E:10,F:12,G:13,H:12}\r\nassert {ABDEF:28, NO:32}, gruppera {A:2, B:1, D:3,E:10,F:12,N:20,O:12}\r\n\r\nclickPartiButton = (button, personer) ->\r\n\tN = 16\r\n\tselectedPartiButton = button \r\n\tlbuttons = []\r\n\tkbuttons = []\r\n\r\n\tif PERSONS_PER_PAGE >= _.size personer\r\n\t\tkeys = _.keys personer\r\n\t\tkeys.sort (a,b) -> if a.slice(a.indexOf('-')) < b.slice(b.indexOf('-')) then -1 else 1\r\n\t\tfor key,j in keys\r\n\t\t\tperson = personer[key]\r\n\t\t\tx = 505\r\n\t\t\ty = 40+25*j\r\n\t\t\tdo (person) -> kbuttons.push new PersonButton person,x,y,400,20, -> clickPersonButton person\r\n\r\n\telse\r\n\t\ti = 0\r\n\t\tfor letters,n of gruppera makeFreq personer\r\n\t\t\t#print letters,n\r\n\t\t\tx = 225+50*(i//N)\r\n\t\t\ty = 50+50*(i%N)\r\n\t\t\ttitle = if letters.length == 1 then letters else \"#{letters[0]}-#{_.last letters}\"\r\n\t\t\tdo (letters,title) -> lbuttons.push new LetterButton title,x,y,45,45,n, -> clickLetterButton @, letters, personer\r\n\t\t\ti++\r\n\r\n\tpersons = selectedPersons[selectedButton.title[0]]\r\n\t# Finns partiet redan? I så fall: ersätt denna person med den nya.\r\n\tperson = []\r\n\tperson[NAMN] = dictionary[button.title][0]\r\n\tperson[PARTIKOD] = dictionary[button.title][1]\r\n\tperson[PARTIFÖRKORTNING] = button.title\r\n\tperson[KANDIDATNUMMER] = '99' + person[PARTIKOD].padStart 4,'0'\t\r\n\r\n\tfor p,i in persons \r\n\t\tif p[PARTIKOD] == person[PARTIKOD]\r\n\t\t\tpersons[i] = person\r\n\t\t\treturn \r\n\tif persons.length < VOTES\r\n\t\tpersons.push person \r\n\t\tcreateSelectButtons()\r\n\r\n\r\nclickButton = (button, partier) ->\r\n\tN = 16\r\n\tselectedButton = button\r\n\tpbuttons = []\r\n\tlbuttons = []\r\n\tkbuttons = []\r\n\tkeys = _.keys partier\r\n\tkeys.sort (a,b) -> _.size(partier[b]) - _.size(partier[a])\r\n\tfor key,i in keys\r\n\t\tx = 50+100*(i//N)\r\n\t\ty = 50+50*(i%N)\r\n\t\tdo (key) -> pbuttons.push new PartiButton key,x,y,95,45, -> clickPartiButton @, partier[key]\r\n\r\n# getClowner = (lines) -> # tag fram alla personer som representerar flera partier i samma valtyp\r\n# \tres = []\r\n# \tpartier = {}\r\n# \tfor line in lines \r\n# \t\tcells = line.split ';'\r\n# \t\tknr = cells[KANDIDATNUMMER]\r\n# \t\tif partier[knr] == undefined then partier[knr] = {}\r\n# \t\tpartier[knr][cells[PARTIKOD]] = cells\r\n# \tfor knr,lista of partier\r\n# \t\tif 1 == _.size lista then continue\r\n# \t\tklr = {R:0,K:0,L:0}\r\n# \t\tfor key,item of lista\r\n# \t\t\tklr[item[VALTYP]]++\r\n# \t\tif klr.R>1 or klr.K>1 or klr.L>1 then res.push knr\r\n# \tprint 'Borttagna kandidater pga flera partier i samma valtyp: ',res\r\n# \tres\r\n\r\nreadDatabase = ->\r\n\tpartikoder = {}\r\n\tpartier = {}\r\n\tlines = db.split '\\n'\r\n\r\n\t#clowner = getClowner lines\r\n\r\n\tfor line in lines\r\n\t\tcells = line.split ';'\r\n\t\tvaltyp = cells[VALTYP]\r\n\t\tområdeskod = cells[VALOMRÅDESKOD]\r\n\t\tområde = cells[VALOMRÅDESNAMN]\r\n\t\tparti = cells[PARTIFÖRKORTNING]\r\n\t\t#if parti=='' then parti = cells[PARTIKOD]\r\n\t\tknr = cells[KANDIDATNUMMER]\r\n\t\tnamn = cells[NAMN]\r\n\r\n\t\tpartikoder[cells[PARTIKOD]]=parti\r\n\r\n\t\t#if knr in clowner then continue\r\n\t\tif namn == undefined then continue\r\n\t\tif parti == '' then continue\r\n\r\n\t\tdictionary[parti] = [cells[PARTIBETECKNING],cells[PARTIKOD]]\r\n\t\tdictionary[områdeskod] = område # hanterar både kommun och landsting\r\n\t\t# S -> ['Socialdemokraterna','1234']\r\n\t\t# 01 -> '01 - Stockholms läns landsting'\r\n\t\t# 0180 -> Stockholm\r\n\r\n\t\tarr = namn.split ', '\r\n\t\tif arr.length == 2\r\n\t\t\tnamn = arr[1] + ' ' + arr[0] \r\n\t\t\tcells[NAMN] = namn\r\n\r\n\t\tif parti == '' or namn == '[inte lämnat förklaring]' then continue\r\n\t\tif valtyp == 'R'                           then spara ['00 - riksdagen',              parti], \"#{knr}-#{namn}\", cells\r\n\t\tif valtyp == 'L' and områdeskod==länskod   then spara [områdeskod,\"#{område}\",        parti], \"#{knr}-#{namn}\", cells\r\n\t\tif valtyp == 'K' and områdeskod==kommunkod then spara [områdeskod.slice(0,2), område, parti], \"#{knr}-#{namn}\", cells\r\n\tprint dictionary\r\n\tprint partikoder\r\n\t#print partier\r\n\tfor key,parti of partier\r\n\t\tif 1 < _.size parti then print key,parti\r\n\r\ngetParameters = (h = window.location.href) -> \r\n\th = decodeURI h\r\n\tarr = h.split '?'\r\n\tif arr.length != 2 then return {}\r\n\tif arr[1] == '' then return {}\r\n\t_.object(f.split '=' for f in arr[1].split '&')\t\t\r\n\r\ngetQR = ->\r\n\ts = kommunkod \r\n\tslump = int random 1000000\r\n\ts += slump.toString().padStart 6,0 # to increase probability of uniqueness \r\n\tfor typ of selectedPersons\r\n\t\tpersons = selectedPersons[typ]\r\n\t\tfor i in range VOTES\r\n\t\t\tif i < persons.length\r\n\t\t\t\tperson = persons[i]\r\n\t\t\t\ts += person[KANDIDATNUMMER].padStart 6,'0'\r\n\t\t\telse\r\n\t\t\t\ts += '000000'\r\n\tassert s.length,4+6+15*6 # 100\r\n\tprint s\r\n\ts\r\n\r\nclickUtskrift = ->\r\n\tstate = 1\r\n\tqrcode = new QRCode document.getElementById(\"qrcode\"),\r\n\t\ttext: getQR()\r\n\t\twidth: 256\r\n\t\theight: 256\r\n\t\tcolorDark : \"#000000\"\r\n\t\tcolorLight : \"#ffffff\"\r\n\t\tcorrectLevel : QRCode.CorrectLevel.L # Low Medium Q High\r\n\r\nsetup = ->\r\n\tcreateCanvas 1250,840\r\n\tsc()\r\n\r\n\t{kommunkod} = getParameters()\r\n\tif not kommunkod then kommunkod = '0180'\r\n\tlänskod = kommunkod.slice 0,2\r\n\t\r\n\treadDatabase()\r\n\tprint tree\r\n\r\n\trectMode CENTER\r\n\ttextAlign CENTER,CENTER\r\n\ttextSize 20\r\n\r\n\tbuttons.push new Button 'Riksdag',  950, 50,400,45, -> clickButton @, tree['00 - riksdagen'] \r\n\tbuttons.push new Button 'Landsting',950,310,400,45, -> clickButton @, tree[länskod][dictionary[länskod]]\r\n\tbuttons.push new Button 'Kommun',   950,570,400,45, -> clickButton @, tree[länskod][dictionary[kommunkod]]\r\n\r\n\tbuttons.push new Button 'Utskrift', 950,830,400,45, -> clickUtskrift() # @, tree[länskod][dictionary[kommunkod]]\r\n\r\nshowSelectedPersons = ->\r\n\tx = 720\r\n\tpush()\r\n\ttextAlign LEFT,CENTER\r\n\tfor typ,i in 'RLK'\r\n\t\ty0 = [100,370,640][i]\r\n\t\t#textSize 28\r\n\t\t#text buttons[i].title,x,y0\r\n\t\tfor person,j in selectedPersons[typ]\r\n\t\t\ty = y0 + 40*j\r\n\t\t\ttextSize 20\r\n\t\t\ttext \"#{j+1}.\",x,y\r\n\t\t\ttext \"#{person[PARTIFÖRKORTNING]} - #{person[NAMN]}\",x+170,y\r\n\tpop()\r\n\r\ndraw = ->\r\n\tif state == 0\r\n\t\tbg 0\r\n\t\tfor button in buttons.concat pbuttons.concat lbuttons.concat kbuttons.concat sbuttons\r\n\t\t\tbutton.draw()\r\n\t\tif selectedPartiButton != null\r\n\t\t\tpush()\r\n\t\t\ttextAlign LEFT,CENTER\r\n\t\t\ttextSize 20\r\n\t\t\ttext dictionary[selectedPartiButton.title][0],310,15\r\n\t\t\tpop()\r\n\t\tif selectedButton != null\r\n\t\t\tpush()\r\n\t\t\ttextAlign LEFT,CENTER\r\n\t\t\ttextSize 20\r\n\t\t\tif selectedButton.title == 'Riksdag'   then text 'Riksdag',            10,15\r\n\t\t\tif selectedButton.title == 'Landsting' then text dictionary[länskod],  10,15\r\n\t\t\tif selectedButton.title == 'Kommun'    then text dictionary[kommunkod],10,15\r\n\t\t\tpop()\r\n\t\tshowSelectedPersons()\r\n\tif state == 1\r\n\t\tbg 1\r\n\t\t#Drawing.draw qrcode \r\n\r\nmousePressed = ->\r\n\tfor button in buttons.concat pbuttons.concat lbuttons.concat kbuttons.concat sbuttons\r\n\t\tif button.inside mouseX,mouseY then button.click()\r\n"
  ]
}