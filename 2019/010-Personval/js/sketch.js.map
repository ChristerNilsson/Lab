{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# Beskrivning av kolumner i kandidaturer.js:\r\nVALTYP = 0\r\nVALOMRÅDESKOD = 1\r\nVALOMRÅDESNAMN = 2\r\nVALKRETSKOD = 3\r\nVALKRETSNAMN = 4\r\nPARTIBETECKNING = 5\r\nPARTIFÖRKORTNING = 6\r\nPARTIKOD = 7\r\nVALSEDELSSTATUS = 8\r\nLISTNUMMER = 9\r\nORDNING = 10\r\nANMKAND = 11\r\nANMDELTAGANDE = 12\r\nSAMTYCKE = 13\r\nFÖRKLARING = 14\r\nKANDIDATNUMMER = 15\r\nNAMN = 16\r\nÅLDER_PÅ_VALDAGEN = 17\r\nKÖN = 18\r\nFOLKBOKFÖRINGSORT = 19\r\nVALSEDELSUPPGIFT = 20\r\nANT_BEST_VALS = 21\r\nVALBAR_PÅ_VALDAGEN = 22\r\nGILTIG = 23\r\n\r\nPERSONS_PER_PAGE = 32\r\n\r\nVOTES = 5\r\n\r\nkommunkod = null\r\nlänskod = null\r\n\r\ntree = {}\r\n\r\ncanvas = null\r\nqrcode = null\r\nqr = null\r\n\r\ndictionary = {} \r\n\t# S -> Socialdemokraterna\r\n\t# 01 -> Stockholms läns landsting\r\n\t# 0180 -> Stockholm\r\n\r\nstate = 0 # 0=normal 1=qrcode\r\npages = []\r\n\r\nselectedPersons = {R:[], L:[], K:[]}\r\n\r\nselectedButton = null\r\nselectedPartiButton = null\r\nselectedLetterButton = null\r\nselectedPersonButton = null\r\n\r\nclass Page\r\n\tconstructor : (@render = ->) ->\r\n\t\t@buttons  = [] \r\n\r\n\tadd : (button) -> \r\n\t\t@buttons.push button\r\n\t\tbutton\r\n\r\n\tdraw : ->\r\n\t\t@render()\r\n\t\tfor button in @buttons\r\n\t\t\tbutton.draw()\r\n\r\n\tmousePressed : ->\r\n\t\tfor button in @buttons\r\n\t\t\tif button.inside mouseX,mouseY then button.click()\r\n\r\nclass Page0 extends Page\r\n\tconstructor : (@render = ->) ->\r\n\t\tsuper()\r\n\t\t@rbuttons = [] # RKL\r\n\t\t@init()\r\n\r\n\tradd : (button) -> @rbuttons.push button\r\n\tpadd : (button) -> @pbuttons.push button\r\n\tladd : (button) -> @lbuttons.push button\r\n\tkadd : (button) -> @kbuttons.push button\r\n\tsadd : (button) -> @sbuttons.push button\r\n\r\n\tallButtons : -> @rbuttons.concat @pbuttons.concat @lbuttons.concat @kbuttons.concat @sbuttons\r\n\r\n\tinit : ->\r\n\t\t@pbuttons = [] # parti\r\n\t\t@lbuttons = [] # letters\r\n\t\t@kbuttons = [] # kandidater\r\n\t\t@sbuttons = [] # Del, Up, Down\r\n\r\n\tdraw : ->\r\n\t\t@render()\r\n\t\tfor button in @allButtons()\r\n\t\t\tbutton.draw()\r\n\r\n\tmousePressed : ->\r\n\t\tfor button in @allButtons()\r\n\t\t\tif button.inside mouseX,mouseY then button.click()\r\n\r\nclass Page1 extends Page\r\n\r\nclass Button\r\n\tconstructor : (@title, @x,@y,@w,@h,@click = ->) ->\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize 20\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif selectedButton==@ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x+@w/2,@y+@h/2\r\n\tinside : (mx,my) -> @x < mx < @x+@w and @y < my < @y+@h\r\n\r\nclass PartiButton extends Button \r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize if @title in 'S C MP L M V SD KD'.split ' ' then 28 else 20\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif selectedPartiButton==@ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x+@w/2,@y+@h/2\r\n\r\nclass PersonButton extends Button\r\n\tconstructor : (person, x,y,w,h,click = ->) ->\r\n\t\ttitle = \"#{person[NAMN]} - #{person[VALSEDELSUPPGIFT]}\"\r\n\t\tsuper title,x,y,w,h,click\r\n\t\t@person = person\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize 12\r\n\t\ttextAlign LEFT,CENTER\r\n\t\tfc 1\r\n\t\ttext @title,@x+5,@y+2+@h/2\r\n\r\nclass LetterButton extends Button \r\n\tconstructor : (title,x,y,w,h,@antal,click) ->\r\n\t\tsuper title,x,y,w,h,click\r\n\t\t@page = -1\r\n\t\t@pages = 1 + @antal // PERSONS_PER_PAGE\r\n\t\tif @antal % PERSONS_PER_PAGE == 0 then @pages--\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize 20\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif selectedLetterButton==@ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x+@w/2,@y+@h/2\r\n\t\tpush()\r\n\t\t@pageIndicator()\r\n\t\tpop()\r\n\tpageIndicator : ->\r\n\t\tif @pages <= 1 then return \r\n\t\tdx = @w//(@pages+1)\r\n\t\tfor i in range @pages\r\n\t\t\tif i==@page then fc 1 else fc 0\r\n\t\t\tcircle @x + (i+1)*dx , @y+0.85*@h, 3  \r\n\r\nspara = (lista,key,value) ->\r\n\tcurrent = tree\r\n\tfor name in lista\r\n\t\ta = current[name]\r\n\t\tif a == undefined then current[name] = {}\r\n\t\tcurrent = current[name]\r\n\tcurrent[key] = value\r\n\r\nantal = (letter,personer) ->\r\n\tlst = (1 for key,person of personer when letter == person[NAMN][0])\r\n\tlst.length\r\n\r\ncreateSelectButtons = ->\r\n\tpages[0].sbuttons = []\r\n\tfor typ,persons of selectedPersons\r\n\t\tfor person,i in persons\r\n\t\t\tx = 1160\r\n\t\t\ty = {R:80,L:340,K:600}[typ] + i*40-15\r\n\t\t\tdo (typ,i) ->\r\n\t\t\t\tif i>0 then pages[0].sadd new Button 'byt',x+10, y-20,40,30, -> clickSwap   typ,i\r\n\t\t\t\tpages[0].sadd             new Button ' x ',x+55, y,   30,30, -> clickDelete typ,i\r\n\r\nclickDelete = (typ,index) ->\r\n\tselectedPersons[typ].splice index,1 \t\r\n\tcreateSelectButtons()\r\n\r\nclickSwap = (typ,index) ->\r\n\tarr = selectedPersons[typ]\r\n\t[arr[index],arr[index-1]] = [arr[index-1],arr[index]]\r\n\tcreateSelectButtons()\r\n\r\nclickRensa = ->\r\n\tselectedPersons = {R:[], L:[], K:[]}\r\n\tcreateSelectButtons()\t\r\n\tpages[0].init()\r\n\tselectedButton = null\r\n\tselectedPartiButton = null\r\n\tselectedLetterButton = null\r\n\tselectedPersonButton = null\r\n\tqr = ''\r\n\r\nclickPersonButton = (person) ->\r\n\tpersons = selectedPersons[selectedButton.title[0]]\r\n\t# Finns partiet redan? I så fall: ersätt denna person med den nya.\r\n\tfor p,i in persons \r\n\t\tif p[PARTIKOD] == person[PARTIKOD]\r\n\t\t\tpersons[i] = person\r\n\t\t\treturn \r\n\tif persons.length < VOTES\r\n\t\tpersons.push person \r\n\t\tcreateSelectButtons()\r\n\r\nclickLetterButton = (button,letters,personer) ->\r\n\tN = PERSONS_PER_PAGE\r\n\tselectedLetterButton = button\r\n\tbutton.page = (button.page + 1) % button.pages\r\n\tpages[0].kbuttons = []\r\n\tkeys = _.keys personer \r\n\tkeys.sort (a,b) -> if a.slice(a.indexOf('-')) < b.slice(b.indexOf('-')) then -1 else 1\r\n\tj = 0\r\n\tfor key in keys\r\n\t\tperson = personer[key]\r\n\t\tif person[NAMN][0] in letters\r\n\t\t\tif j // N == button.page \r\n\t\t\t\tx = 305\r\n\t\t\t\ty = 30+25*(j%N)\r\n\t\t\t\tdo (person) -> pages[0].kadd new PersonButton person,x,y,400,20, -> clickPersonButton person\r\n\t\t\tj++\r\n\r\nmakeFreq = (personer) ->\r\n\tres = {}\r\n\tkeys = (person[NAMN] for key,person of personer)\r\n\tkeys.sort()\r\n\tfor key in keys\r\n\t\tletter = key[0]\r\n\t\tres[letter] = if res[letter] == undefined then 1 else res[letter] + 1\r\n\tres\r\n\r\ngruppera = (letters,n=32) ->\r\n\tres = {}\r\n\tgroup = ''\r\n\tcount = 0\r\n\tfor letter,m of letters\r\n\t\tif count + m <= n\r\n\t\t\tgroup += letter\r\n\t\t\tcount += m\r\n\t\telse\r\n\t\t\tif count > 0 then res[group] = count\r\n\t\t\tgroup = letter\r\n\t\t\tcount = m\r\n\tif count > 0 then res[group] = count\r\n\tres\r\nassert {AB:25,C:14,D:57}, gruppera {A:12, B:13, C:14, D:57}\r\nassert {ABDEF:28, GH:25}, gruppera {A:2, B:1, D:3,E:10,F:12,G:13,H:12}\r\nassert {ABDEF:28, NO:32}, gruppera {A:2, B:1, D:3,E:10,F:12,N:20,O:12}\r\n\r\nclickPartiButton = (button, personer) ->\r\n\tN = 16\r\n\tselectedPartiButton = button \r\n\tpages[0].lbuttons = []\r\n\tpages[0].kbuttons = []\r\n\r\n\tif PERSONS_PER_PAGE >= _.size personer\r\n\t\tkeys = _.keys personer\r\n\t\tkeys.sort (a,b) -> if a.slice(a.indexOf('-')) < b.slice(b.indexOf('-')) then -1 else 1\r\n\t\tfor key,j in keys\r\n\t\t\tperson = personer[key]\r\n\t\t\tx = 310\r\n\t\t\ty = 30+25*(j%N)\r\n\r\n\t\t\tdo (person) -> pages[0].kadd new PersonButton person,x,y,395,20, -> clickPersonButton person\r\n\r\n\telse\r\n\t\ti = 0\r\n\t\tfor letters,n of gruppera makeFreq personer\r\n\t\t\t#print letters,n\r\n\t\t\tx = 205+50*(i//N)\r\n\t\t\ty = 30 +50*(i%N)\r\n\t\t\ttitle = if letters.length == 1 then letters else \"#{letters[0]}-#{_.last letters}\"\r\n\t\t\tdo (letters,title) -> pages[0].ladd new LetterButton title,x,y,45,45,n, -> clickLetterButton @, letters, personer\r\n\t\t\ti++\r\n\r\n\tpersons = selectedPersons[selectedButton.title[0]]\r\n\t# Finns partiet redan? I så fall: ersätt denna person med den nya.\r\n\tperson = []\r\n\tperson[NAMN] = dictionary[button.title][0]\r\n\tperson[PARTIKOD] = dictionary[button.title][1]\r\n\tperson[PARTIFÖRKORTNING] = button.title\r\n\tperson[KANDIDATNUMMER] = '99' + person[PARTIKOD].padStart 4,'0'\t\r\n\r\n\tfor p,i in persons \r\n\t\tif p[PARTIKOD] == person[PARTIKOD]\r\n\t\t\tpersons[i] = person\r\n\t\t\treturn \r\n\tif persons.length < VOTES\r\n\t\tpersons.push person \r\n\t\tcreateSelectButtons()\r\n\r\nclickButton = (button, partier) ->\r\n\tN = 16\r\n\tselectedButton = button\r\n\tpages[0].pbuttons = []\r\n\tpages[0].lbuttons = []\r\n\tpages[0].kbuttons = []\r\n\tkeys = _.keys partier\r\n\tkeys.sort (a,b) -> _.size(partier[b]) - _.size(partier[a])\r\n\tfor key,i in keys\r\n\t\tx =  5+100*(i//N)\r\n\t\ty = 30+50*(i%N)\r\n\t\tdo (key) -> pages[0].padd new PartiButton key,x,y,95,45, -> clickPartiButton @, partier[key]\r\n\r\n# getClowner = (lines) -> # tag fram alla personer som representerar flera partier i samma valtyp\r\n# \tres = []\r\n# \tpartier = {}\r\n# \tfor line in lines \r\n# \t\tcells = line.split ';'\r\n# \t\tknr = cells[KANDIDATNUMMER]\r\n# \t\tif partier[knr] == undefined then partier[knr] = {}\r\n# \t\tpartier[knr][cells[PARTIKOD]] = cells\r\n# \tfor knr,lista of partier\r\n# \t\tif 1 == _.size lista then continue\r\n# \t\tklr = {R:0,K:0,L:0}\r\n# \t\tfor key,item of lista\r\n# \t\t\tklr[item[VALTYP]]++\r\n# \t\tif klr.R>1 or klr.K>1 or klr.L>1 then res.push knr\r\n# \tprint 'Borttagna kandidater pga flera partier i samma valtyp: ',res\r\n# \tres\r\n\r\nreadDatabase = ->\r\n\tpartikoder = {}\r\n\tpartier = {}\r\n\tlines = db.split '\\n'\r\n\r\n\t#clowner = getClowner lines\r\n\r\n\tfor line in lines\r\n\t\tcells = line.split ';'\r\n\t\tvaltyp = cells[VALTYP]\r\n\t\tområdeskod = cells[VALOMRÅDESKOD]\r\n\t\tområde = cells[VALOMRÅDESNAMN]\r\n\t\tparti = cells[PARTIFÖRKORTNING]\r\n\t\t#if parti=='' then parti = cells[PARTIKOD]\r\n\t\tknr = cells[KANDIDATNUMMER]\r\n\t\tnamn = cells[NAMN]\r\n\r\n\t\tpartikoder[cells[PARTIKOD]]=parti\r\n\r\n\t\t#if knr in clowner then continue\r\n\t\tif namn == undefined then continue\r\n\t\tif parti == '' then continue\r\n\r\n\t\tdictionary[parti] = [cells[PARTIBETECKNING],cells[PARTIKOD]]\r\n\t\tdictionary[områdeskod] = område # hanterar både kommun och landsting\r\n\t\t# S -> ['Socialdemokraterna','1234']\r\n\t\t# 01 -> '01 - Stockholms läns landsting'\r\n\t\t# 0180 -> Stockholm\r\n\r\n\t\tarr = namn.split ', '\r\n\t\tif arr.length == 2\r\n\t\t\tnamn = arr[1] + ' ' + arr[0] \r\n\t\t\tcells[NAMN] = namn\r\n\r\n\t\tif parti == '' or namn == '[inte lämnat förklaring]' then continue\r\n\t\tif valtyp == 'R'                           then spara ['00 - riksdagen',              parti], \"#{knr}-#{namn}\", cells\r\n\t\tif valtyp == 'L' and områdeskod==länskod   then spara [områdeskod,\"#{område}\",        parti], \"#{knr}-#{namn}\", cells\r\n\t\tif valtyp == 'K' and områdeskod==kommunkod then spara [områdeskod.slice(0,2), område, parti], \"#{knr}-#{namn}\", cells\r\n\tprint dictionary\r\n\tprint partikoder\r\n\t#print partier\r\n\tfor key,parti of partier\r\n\t\tif 1 < _.size parti then print key,parti\r\n\r\ngetParameters = (h = window.location.href) -> \r\n\th = decodeURI h\r\n\tarr = h.split '?'\r\n\tif arr.length != 2 then return {}\r\n\tif arr[1] == '' then return {}\r\n\t_.object(f.split '=' for f in arr[1].split '&')\t\t\r\n\r\ngetQR = ->\r\n\ts = kommunkod \r\n\tslump = int random 1000000\r\n\ts += slump.toString().padStart 6,0 # to increase probability of uniqueness \r\n\tfor typ of selectedPersons\r\n\t\tpersons = selectedPersons[typ]\r\n\t\tfor i in range VOTES\r\n\t\t\tif i < persons.length\r\n\t\t\t\tperson = persons[i]\r\n\t\t\t\ts += person[KANDIDATNUMMER].padStart 6,'0'\r\n\t\t\telse\r\n\t\t\t\ts += '000000'\r\n\tassert s.length,4+6+15*6 # 100\r\n\ts\r\n\r\nclickUtskrift = ->\r\n\tstate = 1\r\n\tqr = getQR()\r\n\tqrcode = new QRCode document.getElementById(\"qrcode\"),\r\n\t\ttext: qr\r\n\t\twidth: 256\r\n\t\theight: 256\r\n\t\tcolorDark : \"#000000\"\r\n\t\tcolorLight : \"#ffffff\"\r\n\t\tcorrectLevel : QRCode.CorrectLevel.L # Low Medium Q High\r\n\r\nclickFortsätt = -> \r\n\tmyNode = document.getElementById \"qrcode\"\r\n\tmyNode.innerHTML = ''\r\n\tstate = 0\r\n\r\nsetup = ->\r\n\tcanvas = createCanvas 1255,840\r\n\tcanvas.parent 'canvas'\t\r\n\r\n\tpages.push new Page0 -> # pages[0].render()\r\n\t\tbg 0\r\n\t\tif selectedPartiButton != null\r\n\t\t\tpush()\r\n\t\t\ttextAlign LEFT,CENTER\r\n\t\t\ttextSize 20\r\n\t\t\ttext dictionary[selectedPartiButton.title][0],310,15\r\n\t\t\tpop()\r\n\t\tif selectedButton != null\r\n\t\t\tpush()\r\n\t\t\ttextAlign LEFT,CENTER\r\n\t\t\ttextSize 20\r\n\t\t\tif selectedButton.title == 'Riksdag'   then text 'Riksdag',            10,15\r\n\t\t\tif selectedButton.title == 'Landsting' then text dictionary[länskod],  10,15\r\n\t\t\tif selectedButton.title == 'Kommun'    then text dictionary[kommunkod],10,15\r\n\t\t\tpop()\r\n\t\tshowSelectedPersons 750,100-20\r\n\r\n\tpages.push new Page1 -> # pages[1].render()\r\n\t\ttextAlign LEFT,CENTER\r\n\t\tbg 1\r\n\t\tfc 0\r\n\t\ttext qr,50,height-20\r\n\r\n\t\ttext 'Riksdag',            10,50+0\r\n\t\ttext dictionary[länskod],  10,50+260\r\n\t\ttext dictionary[kommunkod],10,50+520\r\n\t\t\r\n\t\tshowSelectedPersons 400,50\r\n\r\n\tsc()\r\n\r\n\t{kommunkod} = getParameters()\r\n\tif not kommunkod then kommunkod = '0180'\r\n\tlänskod = kommunkod.slice 0,2\r\n\t\r\n\treadDatabase()\r\n\tprint tree\r\n\r\n\ttextAlign CENTER,CENTER\r\n\ttextSize 20\r\n\r\n\tpages[0].radd new Button 'Riksdag',   710,5,540,50, -> clickButton @, tree['00 - riksdagen'] \r\n\tpages[0].radd new Button 'Landsting', 710,265,540,50, -> clickButton @, tree[länskod][dictionary[länskod]]\r\n\tpages[0].radd new Button 'Kommun',    710,525,540,50, -> clickButton @, tree[länskod][dictionary[kommunkod]]\r\n\tpages[0].radd new Button 'Utskrift',  710,785,270,50, -> clickUtskrift() \r\n\tpages[0].radd new Button 'Rensa',     985,785,265,50, -> clickRensa()\r\n\r\n\tpages[1].add new Button 'Utskrift', 360,height-82,270,45, -> window.print()\r\n\tpages[1].add new Button 'Fortsätt', 635,height-82,270,45, -> clickFortsätt()\r\n\r\nshowSelectedPersons = (xoff,yoff) ->\r\n\tpush()\r\n\ttextAlign LEFT,CENTER\r\n\tfor typ,i in 'RLK'\r\n\t\tpush()\r\n\t\trectMode CORNER\r\n\t\ty0 = yoff+[0,260,520][i]\r\n\t\tif i == 0 then fc 1,1,0.5\r\n\t\tif i == 1 then fc 0.5,0.75,1\r\n\t\tif i == 2 then fc 1\r\n\t\trect xoff-40,y0-20,540,200\r\n\t\tpop()\r\n\r\n\t\tfc 0\r\n\t\tfor person,j in selectedPersons[typ]\r\n\t\t\ty = y0 + 40*j\r\n\t\t\ttextSize 20\r\n\t\t\ttext \"#{j+1}  #{person[PARTIFÖRKORTNING]} - #{person[NAMN]}\",xoff-30,y\r\n\tpop()\r\n\r\ndraw = ->\tpages[state].draw()\r\nmousePressed = -> pages[state].mousePressed mouseX,mouseY\r\n"
  ]
}