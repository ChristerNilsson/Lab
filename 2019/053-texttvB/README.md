by Mattias Lundberg

minor modifications by Christer Nilsson