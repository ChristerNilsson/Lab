// Generated by CoffeeScript 2.3.2
var Game, assert, createAndAppend, div0, div1, div2, div3, game, input, probability, range;

assert = chai.assert.deepEqual;

range = _.range;

createAndAppend = (parent, type, attributes) => {
  var attribute, elem, key;
  elem = document.createElement(type);
  parent.appendChild(elem);
  for (key in attributes) {
    attribute = attributes[key];
    elem[key] = attribute;
  }
  return elem;
};

Game = class Game {
  constructor(level) {
    this.init = this.init.bind(this);
    this.action = this.action.bind(this);
    this.render = this.render.bind(this);
    this.init(level);
  }

  init(level1) {
    this.level = level1;
    if (this.level < 2) {
      this.level = 2;
    }
    this.low = 1;
    this.high = 2 ** this.level - 1;
    this.secret = _.random(this.low, this.high);
    this.hist = [];
    div0.innerText = 'Level: ' + this.level;
    this.render();
    return div3.innerText = 'Probability: ' + probability(this.level).toFixed(3) + ' steps';
  }

  action() {
    var value;
    if (input.value === '') {
      return;
    }
    value = parseInt(input.value);
    input.value = '';
    this.hist.push(value);
    if (value < this.secret && value >= this.low) {
      this.low = value + 1;
    }
    if (value > this.secret && value <= this.high) {
      this.high = value - 1;
    }
    if (value === this.secret) {
      this.init(this.level + (this.hist.length <= this.level ? 1 : -1));
    }
    return this.render();
  }

  render() {
    div1.innerText = 'Interval: ' + this.low + '-' + this.high;
    return div2.innerText = 'History: ' + this.hist.join(' ');
  }

};

probability = (n) => {
  var result;
  result = range(n).map((x) => {
    return (x + 1) * 2 ** x;
  }).reduce((a, b) => {
    return a + b;
  });
  return result / (2 ** n - 1);
};

div0 = createAndAppend(document.body, 'div');

div1 = createAndAppend(document.body, 'div');

input = createAndAppend(document.body, 'input', {
  style: "font-size:100px"
});

div2 = createAndAppend(document.body, 'div');

div3 = createAndAppend(document.body, 'div');

input.onkeyup = (evt) => {
  if (evt.key === 'Enter') {
    return game.action();
  }
};

game = new Game(2);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsSUFBQSxFQUFBLE1BQUEsRUFBQSxlQUFBLEVBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxLQUFBLEVBQUEsV0FBQSxFQUFBOztBQUFBLE1BQUEsR0FBUyxJQUFJLENBQUMsTUFBTSxDQUFDOztBQUNyQixLQUFBLEdBQVEsQ0FBQyxDQUFDOztBQUVWLGVBQUEsR0FBa0IsQ0FBQyxNQUFELEVBQVEsSUFBUixFQUFhLFVBQWIsQ0FBQSxHQUFBO0FBQ2pCLE1BQUEsU0FBQSxFQUFBLElBQUEsRUFBQTtFQUFBLElBQUEsR0FBUSxRQUFRLENBQUMsYUFBVCxDQUF1QixJQUF2QjtFQUNSLE1BQU0sQ0FBQyxXQUFQLENBQW1CLElBQW5CO0VBQ0EsS0FBQSxpQkFBQTs7SUFDQyxJQUFLLENBQUEsR0FBQSxDQUFMLEdBQVk7RUFEYjtTQUVBO0FBTGlCOztBQU9aLE9BQU4sTUFBQSxLQUFBO0VBQ0MsV0FBYyxDQUFDLEtBQUQsQ0FBQTtRQUVkLENBQUEsV0FBQSxDQUFBO1FBVUEsQ0FBQSxhQUFBLENBQUE7UUFXQSxDQUFBLGFBQUEsQ0FBQTtJQXZCeUIsSUFBQyxDQUFBLElBQUQsQ0FBTSxLQUFOO0VBQVg7O0VBRWQsSUFBTyxPQUFBLENBQUE7SUFBQyxJQUFDLENBQUE7SUFDUixJQUFHLElBQUMsQ0FBQSxLQUFELEdBQVMsQ0FBWjtNQUFtQixJQUFDLENBQUEsS0FBRCxHQUFTLEVBQTVCOztJQUNBLElBQUMsQ0FBQSxHQUFELEdBQU87SUFDUCxJQUFDLENBQUEsSUFBRCxHQUFRLENBQUEsSUFBRyxJQUFDLENBQUEsS0FBSixHQUFZO0lBQ3BCLElBQUMsQ0FBQSxNQUFELEdBQVUsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxJQUFDLENBQUEsR0FBVixFQUFl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c2VydCA9IGNoYWkuYXNzZXJ0LmRlZXBFcXVhbFxyXG5yYW5nZSA9IF8ucmFuZ2VcclxuXHJcbmNyZWF0ZUFuZEFwcGVuZCA9IChwYXJlbnQsdHlwZSxhdHRyaWJ1dGVzKSA9PlxyXG5cdGVsZW0gID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCB0eXBlXHJcblx0cGFyZW50LmFwcGVuZENoaWxkIGVsZW1cclxuXHRmb3Iga2V5LGF0dHJpYnV0ZSBvZiBhdHRyaWJ1dGVzXHJcblx0XHRlbGVtW2tleV0gPSBhdHRyaWJ1dGVcclxuXHRlbGVtXHJcblxyXG5jbGFzcyBHYW1lIFxyXG5cdGNvbnN0cnVjdG9yIDogKGxldmVsKSAtPiBAaW5pdCBsZXZlbFxyXG5cclxuXHRpbml0IDogKEBsZXZlbCkgPT5cclxuXHRcdGlmIEBsZXZlbCA8IDIgdGhlbiBAbGV2ZWwgPSAyXHJcblx0XHRAbG93ID0gMVxyXG5cdFx0QGhpZ2ggPSAyKipAbGV2ZWwgLSAxXHJcblx0XHRAc2VjcmV0ID0gXy5yYW5kb20gQGxvdywgQGhpZ2hcclxuXHRcdEBoaXN0ID0gW11cclxuXHRcdGRpdjAuaW5uZXJUZXh0ID0gJ0xldmVsOiAnICsgQGxldmVsIFxyXG5cdFx0QHJlbmRlcigpXHJcblx0XHRkaXYzLmlubmVyVGV4dCA9ICdQcm9iYWJpbGl0eTogJyArIHByb2JhYmlsaXR5KEBsZXZlbCkudG9GaXhlZCgzKSArICcgc3RlcHMnXHJcblx0XHJcblx0YWN0aW9uIDogPT5cclxuXHRcdGlmIGlucHV0LnZhbHVlID09ICcnIHRoZW4gcmV0dXJuIFxyXG5cdFx0dmFsdWUgPSBwYXJzZUludCBpbnB1dC52YWx1ZVxyXG5cdFx0aW5wdXQudmFsdWUgPSAnJ1xyXG5cdFx0QGhpc3QucHVzaCB2YWx1ZVxyXG5cdFx0aWYgdmFsdWUgPCBAc2VjcmV0IGFuZCB2YWx1ZSA+PSBAbG93IHRoZW4gQGxvdyA9IHZhbHVlICsgMVxyXG5cdFx0aWYgdmFsdWUgPiBAc2VjcmV0IGFuZCB2YWx1ZSA8PSBAaGlnaCB0aGVuIEBoaWdoID0gdmFsdWUgLSAxXHJcblx0XHRpZiB2YWx1ZSA9PSBAc2VjcmV0IFxyXG5cdFx0XHRAaW5pdCBAbGV2ZWwgKyBpZiBAaGlzdC5sZW5ndGggPD0gQGxldmVsIHRoZW4gMSBlbHNlIC0xXHJcblx0XHRAcmVuZGVyKClcclxuXHJcblx0cmVuZGVyIDogPT5cclxuXHRcdGRpdjEuaW5uZXJUZXh0ID0gJ0ludGVydmFsOiAnICsgQGxvdyArICctJyArIEBoaWdoXHJcblx0XHRkaXYyLmlubmVyVGV4dCA9ICdIaXN0b3J5OiAnICsgQGhpc3Quam9pbiAnICdcclxuXHJcbnByb2JhYmlsaXR5ID0gKG4pID0+XHJcblx0cmVzdWx0ID0gcmFuZ2UgbiBcclxuXHRcdC5tYXAgKHgpID0+ICh4KzEpKjIqKnhcclxuXHRcdC5yZWR1Y2UgKGEsYikgPT4gYStiXHJcblx0cmVzdWx0LygyKipuLTEpXHJcblxyXG5kaXYwID0gY3JlYXRlQW5kQXBwZW5kIGRvY3VtZW50LmJvZHksICdkaXYnXHJcbmRpdjEgPSBjcmVhdGVBbmRBcHBlbmQgZG9jdW1lbnQuYm9keSwgJ2RpdidcclxuaW5wdXQgPSBjcmVhdGVBbmRBcHBlbmQgZG9jdW1lbnQuYm9keSwgJ2lucHV0Jywge3N0eWxlOlwiZm9udC1zaXplOjEwMHB4XCJ9XHJcbmRpdjIgPSBjcmVhdGVBbmRBcHBlbmQgZG9jdW1lbnQuYm9keSwgJ2RpdidcclxuZGl2MyA9IGNyZWF0ZUFuZEFwcGVuZCBkb2N1bWVudC5ib2R5LCAnZGl2J1xyXG5pbnB1dC5vbmtleXVwID0gKGV2dCkgPT4gaWYgZXZ0LmtleSA9PSAnRW50ZXInIHRoZW4gZ2FtZS5hY3Rpb24oKVxyXG5cclxuZ2FtZSA9IG5ldyBHYW1lIDJcclxuIl19
//# sourceURL=c:\Lab\2019\065-GuessMyNumberInterval\coffee\sketch.coffee