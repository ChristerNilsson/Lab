'use strict';

// Generated by CoffeeScript 2.3.2
var RDI, buildDb, db, f, format, gr, mgr, priser, setup, µgr;

priser = {
  K963: 30 / 0.300,
  K2226: 30,
  K1395: 80 / 0.25, // räkor, skalade. 50% går bort.
  K2238: 40 / 0.540 // chorizo
};

gr = 1;

mgr = 0.001;

µgr = 1e-6;

RDI = {
  mg: 0.350 * mgr,
  selen: 1 * µgr // ren gissning
};

f = function f(s) {
  var amount, arr, data, fett, item, j, kcal, key, kolhydrater, len, mg, name, pris, protein, ref, res, total;
  res = [];
  total = {
    pris: 0,
    kcal: 0,
    kolhydrater: 0,
    fett: 0,
    protein: 0,
    mg: 0
  };
  ref = s.split('|');
  for (j = 0, len = ref.length; j < len; j++) {
    item = ref[j];
    arr = item.split(' ');
    key = arr[0];
    amount = parseInt(arr[1]);
    data = db[key];
    name = data[0];
    pris = priser[key];
    kcal = parseFloat(data[2]);
    kolhydrater = parseFloat(data[4]);
    fett = parseFloat(data[5]);
    protein = parseFloat(data[6]);
    mg = parseFloat(data[54]);
    total.pris += amount / 1000 * pris;
    total.kcal += amount / 100 * kcal;
    total.kolhydrater += amount / 100 * kolhydrater; // [g]
    total.fett += amount / 100 * fett; // [g]
    total.protein += amount / 100 * protein; // [g]
    total.mg += amount / 100 * mg; // [mg] 
    res.push([amount, kcal, kolhydrater, fett, protein, mg, name]);
  }
  total["fett/protein"] = format(0, '%', 100 * total.fett / total.protein); // Riktvärde: 1.0
  total.pris = format(2, 'kr', total.pris);
  total.kcal = format(0, 'kcal', total.kcal);
  total.kolhydrater = format(0, 'g', total.kolhydrater);
  total.fett = format(0, 'g', total.fett);
  total.protein = format(0, 'g', total.protein);
  total.mg = format(0, 'mg', total.mg);
  res.push(total);
  return res;
};

format = function format(decs, unit, value) {
  return value.toFixed(decs) + ' ' + unit;
};

db = {};

buildDb = function buildDb() {
  var arr, i, item, j, k, len, len1, line, ref, results;
  ref = database.split('\n');
  results = [];
  for (j = 0, len = ref.length; j < len; j++) {
    line = ref[j];
    arr = line.split('|');
    for (i = k = 0, len1 = arr.length; k < len1; i = ++k) {
      item = arr[i];
      if (item === '') {
        arr[i] = 0;
      }
    }
    arr[0] = arr[0].toLowerCase();
    if (arr[0].includes('chorizo')) {
      print(arr[0], arr[1]);
    }
    results.push(db["K" + arr[1]] = arr);
  }
  return results;
};

setup = function setup() {
  createCanvas(200, 200);
  //print titles.split '|'
  buildDb();
  print(db['K2238']);
  // bacon 1003
  // chorizo 2238
  // fläsklägg 984
  // kaffegrädde 1714
  // kalvlever 1441
  // kokhöna 1161
  // kycklinghjärta 1452
  // kycklinglever 1453
  // köttfärs 963
  // lammhjärta 1435
  // makrill 1279
  // mozarella
  // märgben 956
  // nötstek 950
  // pasta 2226
  // pollock 4615
  // räkor 1395 # OBS! Hälften går bort som skal
  // torsk 1246
  // ägg 1225

  //print f 'K1003 100|K984 500' # bacon fläsklägg
  //print f 'K1453 250|K963 300|K1714 125|K2226 50|K1003 125' # kycklinglever köttfärs kaffegrädde pasta bacon
  return print(f('K963 300|K2226 50|K1395 100|K2238 180')); // köttfärs pasta räkor chorizo
};

//print f 'K2238 100'
//# sourceMappingURL=sketch.js.map
