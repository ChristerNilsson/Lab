{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "SIZES = [0,128,96,80,64]\r\nCOLORS = '0 F00 0F0 FF0 0FF F0F FFF 08F 0F8 800 808 80F 00F 080'.split ' '\r\n\r\nts = null\r\nboard = null\r\n\r\nmove = (lst)->\r\n\tlst = (item for item in lst when item>0)\r\n\tfor i in range lst.length-1 \r\n\t\tif lst[i] == lst[i+1] then [lst[i], lst[i+1]] = [lst[i]+1, 0]\t\r\n\tlst = (item for item in lst when item>0)\r\n\tlst.unshift 0 for i in range 4 - lst.length\t\t\r\n\tlst\r\n\r\nclass Board\r\n\tconstructor : ->\r\n\t\t@grid = (0 for i in range 16)\r\n\t\t@addTile 2\r\n\r\n\tmv : (indices) ->\r\n\t\tlst = move (@grid[index] for index in indices)\r\n\t\t@grid[index] = lst[i] for index,i in indices\r\n\r\n\taddTile : (n=1) ->\r\n\t\tcands = (index for tile,index in @grid when tile==0)\r\n\t\t@grid[index] = 1 for index in _.sample cands,n\r\n\t\t\t\t\t\t\r\n\tmove : (m) -> \r\n\t\toriginal = @grid.slice()\r\n\t\tif m not in [0,1,2,3] then return \r\n\t\t@mv t for t in ts[m]\r\n\t\tif not _.isEqual @grid,original then @addTile() \r\n\r\n\tdraw : ->\r\n\t\tfor cell,i in @grid\r\n\t\t\tx = 100 + 200*(i%%4)\r\n\t\t\ty = 100 + 200*(i//4)\r\n\t\t\tfill \"##{COLORS[cell]}\"\r\n\t\t\trect x,y,180,180,4\r\n\t\t\tvalue = 2**cell\r\n\t\t\ttextSize SIZES[value.toString().length]\r\n\t\t\tfill 0\r\n\t\t\tif cell > 0 then text value,x,y+3\r\n\r\nmake = (lst,d) ->\titem+d*i for item,k in lst for i in range 4\r\n\r\nsetup = ->\r\n\tcreateCanvas 801,801\r\n\ttextAlign CENTER,CENTER\r\n\trectMode CENTER\r\n\tboard = new Board()\r\n\tts = []\r\n\tts.push make [12,8,4,0], 1\r\n\tts.push make [0,1,2,3], 4 \r\n\tts.push make [0,4,8,12], 1 \r\n\tts.push make [3,2,1,0], 4 \r\ndraw = ->\r\n\tbg 0.5\r\n\tboard.draw()\r\n\r\nkeyPressed = -> board.move [UP_ARROW, RIGHT_ARROW, DOWN_ARROW, LEFT_ARROW].indexOf keyCode\r\n"
  ]
}