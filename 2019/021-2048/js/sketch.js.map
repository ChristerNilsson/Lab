{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "move = (lst)->\r\n\tres = lst\r\n\ti = res.length-1\r\n\twhile i>=0\r\n\t\tif res[i]==0 then res.splice i,1 else i--\r\n\ti = res.length-1\r\n\twhile i > 0\r\n\t\tif res[i] == res[i-1] \r\n\t\t\tvalue = res[i] + 1\r\n\t\t\tres.splice i,1 \r\n\t\t\tres[i-1] = value\r\n\t\ti--\r\n\tres.unshift 0 for i in range 4 - res.length\t\t\r\n\tres\r\nassert [0,0,0,2], move [1,0,0,1]\r\nassert [0,0,2,1], move [0,2,0,1]\r\nassert [1,2,3,4], move [1,2,3,4]\r\nassert [0,1,3,1], move [1,2,2,1]\r\nassert [0,0,2,2], move [1,1,1,1]\r\n\r\nclass Board\r\n\tconstructor : ->\r\n\t\t@grid = (0 for i in range 16)\r\n\t\t@grid[index]=1 for index in _.sample range(16),2\t\t\t\r\n\r\n\tmv : (indices) ->\r\n\t\tlst = (@grid[index] for index in indices)\r\n\t\tlst = move lst\r\n\t\t@grid[index]=lst[i] for index,i in indices\r\n\r\n\taddTile : (lst) ->\r\n\t\tcands = (index for index in lst when @grid[index]==0)\r\n\t\tif cands.length == 0 then return false\t\r\n\t\tindex = _.sample cands\r\n\t\t@grid[index]=1\r\n\t\ttrue\r\n\r\n\tmake : (lst,d) ->\titem+d*i for item,k in lst for i in range 4\r\n\t\t\t\r\n\tmove : (m) -> \r\n\t\tif m not in [0,1,2,3] then return \r\n\t\tts = []\r\n\t\tts.push @make [12,8,4,0], 1\r\n\t\tts.push @make [0,1,2,3], 4 \r\n\t\tts.push @make [0,4,8,12], 1 \r\n\t\tts.push @make [3,2,1,0], 4 \r\n\t\tlst = ts[m]\r\n\t\t@mv t for t in lst\r\n\t\t@addTile (t[0] for t in lst)\r\n\r\n\tdraw : ->\r\n\t\ttextSize 64\r\n\t\ttextAlign CENTER,CENTER\r\n\t\trectMode CENTER\r\n\t\tfor cell,i in @grid\r\n\t\t\tx = 100 + 200*(i%%4)\r\n\t\t\ty = 100 + 200*(i//4)\r\n\t\t\tfc 1,1,cell*0.1\r\n\t\t\trect x,y,180,180,4\r\n\t\t\tfc if cell<5 then 0 else 0\r\n\t\t\tif cell != 0 then text 2**cell,x,y+3\r\n\r\nboard = null\r\n\r\nsetup = ->\r\n\tcreateCanvas 801,801\r\n\tboard = new Board()\r\n\r\ndraw = ->\r\n\tbg 0.5\r\n\tboard.draw()\r\n\r\nkeyPressed = -> board.move [UP_ARROW, RIGHT_ARROW, DOWN_ARROW, LEFT_ARROW].indexOf keyCode\r\n"
  ]
}