// Generated by CoffeeScript 2.4.1
var TestShortcut, i, j, len, ref, script, start, tester,
  splice = [].splice;

TestShortcut = class TestShortcut extends TestReducer {
  constructor() {
    super();
    this.reducers = {
      ADD: (state) => {
        return this.op(state, state.a + 2);
      },
      MUL: (state) => {
        return this.op(state, state.a * 2);
      },
      DIV: (state) => {
        return this.op(state, state.a / 2);
      },
      NEW: (state) => {
        return {
          b: this.stack.pop(),
          a: this.stack.pop(),
          hist: []
        };
      },
      UNDO: (state) => {
        var a, hist, ref;
        ref = state.hist, [...hist] = ref, [a] = splice.call(hist, -1);
        return {...state, a, hist};
      }
    };
  }

  op(state, value) {
    var a, hist;
    hist = [...state.hist, state.a];
    a = value;
    return {...state, a, hist};
  }

};

script = "{\"a\":17,\"b\":1,\"hist\":[]}\n	A 17 B 1 \n	ADD \n		STATE {\"a\":19,\"b\":1,\"hist\":[17]}\n		A 19\n		B 1\n		HIST [17]\n		A 19 B 1\n		A 19 B 1 HIST [17]\n	MUL STATE {\"a\":34,\"b\":1,\"hist\":[17]}\n		ADD STATE {\"a\":36,\"b\":1,\"hist\":[17,34]}\n			UNDO STATE {\"a\":34,\"b\":1,\"hist\":[17]}\n	MUL ADD DIV A 18\n		17 1 NEW STATE {\"a\":17,\"b\":1,\"hist\":[]}\n{\"a\":9,\"b\":8,\"hist\":[18]}\n	A 9 B 8";

tester = new TestShortcut();

start = new Date();

ref = range(10000);
for (j = 0, len = ref.length; j < len; j++) {
  i = ref[j];
  tester.run(script);
}

console.log(new Date() - start);

console.log('Ready!');

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsWUFBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxNQUFBLEVBQUEsS0FBQSxFQUFBLE1BQUE7RUFBQTs7QUFBTSxlQUFOLE1BQUEsYUFBQSxRQUEyQixZQUEzQjtFQUNDLFdBQWMsQ0FBQSxDQUFBO1NBQ2IsQ0FBQTtJQUVBLElBQUMsQ0FBQSxRQUFELEdBQ0M7TUFBQSxHQUFBLEVBQUssQ0FBQyxLQUFELENBQUEsR0FBQTtlQUFXLElBQUMsQ0FBQSxFQUFELENBQUksS0FBSixFQUFXLEtBQUssQ0FBQyxDQUFOLEdBQVEsQ0FBbkI7TUFBWCxDQUFMO01BQ0EsR0FBQSxFQUFLLENBQUMsS0FBRCxDQUFBLEdBQUE7ZUFBVyxJQUFDLENBQUEsRUFBRCxDQUFJLEtBQUosRUFBVyxLQUFLLENBQUMsQ0FBTixHQUFRLENBQW5CO01BQVgsQ0FETDtNQUVBLEdBQUEsRUFBSyxDQUFDLEtBQUQsQ0FBQSxHQUFBO2VBQVcsSUFBQyxDQUFBLEVBQUQsQ0FBSSxLQUFKLEVBQVcsS0FBSyxDQUFDLENBQU4sR0FBUSxDQUFuQjtNQUFYLENBRkw7TUFHQSxHQUFBLEVBQUssQ0FBQyxLQUFELENBQUEsR0FBQTtlQUFXO1VBQUMsQ0FBQSxFQUFFLElBQUMsQ0FBQSxLQUFLLENBQUMsR0FBUCxDQUFBLENBQUg7VUFBaUIsQ0FBQSxFQUFFLElBQUMsQ0FBQSxLQUFLLENBQUMsR0FBUCxDQUFBLENBQW5CO1VBQWlDLElBQUEsRUFBSztRQUF0QztNQUFYLENBSEw7TUFJQSxJQUFBLEVBQUssQ0FBQyxLQUFELENBQUEsR0FBQTtBQUNKLFlBQUEsQ0FBQSxFQUFBLElBQUEsRUFBQTtRQUFBLE1BQWMsS0FBSyxDQUFDLElBQXBCLEdBQUMsR0FBRyxXQUFKLEdBQVMsaUJBQUw7ZUFDSixDQUFDLEdBQUcsS0FBSixFQUFXLENBQVgsRUFBYyxJQUFkO01BRkk7SUFKTDtFQUpZOztFQVlkLEVBQUssQ0FBQyxLQUFELEVBQVEsS0FBUixDQUFBO0FBQ0osUUFBQSxDQUFBLEVBQUE7SUFBQSxJQUFBLEdBQU8sQ0FBQyxHQUFHLEtBQUssQ0FBQyxJQUFWLEVBQWdCLEtBQUssQ0FBQyxDQUF0QjtJQUNQLENBQUEsR0FBSTtXQUNKLENBQUMsR0FBRyxLQUFKLEVBQVcsQ0FBWCxFQUFjLElBQWQ7RUFISTs7QUFiTjs7QUFrQkEsTUFBQSxHQUFTOztBQWtCVCxNQUFBLEdBQVMsSUFBSSxZQUFKLENBQUE7O0FBQ1QsS0FBQSxHQUFRLElBQUksSUFBSixDQUFBOztBQUNSO0FBQUEsS0FBQSxxQ0FBQTs7RUFDQyxNQUFNLENBQUMsR0FBUCxDQUFXLE1BQVg7QUFERDs7QUFFQSxPQUFPLENBQUMsR0FBUixDQUFZLElBQUksSUFBSixDQUFBLENBQUEsR0FBVyxLQUF2Qjs7QUFDQSxPQUFPLENBQUMsR0FBUixDQUFZLFFBQVoiLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBUZXN0U2hvcnRjdXQgZXh0ZW5kcyBUZXN0UmVkdWNlclxyXG5cdGNvbnN0cnVjdG9yIDogKCkgLT5cclxuXHRcdHN1cGVyKClcclxuXHJcblx0XHRAcmVkdWNlcnMgPVxyXG5cdFx0XHRBREQ6IChzdGF0ZSkgPT4gQG9wIHN0YXRlLCBzdGF0ZS5hKzJcclxuXHRcdFx0TVVMOiAoc3RhdGUpID0+IEBvcCBzdGF0ZSwgc3RhdGUuYSoyXHJcblx0XHRcdERJVjogKHN0YXRlKSA9PiBAb3Agc3RhdGUsIHN0YXRlLmEvMlxyXG5cdFx0XHRORVc6IChzdGF0ZSkgPT4ge2I6QHN0YWNrLnBvcCgpLCBhOkBzdGFjay5wb3AoKSwgaGlzdDpbXX1cclxuXHRcdFx0VU5ETzooc3RhdGUpID0+XHJcblx0XHRcdFx0Wy4uLmhpc3QsYV0gPSBzdGF0ZS5oaXN0XHJcblx0XHRcdFx0ey4uLnN0YXRlLCBhLCBoaXN0fVx0XHJcblxyXG5cdG9wIDogKHN0YXRlLCB2YWx1ZSkgLT5cclxuXHRcdGhpc3QgPSBbLi4uc3RhdGUuaGlzdCwgc3RhdGUuYV1cclxuXHRcdGEgPSB2YWx1ZVxyXG5cdFx0ey4uLnN0YXRlLCBhLCBoaXN0fVxyXG5cclxuc2NyaXB0ID0gXCJcIlwiXHJcbntcImFcIjoxNyxcImJcIjoxLFwiaGlzdFwiOltdfVxyXG5cdEEgMTcgQiAxIFxyXG5cdEFERCBcclxuXHRcdFNUQVRFIHtcImFcIjoxOSxcImJcIjoxLFwiaGlzdFwiOlsxN119XHJcblx0XHRBIDE5XHJcblx0XHRCIDFcclxuXHRcdEhJU1QgWzE3XVxyXG5cdFx0QSAxOSBCIDFcclxuXHRcdEEgMTkgQiAxIEhJU1QgWzE3XVxyXG5cdE1VTCBTVEFURSB7XCJhXCI6MzQsXCJiXCI6MSxcImhpc3RcIjpbMTddfVxyXG5cdFx0QUREIFNUQVRFIHtcImFcIjozNixcImJcIjoxLFwiaGlzdFwiOlsxNywzNF19XHJcblx0XHRcdFVORE8gU1RBVEUge1wiYVwiOjM0LFwiYlwiOjEsXCJoaXN0XCI6WzE3XX1cclxuXHRNVUwgQUREIERJViBBIDE4XHJcblx0XHQxNyAxIE5FVyBTVEFURSB7XCJhXCI6MTcsXCJiXCI6MSxcImhpc3RcIjpbXX1cclxue1wiYVwiOjksXCJiXCI6OCxcImhpc3RcIjpbMThdfVxyXG5cdEEgOSBCIDhcclxuXCJcIlwiXHJcbnRlc3RlciA9IG5ldyBUZXN0U2hvcnRjdXQoKVxyXG5zdGFydCA9IG5ldyBEYXRlKClcclxuZm9yIGkgaW4gcmFuZ2UgMTAwMDBcclxuXHR0ZXN0ZXIucnVuIHNjcmlwdFxyXG5jb25zb2xlLmxvZyBuZXcgRGF0ZSgpLXN0YXJ0XHJcbmNvbnNvbGUubG9nICdSZWFkeSEnIl19
//# sourceURL=c:\Lab\2019\110-ActionStateTreeTesting\coffee\sketch.coffee