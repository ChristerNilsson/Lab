// Generated by CoffeeScript 2.4.1
var mystack, op, reducers, script, tester,
  splice = [].splice;

mystack = [];

reducers = {
  ADD: function(state) {
    return op(state, state.a + 2);
  },
  MUL: function(state) {
    return op(state, state.a * 2);
  },
  DIV: function(state) {
    return op(state, state.a / 2);
  },
  NEW: function(state) {
    return {
      b: mystack.pop(),
      a: mystack.pop(),
      hist: []
    };
  },
  UNDO: function(state) {
    var a, hist, ref;
    ref = state.hist, [...hist] = ref, [a] = splice.call(hist, -1);
    return {...state, a, hist};
  }
};

op = function(state, value) {
  var a, hist;
  hist = [...state.hist, state.a];
  a = value;
  return {...state, a, hist};
};

script = "{\"a\":17,\"b\":1,\"hist\":[]}\n	A 17 B 1 \n	ADD \n		STATE {\"a\":19,\"b\":1,\"hist\":[17]}\n		A 19\n		B 1\n		HIST [17]\n		A 19 B 1\n		A 19 B 1 HIST [17]\n	MUL STATE {\"a\":34,\"b\":1,\"hist\":[17]}\n		ADD STATE {\"a\":36,\"b\":1,\"hist\":[17,34]}\n			UNDO STATE {\"a\":34,\"b\":1,\"hist\":[17]}\n	MUL ADD DIV A 18\n		17 1 NEW STATE {\"a\":17,\"b\":1,\"hist\":[]}\n{\"a\":9,\"b\":8,\"hist\":[18]}\n	A 9 B 8";

tester = testReducer(script, reducers, mystack);

tester.run();

console.log('Ready!');

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsT0FBQSxFQUFBLEVBQUEsRUFBQSxRQUFBLEVBQUEsTUFBQSxFQUFBLE1BQUE7RUFBQTs7QUFBQSxPQUFBLEdBQVU7O0FBRVYsUUFBQSxHQUNDO0VBQUEsR0FBQSxFQUFLLFFBQUEsQ0FBQyxLQUFELENBQUE7V0FBVyxFQUFBLENBQUcsS0FBSCxFQUFVLEtBQUssQ0FBQyxDQUFOLEdBQVEsQ0FBbEI7RUFBWCxDQUFMO0VBQ0EsR0FBQSxFQUFLLFFBQUEsQ0FBQyxLQUFELENBQUE7V0FBVyxFQUFBLENBQUcsS0FBSCxFQUFVLEtBQUssQ0FBQyxDQUFOLEdBQVEsQ0FBbEI7RUFBWCxDQURMO0VBRUEsR0FBQSxFQUFLLFFBQUEsQ0FBQyxLQUFELENBQUE7V0FBVyxFQUFBLENBQUcsS0FBSCxFQUFVLEtBQUssQ0FBQyxDQUFOLEdBQVEsQ0FBbEI7RUFBWCxDQUZMO0VBR0EsR0FBQSxFQUFLLFFBQUEsQ0FBQyxLQUFELENBQUE7V0FBVztNQUFDLENBQUEsRUFBRSxPQUFPLENBQUMsR0FBUixDQUFBLENBQUg7TUFBa0IsQ0FBQSxFQUFFLE9BQU8sQ0FBQyxHQUFSLENBQUEsQ0FBcEI7TUFBbUMsSUFBQSxFQUFLO0lBQXhDO0VBQVgsQ0FITDtFQUlBLElBQUEsRUFBSyxRQUFBLENBQUMsS0FBRCxDQUFBO0FBQ0osUUFBQSxDQUFBLEVBQUEsSUFBQSxFQUFBO0lBQUEsTUFBYyxLQUFLLENBQUMsSUFBcEIsR0FBQyxHQUFHLFdBQUosR0FBUyxpQkFBTDtXQUNKLENBQUMsR0FBRyxLQUFKLEVBQVcsQ0FBWCxFQUFjLElBQWQ7RUFGSTtBQUpMOztBQVFELEVBQUEsR0FBSyxRQUFBLENBQUMsS0FBRCxFQUFRLEtBQVIsQ0FBQTtBQUNKLE1BQUEsQ0FBQSxFQUFBO0VBQUEsSUFBQSxHQUFPLENBQUMsR0FBRyxLQUFLLENBQUMsSUFBVixFQUFnQixLQUFLLENBQUMsQ0FBdEI7RUFDUCxDQUFBLEdBQUk7U0FDSixDQUFDLEdBQUcsS0FBSixFQUFXLENBQVgsRUFBYyxJQUFkO0FBSEk7O0FBS0wsTUFBQSxHQUFTOztBQW1CVCxNQUFBLEdBQVMsV0FBQSxDQUFZLE1BQVosRUFBbUIsUUFBbkIsRUFBNEIsT0FBNUI7O0FBQ1QsTUFBTSxDQUFDLEdBQVAsQ0FBQTs7QUFFQSxPQUFPLENBQUMsR0FBUixDQUFZLFFBQVoiLCJzb3VyY2VzQ29udGVudCI6WyJteXN0YWNrID0gW11cclxuXHJcbnJlZHVjZXJzID0gXHJcblx0QUREOiAoc3RhdGUpIC0+IG9wIHN0YXRlLCBzdGF0ZS5hKzJcclxuXHRNVUw6IChzdGF0ZSkgLT4gb3Agc3RhdGUsIHN0YXRlLmEqMlxyXG5cdERJVjogKHN0YXRlKSAtPiBvcCBzdGF0ZSwgc3RhdGUuYS8yXHJcblx0TkVXOiAoc3RhdGUpIC0+IHtiOm15c3RhY2sucG9wKCksIGE6bXlzdGFjay5wb3AoKSwgaGlzdDpbXX1cclxuXHRVTkRPOihzdGF0ZSkgLT5cclxuXHRcdFsuLi5oaXN0LGFdID0gc3RhdGUuaGlzdFxyXG5cdFx0ey4uLnN0YXRlLCBhLCBoaXN0fVxyXG5cclxub3AgPSAoc3RhdGUsIHZhbHVlKSAtPlxyXG5cdGhpc3QgPSBbLi4uc3RhdGUuaGlzdCwgc3RhdGUuYV1cclxuXHRhID0gdmFsdWVcclxuXHR7Li4uc3RhdGUsIGEsIGhpc3R9XHJcblxyXG5zY3JpcHQgPSBcIlwiXCJcclxue1wiYVwiOjE3LFwiYlwiOjEsXCJoaXN0XCI6W119XHJcblx0QSAxNyBCIDEgXHJcblx0QUREIFxyXG5cdFx0U1RBVEUge1wiYVwiOjE5LFwiYlwiOjEsXCJoaXN0XCI6WzE3XX1cclxuXHRcdEEgMTlcclxuXHRcdEIgMVxyXG5cdFx0SElTVCBbMTddXHJcblx0XHRBIDE5IEIgMVxyXG5cdFx0QSAxOSBCIDEgSElTVCBbMTddXHJcblx0TVVMIFNUQVRFIHtcImFcIjozNCxcImJcIjoxLFwiaGlzdFwiOlsxN119XHJcblx0XHRBREQgU1RBVEUge1wiYVwiOjM2LFwiYlwiOjEsXCJoaXN0XCI6WzE3LDM0XX1cclxuXHRcdFx0VU5ETyBTVEFURSB7XCJhXCI6MzQsXCJiXCI6MSxcImhpc3RcIjpbMTddfVxyXG5cdE1VTCBBREQgRElWIEEgMThcclxuXHRcdDE3IDEgTkVXIFNUQVRFIHtcImFcIjoxNyxcImJcIjoxLFwiaGlzdFwiOltdfVxyXG57XCJhXCI6OSxcImJcIjo4LFwiaGlzdFwiOlsxOF19XHJcblx0QSA5IEIgOFxyXG5cIlwiXCJcclxuXHJcbnRlc3RlciA9IHRlc3RSZWR1Y2VyIHNjcmlwdCxyZWR1Y2VycyxteXN0YWNrXHJcbnRlc3Rlci5ydW4oKVxyXG5cclxuY29uc29sZS5sb2cgJ1JlYWR5ISciXX0=
//# sourceURL=c:\Lab\2019\110-ActionStateTreeTesting\coffee\sketch.coffee