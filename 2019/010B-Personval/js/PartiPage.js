'use strict';

// Generated by CoffeeScript 2.3.2
var PartiButton, PartiPage;

PartiPage = function () {
  var N;

  class PartiPage extends Page {
    render() {
      return this.bg(0);
    }

    select(rlk, partier) {
      var h, i, j, len, partikod, partikoder, results, w, x, y;
      w = this.w / 2;
      h = this.h / (N + 1);
      partikoder = _.keys(partier);
      partikoder.sort(function (a, b) {
        return _.size(partier[b]) - _.size(partier[a]);
      });
      this.buttons = [];
      pages.partier.clear();
      pages.letters.clear();
      pages.personer.clear();
      results = [];
      for (i = j = 0, len = partikoder.length; j < len; i = ++j) {
        partikod = partikoder[i];
        x = this.x + w * Math.floor(i / N);
        y = this.y + h * (1 + i % N);
        print(partikod);
        results.push((partikod => {
          return this.addButton(new PartiButton(rlk, partikod, x, y, w - 2, h - 2, function () {
            this.page.selected = this;
            if (PERSONS_PER_PAGE < _.size(partier[partikod])) {
              pages.letters.makeLetters(rlk, this, partikod, partier[partikod]);
              pages.personer.buttons = [];
            } else {
              pages.letters.buttons = [];
              pages.personer.makePersons(rlk, this, partikod, partier[partikod]);
            }
            pages.rlk.clickPartiButton(this);
            return pages.personer.personer = partier[partikod];
          }));
        })(partikod));
      }
      return results;
    }

  };

  N = 16;

  return PartiPage;
}.call(undefined);

PartiButton = class PartiButton extends Button {
  constructor(rlk1, partikod1, x, y, w, h, click = function () {}) {
    super('', x, y, w, h, click);
    this.rlk = rlk1;
    this.partikod = partikod1;
  }

  draw() {
    var partinamn;
    fc(0.5);
    rect(this.x, this.y, this.w, this.h);
    textSize(this.ts);
    textAlign(CENTER, CENTER);
    if (this.page.selected === this) {
      fc(1, 1, 0);
    } else {
      fc(1);
    }
    partinamn = dbPartier[this.rlk][this.partikod][PARTI_FÃ–RKORTNING];
    if (partinamn === '') {
      partinamn = dbPartier[this.rlk][this.partikod][PARTI_BETECKNING];
    }
    return text(partinamn, this.x + this.w / 2, this.y + this.h / 2);
  }

};
//# sourceMappingURL=PartiPage.js.map
