'use strict';

// Generated by CoffeeScript 2.3.2
var KommunButton, KommunPage;

KommunPage = function () {
  var COLS, N;

  class KommunPage extends Page {
    constructor(x, y, w, h) {
      super(x, y, w, h);
      this.grupper = gruppera(_.values(dbKommun), N * COLS);
      this.init();
    }

    init(index = 0) {
      var first, h, i, j, k, key, keys, last, len, len1, letters, namn, ref, ref1, title, w, ww, x, y;
      this.buttons = [];
      ww = this.w / (COLS + 1);
      w = ww; ///2
      h = this.h / N;
      keys = _.keys(dbKommun);
      keys.sort(function (a, b) {
        if (dbKommun[a] < dbKommun[b]) {
          return -1;
        } else {
          return 1;
        }
      });
      ref = _.keys(this.grupper);
      for (i = j = 0, len = ref.length; j < len; i = ++j) {
        key = ref[i];
        first = key[0];
        last = _.last(key);
        if (i === index) {
          letters = `${first}${last}`;
        }
        title = first === last ? first : title = `${first}-${last}`;
        (i => {
          return this.addButton(new Button(title, this.x, this.y + i * h, w - 1, h - 1, function () {
            return this.page.init(i);
          }));
        })(i);
      }
      this.addButton(new Button('Avbryt', this.x, this.y + (N - 1) * h, w - 1, h - 1, function () {
        return pageStack.pop();
      }));
      i = 0;
      for (k = 0, len1 = keys.length; k < len1; k++) {
        key = keys[k];
        namn = dbKommun[key];
        if (letters[0] <= (ref1 = namn[0]) && ref1 <= letters[1]) {
          x = w + Math.floor(i % (COLS * N) / N) * ww;
          y = i % N * h;
          this.addButton(new KommunButton(key, this.x + x, this.y + y, ww - 1, h - 1, function () {
            rensa();
            fetchKommun(this.key);
            return pageStack.pop();
          }));
          i++;
        }
      }
      return this.selected = this.buttons[index];
    }

    render() {
      this.bg(0);
      push();
      sc(1, 1, 1);
      sw(1);
      rect(this.x, this.y, this.w, this.h);
      return pop();
    }

  };

  N = 10;

  COLS = 5;

  return KommunPage;
}.call(undefined);

KommunButton = class KommunButton extends Button {
  constructor(key, x, y, w, h, click = function () {}) {
    super(dbKommun[key], x, y, w, h, click);
    this.key = key;
  }

  draw() {
    fc(0.5);
    push();
    sc();
    rect(this.x, this.y, this.w, this.h);
    pop();
    textSize(0.65 * this.ts);
    textAlign(LEFT, CENTER);
    if (this.page.selected === this) {
      fc(1, 1, 0);
    } else {
      fc(1);
    }
    return text(this.title, this.x + 0.025 * this.w, this.y + this.h / 2);
  }

};
//# sourceMappingURL=KommunPage.js.map
