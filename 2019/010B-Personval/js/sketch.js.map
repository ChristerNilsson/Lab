{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# Beskrivning av kolumner i kandidaturer.js:\r\nVALTYP = 0\r\nVALOMRÅDESKOD = 1\r\nVALOMRÅDESNAMN = 2\r\nVALKRETSKOD = 3\r\nVALKRETSNAMN = 4\r\nPARTIBETECKNING = 5\r\nPARTIFÖRKORTNING = 6\r\nPARTIKOD = 7\r\nVALSEDELSSTATUS = 8\r\nLISTNUMMER = 9\r\nORDNING = 10\r\nANMKAND = 11\r\nANMDELTAGANDE = 12\r\nSAMTYCKE = 13\r\nFÖRKLARING = 14\r\nKANDIDATNUMMER = 15\r\nNAMN = 16\r\nÅLDER_PÅ_VALDAGEN = 17\r\nKÖN = 18\r\nFOLKBOKFÖRINGSORT = 19\r\nVALSEDELSUPPGIFT = 20\r\nANT_BEST_VALS = 21\r\nVALBAR_PÅ_VALDAGEN = 22\r\nGILTIG = 23\r\n\r\nPERSONS_PER_PAGE = 32\r\nVOTES = 5\r\n\r\nkommunkod = null\r\nlänskod = null\r\n\r\ntree = {}\r\n\r\ndictionary = {} \r\n\t# S -> Socialdemokraterna\r\n\t# 01 -> Stockholms läns landsting\r\n\t# 0180 -> Stockholm\r\n\r\npages = {}\r\n\r\ngruppera = (letters,n=32) ->\r\n\tres = {}\r\n\tgroup = ''\r\n\tcount = 0\r\n\tfor letter,m of letters\r\n\t\tif count + m <= n\r\n\t\t\tgroup += letter\r\n\t\t\tcount += m\r\n\t\telse\r\n\t\t\tif count > 0 then res[group] = count\r\n\t\t\tgroup = letter\r\n\t\t\tcount = m\r\n\tif count > 0 then res[group] = count\r\n\tres\r\nassert {AB:25,C:14,D:57}, gruppera {A:12, B:13, C:14, D:57}\r\nassert {ABDEF:28, GH:25}, gruppera {A:2, B:1, D:3,E:10,F:12,G:13,H:12}\r\nassert {ABDEF:28, NO:32}, gruppera {A:2, B:1, D:3,E:10,F:12,N:20,O:12}\r\n\r\nclass Page\r\n\tconstructor : (@x,@y,@w,@h,@cols=1) ->\r\n\t\t@selected = null # anger vilken knapp man klickat på\r\n\t\t@buttons  = [] \r\n\t\t@active = true\r\n\r\n\tclear : ->\r\n\t\t@selected = null\r\n\t\t@buttons = []\r\n\r\n\taddButton : (button) -> \r\n\t\tbutton.page = @\r\n\t\t@buttons.push button\r\n\r\n\tdraw : ->\r\n\t\tif @active \r\n\t\t\t@render()\r\n\t\t\tfor button in @buttons\r\n\t\t\t\tbutton.draw()\r\n\r\n\tmousePressed : ->\r\n\t\tif @active \r\n\t\t\tfor button in @buttons\r\n\t\t\t\tif button.inside mouseX,mouseY then button.click()\r\n\r\nclass PartiPage extends Page\r\n\trender : ->\r\n\t\tif @selected != null\r\n\t\t\tpush()\r\n\t\t\ttextAlign CENTER,CENTER\r\n\t\t\ttextSize 20 # 0.5 * pages.personer.h/17\r\n\t\t\ts = \"#{dictionary[@selected.title][0]} (#{pages.personer.buttons.length} av #{_.size pages.personer.personer})\"\r\n\t\t\ttext s, pages.personer.x + pages.personer.w/2, pages.personer.y + pages.personer.h/34\r\n\t\t\tpop()\r\n\r\n\tselect : (partier) ->\r\n\t\tN = 16\r\n\t\tw = @w/2\r\n\t\th = @h/(N+1)\r\n\t\tkeys = _.keys partier\r\n\t\tkeys.sort (a,b) -> _.size(partier[b]) - _.size(partier[a])\r\n\t\t@buttons = []\r\n\r\n\t\tpages.partier.clear()\r\n\t\tpages.letters.clear()\r\n\t\tpages.personer.clear()\r\n\r\n\t\tfor key,i in keys\r\n\t\t\tx = @x + w*(i//N)\r\n\t\t\ty = @y + h*(1+i%N)\r\n\t\t\tdo (key) => @addButton new PartiButton key,x,y,w-2,h-2, -> \r\n\t\t\t\t@page.selected = @\r\n\t\t\t\tif PERSONS_PER_PAGE < _.size partier[key]\r\n\t\t\t\t\tpages.letters.makeLetters @, partier[key]\r\n\t\t\t\t\tpages.personer.buttons = []\r\n\t\t\t\telse\r\n\t\t\t\t\tpages.letters.buttons = []\r\n\t\t\t\t\tpages.personer.makePersons @, partier[key]\r\n\t\t\t\tpages.typ.clickPartiButton @\t\r\n\t\t\t\tpages.personer.personer = partier[key]\t\t\t\r\n\r\nclass LetterPage extends Page\r\n\trender : ->\r\n\r\n\tmakeFreq : (personer) ->\r\n\t\tres = {}\r\n\t\tkeys = (person[NAMN] for key,person of personer)\r\n\t\tkeys.sort()\r\n\t\tfor key in keys\r\n\t\t\tletter = key[0]\r\n\t\t\tres[letter] = if res[letter] == undefined then 1 else res[letter] + 1\r\n\t\tres\r\n\r\n\tmakeLetters : (button, personer) ->\r\n\t\tN = 16\r\n\t\th = @h/(N+1)\r\n\t\tw = @w/2\r\n\t\t@selected = button \r\n\t\t@buttons = []\r\n\r\n\t\ti = 0\r\n\t\tfor letters,n of gruppera @makeFreq personer\r\n\t\t\tx = @x + w*(i//N)\r\n\t\t\ty = @y + h*(1+i%N)\r\n\t\t\ttitle = if letters.length == 1 then letters else \"#{letters[0]}-#{_.last letters}\"\r\n\t\t\tdo (letters,title) => @addButton new LetterButton title,x,y,w-2,h-2,n, -> \r\n\t\t\t\t@page.selected = @\r\n\t\t\t\tpages.personer.clickLetterButton @, letters, personer\r\n\t\t\ti++\r\n\r\nclass PersonPage extends Page\r\n\r\n\trender : ->\r\n\r\n\tclickLetterButton : (button,letters,personer) ->\r\n\t\t@personer = personer\r\n\t\tN = PERSONS_PER_PAGE\r\n\t\tw = 0.36 * width\r\n\t\th = height/(PERSONS_PER_PAGE+2)\r\n\t\t@selected = button\r\n\t\tbutton.pageNo = (button.pageNo + 1) % button.pages\r\n\t\t@buttons = []\r\n\t\tkeys = _.keys personer \r\n\t\tkeys.sort (a,b) -> if a.slice(a.indexOf('-')) < b.slice(b.indexOf('-')) then -1 else 1\r\n\t\tj = 0\r\n\t\tfor key in keys\r\n\t\t\tperson = personer[key]\r\n\t\t\tif person[NAMN][0] in letters\r\n\t\t\t\tif j // N == button.pageNo\r\n\t\t\t\t\tx = j//(N//2) * w/2\r\n\t\t\t\t\tx = x % w\r\n\t\t\t\t\ty = 2*h*(1+j%(N//2))\r\n\t\t\t\t\tdo (person) => @addButton new PersonButton person,@x+x,@y+y,w/2-2,2*h-2, -> \r\n\t\t\t\t\t\t@page.selected = @\r\n\t\t\t\t\t\tpages.typ.clickPersonButton person\r\n\t\t\t\tj++\r\n\r\n\tmakePersons : (button, personer) ->\r\n\t\t@personer = personer\r\n\t\tN = 16\r\n\t\tw = 0.36 * width \r\n\t\th = height/(PERSONS_PER_PAGE+2)\r\n\t\t@selected = button \r\n\t\t@buttons = []\r\n\r\n\t\tkeys = _.keys personer\r\n\t\tkeys.sort (a,b) -> if a.slice(a.indexOf('-')) < b.slice(b.indexOf('-')) then -1 else 1\r\n\t\tfor key,j in keys\r\n\t\t\tperson = personer[key]\r\n\t\t\tx = j//N * w/2\r\n\t\t\tx = x % w\r\n\t\t\ty = 2*h*(1 + j%N)\r\n\t\t\tdo (person) => @addButton new PersonButton person,@x+x,@y+y,w/2-2,2*h-2, -> \r\n\t\t\t\t@page.selected = @\r\n\t\t\t\tpages.typ.clickPersonButton person\r\n\r\nclass TypPage extends Page\r\n\r\n\tconstructor : (x,y,w,h,cols=1) ->\r\n\t\tsuper x,y,w,h,cols\r\n\t\t@sbuttons = []\r\n\t\t@start = new Date().getTime()\r\n\t\t@qr= '0000000000'\r\n\r\n\t\th = height/51\r\n\t\t@yoff = [@y+0,@y+16*h,@y+32*h,@y+48*h]\r\n\r\n\t\t@selectedPersons = {R:[], L:[], K:[]}\r\n\r\n\t\t@addButton new TypButton 'R', 'Riksdag',             @x,@yoff[0],@w-0,3*h-3, -> \r\n\t\t\tpages.partier.select tree['R']\r\n\t\t\t@page.selected = @\r\n\r\n\t\t@addButton new TypButton 'L', dictionary[länskod],   @x,@yoff[1],@w-0,3*h-3, ->\r\n\t\t\tpages.partier.select tree['L']\r\n\t\t\t@page.selected = @\r\n\r\n\t\t@addButton new TypButton 'K', dictionary[kommunkod], @x,@yoff[2],@w-0,3*h-3, ->\r\n\t\t\tpages.partier.select tree['K']\r\n\t\t\t@page.selected = @\r\n\r\n\t\t@addButton new Button 'Utskrift',                    @x,@yoff[3],@w/2-2,3*h-3, ->\r\n\t\t\tpages.utskrift.active = true\r\n\t\t\tpages.utskrift.stopMeasuringTime()\r\n\r\n\t\t\t@page.qr = @page.getQR()\r\n\t\t\tqrcode = new QRCode document.getElementById(\"qrcode\"),\r\n\t\t\t\ttext: @page.qr\r\n\t\t\t\twidth: 256\r\n\t\t\t\theight: 256\r\n\t\t\t\tcolorDark : \"#000000\"\r\n\t\t\t\tcolorLight : \"#ffffff\"\r\n\t\t\t\tcorrectLevel : QRCode.CorrectLevel.L # Low Medium Q High\r\n\r\n\t\t@addButton new Button 'Rensa',                       @x+@w/2,@yoff[3],@w/2-0,3*h-3, -> \r\n\t\t\t@page.selectedPersons = {R:[], L:[], K:[]}\r\n\t\t\t@page.sbuttons = [] \r\n\r\n\t\t\tpages.typ.selected = null\r\n\t\t\tpages.partier.clear()\r\n\t\t\tpages.letters.clear()\r\n\t\t\tpages.personer.clear()\r\n\t\t\t@page.qr = ''\r\n\t\t\t@page.start = new Date().getTime()\r\n\r\n\taddsButton : (button) -> \r\n\t\tbutton.page = @\r\n\t\t@sbuttons.push button\r\n\r\n\tgetQR : ->\r\n\t\ts = kommunkod \r\n\t\tslump = int random 1000000\r\n\t\ts += slump.toString().padStart 6,0 # to increase probability of uniqueness \r\n\t\tfor typ of @selectedPersons\r\n\t\t\tpersons = @selectedPersons[typ]\r\n\t\t\tfor i in range VOTES\r\n\t\t\t\tif i < persons.length\r\n\t\t\t\t\tperson = persons[i]\r\n\t\t\t\t\ts += person[KANDIDATNUMMER].padStart 6,'0'\r\n\t\t\t\telse\r\n\t\t\t\t\ts += '000000'\r\n\t\tassert s.length,4+6+15*6 # 100\r\n\t\ts\r\n\r\n\trender : ->\r\n\t\tif @selected != null\r\n\t\t\tpush()\r\n\t\t\ttextAlign CENTER,CENTER\r\n\t\t\ttextSize 20\r\n\t\t\tsc()\r\n\t\t\t[x,y] = [pages.partier.x+pages.partier.w/2, pages.partier.y+pages.partier.h/34]\r\n\t\t\tif @selected.typ == 'R' then text 'Riksdag',            x,y\r\n\t\t\tif @selected.typ == 'L' then text dictionary[länskod],  x,y\r\n\t\t\tif @selected.typ == 'K' then text dictionary[kommunkod],x,y\r\n\t\t\tpop()\r\n\t\t@showSelectedPersons() # 750,100-20\r\n\r\n\tclickDelete : (typ,index) ->\r\n\t\t@selectedPersons[typ].splice index,1 \t\r\n\t\t@createSelectButtons()\r\n\r\n\tclickSwap : (typ,index) ->\r\n\t\tarr = @selectedPersons[typ]\r\n\t\t[arr[index],arr[index-1]] = [arr[index-1],arr[index]]\r\n\t\t@createSelectButtons()\r\n\r\n\tcreateSelectButtons : ->\r\n\t\t@sbuttons = []\r\n\t\tw = @w\r\n\t\tdw = 0.02 * width\r\n\t\tdh = 0.025 * height\r\n\t\th = height/51\r\n\r\n\t\tfor typ,persons of @selectedPersons\r\n\t\t\tindex = \"RLK\".indexOf typ\r\n\t\t\tfor person,i in persons\r\n\t\t\t\tx1 = @x + dw\r\n\t\t\t\tx2 = @x + 0.93 * @w\r\n\t\t\t\ty = @yoff[index] + 4.7*h + 13*h/5*i\r\n\t\t\t\ty1 = y - 2.3 * h\r\n\t\t\t\ty2 = y - 0.9 * h\r\n\t\t\t\tdo (typ,i) =>\r\n\t\t\t\t\tif i>0 then @addsButton new Button 'byt',x1, y1,dw,dh, => @clickSwap   typ,i\r\n\t\t\t\t\t@addsButton             new Button ' x ',x2, y2,dw,dh, => @clickDelete typ,i\r\n\r\n\tclickPersonButton : (person) ->\r\n\t\tpersons = @selectedPersons[@selected.typ]\r\n\t\t# Finns partiet redan? I så fall: ersätt denna person med den nya.\r\n\t\tfor p,i in persons \r\n\t\t\tif p[PARTIKOD] == person[PARTIKOD]\r\n\t\t\t\tpersons[i] = person\r\n\t\t\t\treturn \r\n\t\tif persons.length < VOTES\r\n\t\t\tpersons.push person \r\n\t\t\t@createSelectButtons()\r\n\r\n\tclickPartiButton : (button) ->\r\n\t\tpersons = @selectedPersons[@selected.typ]\r\n\t\t# Finns partiet redan? I så fall: ersätt denna person med den nya.\r\n\t\tperson = []\r\n\t\tperson[NAMN] = dictionary[button.title][0]\r\n\t\tperson[PARTIKOD] = dictionary[button.title][1]\r\n\t\tperson[PARTIFÖRKORTNING] = button.title\r\n\t\tperson[KANDIDATNUMMER] = '99' + person[PARTIKOD].padStart 4,'0'\t\r\n\r\n\t\tfor p,i in persons \r\n\t\t\tif p[PARTIKOD] == person[PARTIKOD]\r\n\t\t\t\tpersons[i] = person\r\n\t\t\t\treturn \r\n\t\tif persons.length < VOTES\r\n\t\t\tpersons.push person \r\n\t\t\t@createSelectButtons()\r\n\r\n\tsample : (hash,n) -> _.object ([key,hash[key]] for key in _.sample _.keys(hash),n)\r\n\r\n\tslumpa : ->\r\n\t\tfor rkl,partier of tree\r\n\t\t\t@selectedPersons[rkl] = []\r\n\t\t\tparties = @sample partier,5\r\n\t\t\tfor name,personer of parties\r\n\t\t\t\tif random() < 0.2 # Vote for a party\r\n\t\t\t\t\tperson = []\r\n\t\t\t\t\tperson[NAMN] = dictionary[name][0]\r\n\t\t\t\t\tperson[PARTIKOD] = dictionary[name][1]\r\n\t\t\t\t\tperson[PARTIFÖRKORTNING] = name\r\n\t\t\t\t\tperson[KANDIDATNUMMER] = '99' + person[PARTIKOD].padStart 4,'0'\t\r\n\t\t\t\telse # Vote for a person\r\n\t\t\t\t\tperson = _.sample personer\r\n\t\t\t\t@selectedPersons[rkl].push person\r\n\t\r\n\tshowSelectedPersons : ->\r\n\t\tpush()\r\n\t\ttextAlign LEFT,CENTER\r\n\t\ttextSize 0.025 * height\r\n\t\tfor typ,i in 'RLK'\r\n\t\t\tsc()\r\n\t\t\tsw 1 \r\n\t\t\trectMode CORNER\r\n\t\t\ty0 = @yoff[i]\r\n\t\t\tif i == 0 then fc 1,1,0.5\r\n\t\t\tif i == 1 then fc 0.5,0.75,1\r\n\t\t\tif i == 2 then fc 1\r\n\t\t\th = height/51\r\n\t\t\trect @x, y0+3*h-1, @w, 13*h-1\r\n\t\t\tfc 0\r\n\t\t\tsc()\r\n\t\t\tsw 0\r\n\t\t\t\r\n\t\t\tfor person,j in @selectedPersons[typ]\r\n\t\t\t\ty = y0 + 4.5*h + 13*h/5*j\r\n\t\t\t\ttext \"#{j+1}  #{person[PARTIFÖRKORTNING]} - #{person[NAMN]}\",@x+10,y\r\n\t\tpop()\r\n\r\n\t\tfor button in @sbuttons\r\n\t\t\tbutton.draw()\r\n\r\n\tmousePressed : ->\r\n\t\tfor button in @sbuttons\r\n\t\t\tif button.inside mouseX,mouseY then button.click()\r\n\t\tsuper()\r\n\r\nclass UtskriftPage extends Page\r\n\tconstructor : (x,y,w,h) ->\r\n\t\tsuper x,y,w,h\r\n\t\t@selected = null\r\n\t\t@buttons = []\r\n\t\t@addButton new Button 'Utskrift', 50,height-382,270,45, -> window.print()\r\n\t\t@addButton new Button 'Fortsätt', 350,height-382,270,45, -> \r\n\t\t\tmyNode = document.getElementById \"qrcode\"\r\n\t\t\tmyNode.innerHTML = ''\r\n\t\t\tpages.utskrift.active = false \r\n\t\t\tpages.typ.createSelectButtons()\r\n\t\t@addButton new Button 'Slump', 650,height-382,270,45, -> \r\n\t\t\tmyNode = document.getElementById \"qrcode\"\r\n\t\t\tmyNode.innerHTML = ''\r\n\t\t\tpages.utskrift.active = false \r\n\t\t\tpages.typ.slumpa()\r\n\t\t\tpages.typ.createSelectButtons()\r\n\r\n\tstopMeasuringTime : ->\r\n\t\t@crc = @getCRC pages.typ.qr\r\n\t\t@cpu = new Date().getTime() - pages.typ.start\r\n\r\n\tgetCRC : (qr) ->\r\n\t\tres = 0\r\n\t\tfor char,i in qr\r\n\t\t\tindex = '0123456789'.indexOf char\r\n\t\t\tres += (i+1) * (index+1)\r\n\t\t\tres %= 1000000\r\n\t\tres\r\n\r\n\tshowSelectedPersons : ->\r\n\t\tpush()\r\n\t\ttextAlign LEFT,CENTER\r\n\t\tfc 0\r\n\t\tsc()\r\n\t\ttextSize 20\r\n\t\tfor typ,i in 'RLK'\r\n\t\t\tfor person,j in pages.typ.selectedPersons[typ]\r\n\t\t\t\ty = [0,260,520][i] + 50 + 40*j\r\n\t\t\t\ttext \"#{j+1}  #{person[PARTIFÖRKORTNING]} - #{person[NAMN]}\",width/2,y\r\n\t\tpop()\r\n\r\n\trender : ->\r\n\t\ttextAlign LEFT,CENTER\r\n\t\tbg 1\r\n\t\tfc 0\r\n\t\ttext 'Riksdag',            10,50+0\r\n\t\ttext dictionary[länskod],  10,50+260\r\n\t\ttext dictionary[kommunkod],10,50+520\r\n\t\t#text pages.typ.qr,20,height-310\r\n\t\ttext \"#{'crc: ' + @getCRC pages.typ.qr.slice 10} #{'tid: '+@cpu}\",20,height-310\r\n\t\t@showSelectedPersons()\r\n\t\tpages.typ.sbuttons = []\r\n\r\nclass Button\r\n\tconstructor : (@title, @x,@y,@w,@h,@click = ->) ->\r\n\t\t@ts = 0.6 * @h\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\tpush()\r\n\t\tsc()\r\n\t\t#sw 1\r\n\t\trect @x,@y,@w,@h\r\n\t\tpop()\r\n\t\ttextSize @ts\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif @page.selected == @ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x+@w/2,@y+@h/2\r\n\tinside : -> @x < mouseX < @x+@w and @y < mouseY < @y+@h\r\n\r\nclass PartiButton extends Button \r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\t#textSize if @title in 'S C MP L M V SD KD'.split ' ' then 28 else 20\r\n\t\ttextSize @ts\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif @page.selected == @ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x+@w/2,@y+@h/2\r\n\r\nclass LetterButton extends Button \r\n\tconstructor : (title,x,y,w,h,@antal,click) ->\r\n\t\tsuper title,x,y,w,h,click\r\n\t\t@pageNo = -1\r\n\t\t@pages = 1 + @antal // PERSONS_PER_PAGE\r\n\t\tif @antal % PERSONS_PER_PAGE == 0 then @pages--\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize @ts\r\n\t\ttextAlign CENTER,CENTER\r\n\t\tif @page.selected == @ then fc 1,1,0 else fc 1\r\n\t\ttext @title,@x+@w/2,@y+@h/2\r\n\t\tpush()\r\n\t\t@pageIndicator()\r\n\t\tpop()\r\n\tpageIndicator : ->\r\n\t\tif @pages <= 1 then return \r\n\t\tdx = @w//(@pages+1)\r\n\t\tfor i in range @pages\r\n\t\t\tif i==@pageNo and @page.selected == @ then fc 1 else fc 0\r\n\t\t\tcircle @x + (i+1)*dx , @y+0.85*@h, 3  \r\n\r\nclass PersonButton extends Button\r\n\tconstructor : (person, x,y,w,h,click = ->) ->\r\n\t\tsuper person,x,y,w,h,click\r\n\t\t@title0 = person[NAMN]\r\n\t\t@title1 = person[VALSEDELSUPPGIFT]\r\n\t\tif @title1 == '' then @title1 = \"#{{M:'Man', K:'Kvinna'}[person[KÖN]]} #{person[ÅLDER_PÅ_VALDAGEN]} år\" \r\n\t\t@person = person\r\n\tdraw : ->\r\n\t\tfc 0.5\r\n\t\trect @x,@y,@w,@h\r\n\t\ttextSize @ts/2\r\n\t\ttextAlign LEFT,CENTER\r\n\t\tfc 1\r\n\t\ttext @title0,@x+2,@y+2+0.3*@h\r\n\t\tfc 0.75\r\n\t\ttext @title1,@x+2,@y+2+0.7*@h\r\n\r\nclass TypButton extends Button\r\n\tconstructor : (@typ, title,x,y,w,h,click = ->) ->\r\n\t\tsuper title, x,y,w,h,click\r\n\r\nspara = (lista,key,value) ->\r\n\tcurrent = tree\r\n\tfor name in lista\r\n\t\ta = current[name]\r\n\t\tif a == undefined then current[name] = {}\r\n\t\tcurrent = current[name]\r\n\tcurrent[key] = value\r\nreadDatabase = ->\r\n\r\n\t{kommun} = getParameters()\r\n\tprint kommun\r\n\tkommunkod = kommun\r\n\tif not kommunkod then kommunkod = '0180'\r\n\tlänskod = kommunkod.slice 0,2\t\r\n\r\n\tpartikoder = {}\r\n\t#partier = {}\r\n\tlines = db.split '\\n'\r\n\r\n\t#clowner = getClowner lines\r\n\r\n\tfor line in lines\r\n\t\tcells = line.split ';'\r\n\t\tvaltyp = cells[VALTYP]\r\n\t\tområdeskod = cells[VALOMRÅDESKOD]\r\n\t\tområde = cells[VALOMRÅDESNAMN]\r\n\t\tparti = cells[PARTIFÖRKORTNING]\r\n\t\t#if parti=='' then parti = cells[PARTIKOD]\r\n\t\tknr = cells[KANDIDATNUMMER]\r\n\t\tnamn = cells[NAMN]\r\n\r\n\t\tpartikoder[cells[PARTIKOD]]=parti\r\n\r\n\t\t#if knr in clowner then continue\r\n\t\tif namn == undefined then continue\r\n\t\tif parti == '' then continue\r\n\r\n\t\tdictionary[parti] = [cells[PARTIBETECKNING],cells[PARTIKOD]]\r\n\t\tdictionary[områdeskod] = område # hanterar både kommun och landsting\r\n\t\t# S -> ['Socialdemokraterna','1234']\r\n\t\t# 01 -> '01 - Stockholms läns landsting'\r\n\t\t# 0180 -> Stockholm\r\n\r\n\t\tarr = namn.split ', '\r\n\t\tif arr.length == 2\r\n\t\t\tnamn = arr[1] + ' ' + arr[0] \r\n\t\t\tcells[NAMN] = namn\r\n\r\n\t\tif parti == '' or namn == '[inte lämnat förklaring]' then continue\r\n\t\tif valtyp == 'R'                           then spara [valtyp, parti], \"#{knr}-#{namn}\", cells\r\n\t\tif valtyp == 'L' and områdeskod==länskod   then spara [valtyp, parti], \"#{knr}-#{namn}\", cells\r\n\t\tif valtyp == 'K' and områdeskod==kommunkod then spara [valtyp, parti], \"#{knr}-#{namn}\", cells\r\n\tprint dictionary\r\n\tprint partikoder\r\n\t#print partier\r\n\t#for key,parti of partier\r\n\t#\tif 1 < _.size parti then print key,parti\r\n\r\ngetParameters = (h = window.location.href) -> \r\n\th = decodeURI h\r\n\tarr = h.split '?'\r\n\tif arr.length != 2 then return {}\r\n\tif arr[1] == '' then return {}\r\n\t_.object(f.split '=' for f in arr[1].split '&')\t\t\r\n\r\nsetup = ->\r\n\tcreateCanvas windowWidth,windowHeight\r\n\r\n\treadDatabase()\r\n\tprint tree\r\n\r\n\tx0 = 0\r\n\tx1 = 0.18*width\r\n\tx2 = 0.28*width\r\n\tx3 = 0.64*width\r\n\tx4 = 1.00*width\r\n\tpages.typ      = new TypPage     x3,0,x4-x3,height \r\n\tpages.partier  = new PartiPage    0,0,x1-x0,height \r\n\tpages.letters  = new LetterPage  x1,0,x2-x1,height \r\n\tpages.personer = new PersonPage  x2,0,x3-x2,height \r\n\tpages.utskrift = new UtskriftPage 0,0,x4,height\r\n\tpages.utskrift.active = false \r\n\r\n\tsc()\r\n\r\n\ttextAlign CENTER,CENTER\r\n\ttextSize 20\r\n\r\ndraw = ->\t\r\n\tbg 0\r\n\tif pages.utskrift.active \r\n\t\tpages.utskrift.draw()\r\n\telse \r\n\t\tfor key,page of pages \r\n\t\t\tpage.draw()\r\n\r\nmousePressed = -> \r\n\tfor key,page of pages \r\n\t\tpage.mousePressed()\r\n\r\n#windowResized = -> resizeCanvas windowWidth, windowHeight\r\n\r\n\r\n######\r\n\r\n\t# constructor : (@render = ->) ->\r\n\t# \tsuper()\r\n\t# \t@rbuttons = [] # RKL\r\n\t# \t@init()\r\n\r\n\t# radd : (button) -> @rbuttons.push button\r\n\t# padd : (button) -> @pbuttons.push button\r\n\t# ladd : (button) -> @lbuttons.push button\r\n\t# kadd : (button) -> @kbuttons.push button\r\n\t# sadd : (button) -> @sbuttons.push button\r\n\r\n\t# allButtons : -> @pbuttons.concat @lbuttons.concat @kbuttons.concat @sbuttons.concat @rbuttons \r\n\r\n\t# init : ->\r\n\t# \t@pbuttons = [] # parti\r\n\t# \t@lbuttons = [] # letters\r\n\t# \t@kbuttons = [] # kandidater\r\n\t# \t@sbuttons = [] # Del, Up, Down\r\n\r\n\t# draw : ->\r\n\t# \tbg 0\r\n\t# \t@render()\r\n\t# \tfor button in @allButtons()\r\n\t# \t\tbutton.draw()\r\n\r\n\t# mousePressed : ->\r\n\t# \tfor button in @allButtons()\r\n\t# \t\tif button.inside() then button.click()\r\n\r\n\r\n# class Page1 extends Page\r\n\r\n\r\n\r\n\r\n# antal = (letter,personer) ->\r\n# \tlst = (1 for key,person of personer when letter == person[NAMN][0])\r\n# \tlst.length\r\n\r\n\r\n# getClowner = (lines) -> # tag fram alla personer som representerar flera partier i samma valtyp\r\n# \tres = []\r\n# \tpartier = {}\r\n# \tfor line in lines \r\n# \t\tcells = line.split ';'\r\n# \t\tknr = cells[KANDIDATNUMMER]\r\n# \t\tif partier[knr] == undefined then partier[knr] = {}\r\n# \t\tpartier[knr][cells[PARTIKOD]] = cells\r\n# \tfor knr,lista of partier\r\n# \t\tif 1 == _.size lista then continue\r\n# \t\tklr = {R:0,K:0,L:0}\r\n# \t\tfor key,item of lista\r\n# \t\t\tklr[item[VALTYP]]++\r\n# \t\tif klr.R>1 or klr.K>1 or klr.L>1 then res.push knr\r\n# \tprint 'Borttagna kandidater pga flera partier i samma valtyp: ',res\r\n# \tres\r\n\r\n"
  ]
}